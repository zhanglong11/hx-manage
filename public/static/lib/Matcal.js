THREE.CubicPoly=function(){var t=0,o=0,e=0,i=0;function r(r,n,s,u){t=r,o=s,e=-3*r+3*n-2*s-u,i=2*r-2*n+s+u}return{initCatmullRom:function(t,o,e,i,n){r(o,e,n*(e-t),n*(i-o))},initNonuniformCatmullRom:function(t,o,e,i,n,s,u){var l=(o-t)/n-(e-t)/(n+s)+(e-o)/s,p=(e-o)/s-(i-o)/(s+u)+(i-e)/u;r(o,e,l*=s,p*=s)},calc:function(r){var n=r*r;return t+o*r+e*n+i*(n*r)}}};var tmp=new THREE.Vector3,px=new THREE.CubicPoly,py=new THREE.CubicPoly,pz=new THREE.CubicPoly;THREE.CatmullRomCurve3=function(t,o,e,i){THREE.Curve.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=o||!1,this.curveType=e||"centripetal",this.tension=i||.5},THREE.CatmullRomCurve3.prototype=Object.create(THREE.Curve.prototype),THREE.CatmullRomCurve3.prototype.constructor=THREE.CatmullRomCurve3,THREE.CatmullRomCurve3.prototype.isCatmullRomCurve3=!0,THREE.CatmullRomCurve3.prototype.getPoint=function(t,o){var e,i,r,n,s=o||new THREE.Vector3,u=this.points,l=u.length,p=(l-(this.closed?0:1))*t,c=Math.floor(p),a=p-c;if(this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/l)+1)*l:0===a&&c===l-1&&(c=l-2,a=1),this.closed||c>0?e=u[(c-1)%l]:(tmp.subVectors(u[0],u[1]).add(u[0]),e=tmp),i=u[c%l],r=u[(c+1)%l],this.closed||c+2<l?n=u[(c+2)%l]:(tmp.subVectors(u[l-1],u[l-2]).add(u[l-1]),n=tmp),"centripetal"===this.curveType||"chordal"===this.curveType){var h="chordal"===this.curveType?.5:.25,m=Math.pow(e.distanceToSquared(i),h),y=Math.pow(i.distanceToSquared(r),h),v=Math.pow(r.distanceToSquared(n),h);y<1e-4&&(y=1),m<1e-4&&(m=y),v<1e-4&&(v=y),px.initNonuniformCatmullRom(e.x,i.x,r.x,n.x,m,y,v),py.initNonuniformCatmullRom(e.y,i.y,r.y,n.y,m,y,v),pz.initNonuniformCatmullRom(e.z,i.z,r.z,n.z,m,y,v)}else"catmullrom"===this.curveType&&(px.initCatmullRom(e.x,i.x,r.x,n.x,this.tension),py.initCatmullRom(e.y,i.y,r.y,n.y,this.tension),pz.initCatmullRom(e.z,i.z,r.z,n.z,this.tension));return s.set(px.calc(a),py.calc(a),pz.calc(a)),s},THREE.CatmullRomCurve3.prototype.copy=function(t){Curve.prototype.copy.call(this,t),this.points=[];for(var o=0,e=t.points.length;o<e;o++){var i=t.points[o];this.points.push(i.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},THREE.CatmullRomCurve3.prototype.toJSON=function(){var t=Curve.prototype.toJSON.call(this);t.points=[];for(var o=0,e=this.points.length;o<e;o++){var i=this.points[o];t.points.push(i.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},THREE.CatmullRomCurve3.prototype.fromJSON=function(t){Curve.prototype.fromJSON.call(this,t),this.points=[];for(var o=0,e=t.points.length;o<e;o++){var i=t.points[o];this.points.push((new Vector3).fromArray(i))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this};