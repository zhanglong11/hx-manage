/*!
 * LMV v7.9.0
 * 
 * Copyright 2019 Bimfish, Inc.
 * All rights reserved.
 * 
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Bimfish, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Bimfish, Inc.
 * 
 * Bimfish Forge Viewer Usage Limitations:
 * 
 * The Bimfish Forge viewer can only be used to view files generated by
 * Bimfish Forge services. The Bimfish Forge Viewer JavaScript must be
 * delivered from an Bimfish hosted URL.
 */
Bimfish.Extensions.Snapping=function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s="./extensions/Snapping/index.js")}({"./extensions/Snapping/SnapMath.js":
/*!*****************************************!*\
  !*** ./extensions/Snapping/SnapMath.js ***!
  \*****************************************/
/*! exports provided: sampleEllipsePoint, normalizeAngle, angleInsideArc, nearestPointOnCircularArc, intersectLines */function(e,t,i){"use strict";i.r(t),i.d(t,"sampleEllipsePoint",(function(){return r})),i.d(t,"normalizeAngle",(function(){return n})),i.d(t,"angleInsideArc",(function(){return s})),i.d(t,"nearestPointOnCircularArc",(function(){return o})),i.d(t,"intersectLines",(function(){return a}));var r=function(e,t,i,r,n,s,o,a){a=a||new THREE.Vector2;var c=s-n;c<0&&(c+=2*Math.PI),c>2*Math.PI&&(c-=2*Math.PI);var u=n+o*c;return a.x=e+i*Math.cos(u),a.y=t+r*Math.sin(u),a},n=function(e){return e/=2*Math.PI,(e-=Math.trunc(e))<0&&(e+=1),2*e*Math.PI},s=function(e,t,i){return e=n(e),(t=n(t))<(i=n(i))?e>=t&&e<=i:e>=t||e<=i},o=function(e,t,i,n,o,a){var c=(a=a||new THREE.Vector2).copy(e).sub(t).normalize(),u=Math.atan2(c.y,c.x);if(s(u,n,o))return c.multiplyScalar(i).add(t);var l=r(t.x,t.y,i,i,n,o,0),h=r(t.x,t.y,i,i,n,o,1),d=l.distanceToSquared(e)<=h.distanceToSquared(e);return a.copy(d?l:h),a},a=function(e,t,i,r,n,s){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1e-5,a=(r.y-i.y)*(t.x-e.x)-(r.x-i.x)*(t.y-e.y);if(Math.abs(a)<o)return null;var c=(r.x-i.x)*(e.y-i.y)-(r.y-i.y)*(e.x-i.x);if(c/=a,n){var u=(t.x-e.x)*(e.y-i.y)-(t.y-e.y)*(e.x-i.x);if(u/=a,c<0||c>1||u<0||u>1)return null}return(s=s||new THREE.Vector2).x=e.x+c*(t.x-e.x),s.y=e.y+c*(t.y-e.y),s}},"./extensions/Snapping/Snapper.js":
/*!****************************************!*\
  !*** ./extensions/Snapping/Snapper.js ***!
  \****************************************/
/*! exports provided: Snapper */function(e,t,i){"use strict";i.r(t),i.d(t,"Snapper",(function(){return y}));var r=i(/*! ./SnapperIndicator.js */"./extensions/Snapping/SnapperIndicator.js"),n=i(/*! ../../src/compat.js */"./src/compat.js"),s=i(/*! ../../src/wgs/scene/VertexBufferReader.js */"./src/wgs/scene/VertexBufferReader.js"),o=i(/*! ./SnapMath.js */"./extensions/Snapping/SnapMath.js");function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=Bimfish.Viewing.MeasureCommon,u=c.EPSILON,l=c.SnapType,h=c.SnapResult,d=Bimfish.Viewing;function p(e,t){return Math.abs(e-t)<=.001}function f(e,t){return Math.abs(e.x-t.x)<=.001&&Math.abs(e.y-t.y)<=.001&&Math.abs(e.z-t.z)<=.001}function v(e,t,i){var r,n,s=new THREE.Vector3,o=new THREE.Vector3;return s.subVectors(t,e),o.subVectors(i,t),n=s.dot(o),s.subVectors(i,t),(n=-n/s.dot(s))<0?r=e.distanceTo(t):n>1?r=e.distanceTo(i):(s.subVectors(e,t),o.subVectors(e,i),s.cross(o),o.subVectors(i,t),r=Math.sqrt(s.dot(s))/Math.sqrt(o.dot(o))),r}var g={Unknown:0,Line:1,CircularArc:2,EllipticalArc:3},m=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=g.Unknown,this.viewportId=t,this.distance=0,this.lineStart=null,this.lineEnd=null,this.radius=0,this.radiusX=0,this.radiusY=0,this.center=null,this.startAngle=0,this.endAngle=0}var t,i,r;return t=e,(i=[{key:"fromLine",value:function(e,t){return this.type=g.Line,this.lineStart=e.clone(),this.lineEnd=t.clone(),this}},{key:"fromCircularArc",value:function(e,t,i,r){return this.type=g.CircularArc,this.center=e.clone(),this.radius=t,this.start=i,this.end=r,this}},{key:"fromEllipticalArc",value:function(e,t,i,r,n){return this.type=g.EllipticalArc,this.center=e.clone(),this.radiusX=t,this.radiusY=i,this.start=r,this.end=n,this}},{key:"isLine",value:function(){return this.type===g.Line}},{key:"isCircularArc",value:function(){return this.type===g.CirularArc}},{key:"isEllipticalArc",value:function(){return this.type===g.EllipticalArc}},{key:"getIntersection",value:function(e,t){if(this.isLine()&&e.isLine())return Object(o.intersectLines)(this.lineStart,this.lineEnd,e.lineStart,e.lineEnd,!1,t)}}])&&a(t.prototype,i),r&&a(t,r),e}();function y(e,t){var i=new h,a=e;this.setGlobalManager(e.globalManager);var c,d=t||{};c=d.markupMode?["snapper-markup"]:["snapper"];var g=!1,y=Number.MAX_VALUE,E=null,b=!1,w=!1,x=!1,T=null,A=!1;this.indicator=new r.SnapperIndicator(e,this),this.markupMode=d.markupMode,this.renderSnappedGeometry=d.renderSnappedGeometry,this.renderSnappedTopology=d.renderSnappedTopology,this.isActive=function(){return g},this.getNames=function(){return c},this.getName=function(){return c[0]},this.getPriority=function(){return 60},this.activate=function(){g=!0,this.indicator||(this.indicator=new r.SnapperIndicator(e,this))},this.deactivate=function(){g=!1,A=!1,this.indicator&&(this.indicator.destroy(),this.indicator=null)},this.copyResults=function(e){i.copyTo(e)},this.getEdge=function(){return i.geomEdge},this.getVertex=function(){return i.geomVertex},this.getGeometry=function(){return i.getGeometry()},this.getGeometryType=function(){return i.geomType},this.getIntersectPoint=function(){return i.intersectPoint},this.getSnapResult=function(){return i},this.isSnapped=function(){return x},this.clearSnapped=function(){i.clear(),x=!1},this.setViewportId=function(e){T=e},this.setSnapToPixel=function(e){A=e},this.snapping3D=function(e){if(i.snapNode=e.dbId,i.intersectPoint=e.intersectPoint,i.modelId=e.model?e.model.id:null,e.model){var t,r=e.face;t=e.fragId&&void 0!==e.fragId.length?e.fragId:[e.fragId],i.hasTopology=e.model.hasTopology(),i.hasTopology?this.snapping3DwithTopology(r,t,e.model):this.snapping3DtoMesh(r,t,e.model)}},this.snapping3DwithTopology=function(e,t,r){i.snapNode&&(t=[],r.getData().instanceTree.enumNodeFragments(i.snapNode,(function(e){t.push(e)}),!0)),i.geomFace=i.geomEdge=i.geomVertex=null,y=Number.MAX_VALUE;for(var n=0;n<t.length;++n){var s=t[n],o=a.impl.getRenderProxy(r,s),c=o.geometry,u=r.getTopoIndex(s),h=r.getTopology(u),p=h.faces,f=h.edges;if(!i.geomFace){i.geomFace=this.faceSnappingWithTopology(e,c,p,o),i.geomFace&&(i.geomFace.fragId=s);var v=(new THREE.Matrix3).getNormalMatrix(o.matrixWorld);i.faceNormal=e.normal.applyMatrix3(v).normalize()}this.edgeSnappingWithTopology(i.intersectPoint,c,f,o)}if(i.geomVertex=this.vertexSnappingWithTopology(i.geomEdge,i.intersectPoint),i.geomFace){if(i.radius=this.setDetectRadius(i.intersectPoint),(d.forceSnapVertices||E<i.radius)&&i.geomVertex)i.geomType=l.SNAP_VERTEX;else if((d.forceSnapEdges||y<i.radius)&&i.geomEdge){var g=this.edgeIsCircle(i.geomEdge);g?(i.circularArcCenter=g,i.circularArcRadius=g.distanceTo(i.geomEdge.vertices[0]),i.geomEdge.center=i.circularArcCenter,i.geomEdge.radius=i.circularArcRadius,i.geomType=l.SNAP_CIRCULARARC):this.edgeIsCurved(i.geomEdge)?i.geomType=l.SNAP_CURVEDEDGE:i.geomType=l.SNAP_EDGE}else this.faceIsCurved(i.geomFace)?i.geomType=l.SNAP_CURVEDFACE:i.geomType=l.SNAP_FACE;x=!0}},this.snapping3DtoMesh=function(e,t,r){for(var n=0;n<t.length;++n){var s=t[n],o=a.impl.getRenderProxy(r,s),c=o.geometry;if(e instanceof THREE.Face3&&(i.geomFace=this.faceSnapping(e,c)),i.geomFace){i.geomFace.applyMatrix(o.matrixWorld),i.geomEdge=this.edgeSnapping(i.geomFace,i.intersectPoint),i.geomVertex=this.vertexSnapping(i.geomEdge,i.intersectPoint);var u=(new THREE.Matrix3).getNormalMatrix(o.matrixWorld);i.faceNormal=e.normal.applyMatrix3(u).normalize(),i.radius=this.setDetectRadius(i.intersectPoint),d.forceSnapVertices||E<i.radius?i.geomType=l.SNAP_VERTEX:d.forceSnapEdges||y<i.radius?i.geomType=l.SNAP_EDGE:i.geomType=l.SNAP_FACE,x=!0;break}}},this.faceSnappingWithTopology=function(e,t,i,r){var n=new THREE.Vector3,s=new THREE.Vector3,o=new THREE.Vector3,a=new THREE.Geometry,c=t.attributes;if(void 0!==c.index){for(var u=t.vb?t.vb:c.position.array,l=t.vb?t.vbstride:3,h=0;h<i.length;h++){for(var d=i[h].indexList,p=i[h].id,f=0;f<d.length;f+=3)if(e.a===d[f]){if(e.b===d[f+1]&&e.c===d[f+2]||e.b===d[f+2]&&e.c===d[f+1])break}else if(e.a===d[f+1]){if(e.b===d[f]&&e.c===d[f+2]||e.b===d[f+2]&&e.c===d[f])break}else if(e.a===d[f+2]&&(e.b===d[f]&&e.c===d[f+1]||e.b===d[f+1]&&e.c===d[f]))break;if(f<d.length)break}if(h<i.length)for(f=0;f<d.length;f+=3){n.set(u[d[f]*l],u[d[f]*l+1],u[d[f]*l+2]),s.set(u[d[f+1]*l],u[d[f+1]*l+1],u[d[f+1]*l+2]),o.set(u[d[f+2]*l],u[d[f+2]*l+1],u[d[f+2]*l+2]);var v=a.vertices.length;a.vertices.push(n.clone()),a.vertices.push(s.clone()),a.vertices.push(o.clone()),a.faces.push(new THREE.Face3(v,v+1,v+2))}}return a.vertices.length>0?(a.faceId=p,a.applyMatrix(r.matrixWorld),a):null},this.faceSnapping=function(e,t){var i=new THREE.Vector3,r=new THREE.Vector3,n=new THREE.Vector3,s=new THREE.Geometry,o=t.attributes;if(void 0!==o.index){var a=o.index.array||t.ib,c=t.vb?t.vb:o.position.array,u=t.vb?t.vbstride:3,l=t.offsets;l&&0!==l.length||(l=[{start:0,count:a.length,index:0}]);for(var h=0;h<l.length;++h)for(var d=l[h].start,v=l[h].count,g=l[h].index,m=d;m<d+v;m+=3){var y=g+a[m],E=g+a[m+1],b=g+a[m+2];i.set(c[y*u],c[y*u+1],c[y*u+2]),r.set(c[E*u],c[E*u+1],c[E*u+2]),n.set(c[b*u],c[b*u+1],c[b*u+2]);var w=THREE.Triangle.normal(i,r,n),x=new THREE.Vector3;if(x.set(c[e.a*u],c[e.a*u+1],c[e.a*u+2]),f(w,e.normal)&&p(w.dot(i),e.normal.dot(x))){var T=s.vertices.length;s.vertices.push(i.clone()),s.vertices.push(r.clone()),s.vertices.push(n.clone()),s.faces.push(new THREE.Face3(T,T+1,T+2))}}}return s.vertices.length>0?this.getTrianglesOnSameFace(s,e,c,u):null},this.getTrianglesOnSameFace=function(e,t,i,r){var n=!1,s=e.vertices.slice(),o=new THREE.Vector3;o.set(i[t.a*r],i[t.a*r+1],i[t.a*r+2]);var a=new THREE.Vector3;a.set(i[t.b*r],i[t.b*r+1],i[t.b*r+2]);var c=new THREE.Vector3;c.set(i[t.c*r],i[t.c*r+1],i[t.c*r+2]);var u=new THREE.Geometry;u.vertices.push(o),u.vertices.push(a),u.vertices.push(c),u.faces.push(new THREE.Face3(0,1,2));var l=[];do{l=[];for(var h=0;h<s.length;h+=3)if(s[h].equals(o)&&s[h+1].equals(a)&&s[h+2].equals(c))n=!0,l.push(h);else for(var d=0;d<u.vertices.length;d+=3)if(this.trianglesSharedEdge(s[h],s[h+1],s[h+2],u.vertices[d],u.vertices[d+1],u.vertices[d+2])){var p=u.vertices.length;u.vertices.push(s[h].clone()),u.vertices.push(s[h+1].clone()),u.vertices.push(s[h+2].clone()),u.faces.push(new THREE.Face3(p,p+1,p+2)),l.push(h);break}for(var f=l.length-1;f>=0;--f)s.splice(l[f],3)}while(l.length>0);return n?u:null},this.trianglesSharedEdge=function(e,t,i,r,n,s){var o=!1,a=!1,c=!1;return(e.equals(r)||e.equals(n)||e.equals(s))&&(o=!0),(t.equals(r)||t.equals(n)||t.equals(s))&&(a=!0),(i.equals(r)||i.equals(n)||i.equals(s))&&(c=!0),!!(o&a||o&c||a&c)},this.edgeSnappingWithTopology=function(e,t,r,n){var s,o=new THREE.Geometry,a=Number.MAX_VALUE,c=new THREE.Vector3,u=new THREE.Vector3,l=t.attributes;if(void 0!==l.index&&null!=r){for(var h=t.vb?t.vb:l.position.array,d=t.vb?t.vbstride:3,p=0;p<r.length;p++)for(var f=r[p].indexList,g=0;g<f.length-1;g++){c.set(h[f[g]*d],h[f[g]*d+1],h[f[g]*d+2]),u.set(h[f[g+1]*d],h[f[g+1]*d+1],h[f[g+1]*d+2]),c.applyMatrix4(n.matrixWorld),u.applyMatrix4(n.matrixWorld);var m=v(e,c,u);m<a&&(a=m,s=p)}if(s){f=r[s].indexList;for(var E=0;E<f.length-1;E++)o.vertices.push(new THREE.Vector3(h[f[E]*d],h[f[E]*d+1],h[f[E]*d+2])),o.vertices.push(new THREE.Vector3(h[f[E+1]*d],h[f[E+1]*d+1],h[f[E+1]*d+2]))}}y>=a&&o.vertices.length>0&&(y=a,o.applyMatrix(n.matrixWorld),i.geomEdge=o)},this.edgeSnapping=function(e,t){for(var i=new THREE.Geometry,r=!0,n=!0,s=!0,o=0;o<e.vertices.length;o+=3){for(var a=0;a<e.vertices.length;a+=3)o!==a&&((e.vertices[o].equals(e.vertices[a])||e.vertices[o].equals(e.vertices[a+1])||e.vertices[o].equals(e.vertices[a+2]))&&(e.vertices[o+1].equals(e.vertices[a])||e.vertices[o+1].equals(e.vertices[a+1])||e.vertices[o+1].equals(e.vertices[a+2]))&&(r=!1),(e.vertices[o].equals(e.vertices[a])||e.vertices[o].equals(e.vertices[a+1])||e.vertices[o].equals(e.vertices[a+2]))&&(e.vertices[o+2].equals(e.vertices[a])||e.vertices[o+2].equals(e.vertices[a+1])||e.vertices[o+2].equals(e.vertices[a+2]))&&(n=!1),(e.vertices[o+1].equals(e.vertices[a])||e.vertices[o+1].equals(e.vertices[a+1])||e.vertices[o+1].equals(e.vertices[a+2]))&&(e.vertices[o+2].equals(e.vertices[a])||e.vertices[o+2].equals(e.vertices[a+1])||e.vertices[o+2].equals(e.vertices[a+2]))&&(s=!1));r&&(i.vertices.push(e.vertices[o].clone()),i.vertices.push(e.vertices[o+1].clone())),n&&(i.vertices.push(e.vertices[o].clone()),i.vertices.push(e.vertices[o+2].clone())),s&&(i.vertices.push(e.vertices[o+1].clone()),i.vertices.push(e.vertices[o+2].clone())),r=!0,n=!0,s=!0}for(var c,u=new THREE.Geometry,l=Number.MAX_VALUE,h=0;h<i.vertices.length;h+=2){var d=v(t,i.vertices[h],i.vertices[h+1]);d<l&&(l=d,c=h)}return u.vertices.push(i.vertices[c].clone()),u.vertices.push(i.vertices[c+1].clone()),u.vertices=this.getConnectedLineSegmentsOnSameLine(i,u.vertices),y=l,u},this.getConnectedLineSegmentsOnSameLine=function(e,t){var i,r,n=e.vertices.slice(),s=t[0],o=t[1],a=[];do{a=[];for(var c=0;c<n.length;c+=2)if(!n[c].equals(s)||!n[c+1].equals(o))for(var u=0;u<t.length;u+=2)if(n[c].equals(t[u])||n[c+1].equals(t[u])||n[c].equals(t[u+1])||n[c+1].equals(t[u+1])){var l=new THREE.Vector3,h=new THREE.Vector3;if(l.subVectors(t[u],t[u+1]),l.normalize(),h.subVectors(n[c],n[c+1]),h.normalize(),f(l,h)||(i=l,r=h,Math.abs(i.x+r.x)<=.001&&Math.abs(i.y+r.y)<=.001&&Math.abs(i.z+r.z)<=.001)){a.push(c);break}}for(var d=a.length-1;d>=0;--d)t.push(n[a[d]]),t.push(n[a[d]+1]),n.splice(a[d],2)}while(a.length>0);return t},this.vertexSnappingWithTopology=function(e,t){var i=Number.MAX_VALUE,r=new THREE.Vector3;if(e&&e.vertices.length>1){var n=t.distanceTo(e.vertices[0]),s=t.distanceTo(e.vertices[e.vertices.length-1]);n<=s?(i=n,r=e.vertices[0].clone()):(i=s,r=e.vertices[e.vertices.length-1].clone())}return E=i,r},this.vertexSnapping=function(e,t){for(var i=Number.MAX_VALUE,r=new THREE.Vector3,n=0;n<e.vertices.length;++n){var s=t.distanceTo(e.vertices[n]);s<i-.001&&(i=s,r=e.vertices[n].clone())}return E=i,r},this.edgeIsCircle=function(e){var t=e.vertices;if(t.length<8)return!1;if(t[0].equals(t[t.length-1])){for(var i=new THREE.Vector3(0,0,0),r=0;r<t.length;r+=2)i.add(t[r]);i.divideScalar(t.length/2);var n=i.distanceTo(t[0]);for(r=0;r<t.length;r+=2)if(!(Math.abs(i.distanceTo(t[r])-n)<=.001))return!1;return i}return!1},this.edgeIsCurved=function(e){var t=e.vertices;if(t.length<=2)return!1;if(t[0].equals(t[t.length-1]))return!0;var i=new THREE.Vector3;i.subVectors(t[0],t[1]);for(var r=new THREE.Vector3,n=2;n<t.length;n+=2)if(r.subVectors(t[n],t[n+1]),!f(i,r))return!0;return!1},this.faceIsCurved=function(e){var t=e.vertices,i=e.faces;if(i.length<=1)return!1;for(var r=THREE.Triangle.normal(t[i[0].a],t[i[0].b],t[i[0].c]),n=t[i[0].a],s=1;s<i.length;s++){var o=THREE.Triangle.normal(t[i[s].a],t[i[s].b],t[i[s].c]),a=t[i[s].a];if(!f(r,o)||!p(r.dot(n),o.dot(a)))return!0}return!1},this.angleVector2=function(e){return e.x>0&&e.y>=0?Math.atan(e.y/e.x):e.x>=0&&e.y<0?Math.atan(e.y/e.x)+2*Math.PI:e.x<0&&e.y<=0||e.x<=0&&e.y>0?Math.atan(e.y/e.x)+Math.PI:null};function V(e,t,i){this.viewer=e,this.snapper=t,this.lineGeom=new THREE.Geometry,this.circularArc=null,this.circularArcCenter,this.circularArcRadius,this.ellipticalArc=null,this.ellipticalArcCenter,this.minDist=Number.MAX_VALUE,this.vpIdLine=null,this.vpIdCircular=null,this.vpIdElliptical=null,this.detectRadius=i,this.snapCandidates=[]}V.prototype.onLineSegment=function(e,t,i,r,n){var s=this.snapper.getIntersectPoint(),o=this.lineGeom.vertices,a=new THREE.Vector3(e,t,s.z),c=new THREE.Vector3(i,r,s.z),u=v(s,a,c);u>this.detectRadius||(this.snapCandidates.push(new m(n,u).fromLine(a,c)),u<this.minDist&&(o.splice(0,2,a,c),this.minDist=u,this.vpIdLine=n))},V.prototype.onCircularArc=function(e,t,i,r,n,s){var a=this.snapper.getIntersectPoint(),c=new THREE.Vector2(a.x,a.y),u=new THREE.Vector2(e,t);c.sub(u);var l=Object(o.nearestPointOnCircularArc)(a,u,n,i,r),h=l.distanceTo(a);if(this.snapCandidates.push(new m(s,h).fromCircularArc(u,n,i,r)),!(h>this.detectRadius)){var d=this.snapper.angleVector2(c);if(r>i&&d>=i&&d<=r)var p=new THREE.CircleGeometry(n,100,i,r-i);else{if(!(r<i&&(d>=i||d<=r)))return;p=new THREE.CircleGeometry(n,100,i,2*Math.PI-i+r)}p.vertices.splice(0,1),p.applyMatrix((new THREE.Matrix4).makeTranslation(e,t,a.z)),this.circularArc=p,this.circularArcCenter=new THREE.Vector3(e,t,a.z),this.circularArcRadius=n,this.snapPoint=new THREE.Vector3(l.x,l.y,a.z),this.vpIdCircular=s}},V.prototype.onEllipticalArc=function(e,t,i,r,n,s,a,c){var u=this.snapper.getIntersectPoint(),l=new THREE.Vector2(u.x,u.y),h=n-this.detectRadius,d=s-this.detectRadius,f=n+this.detectRadius,v=s+this.detectRadius,g=(l.x-e)*(l.x-e)/(h*h)+(l.y-t)*(l.y-t)/(d*d),y=(l.x-e)*(l.x-e)/(f*f)+(l.y-t)*(l.y-t)/(v*v),E=new THREE.Vector2(e,t);l.sub(E),l.x*=s,l.y*=n;var b=this.snapper.angleVector2(l);if(r>2*Math.PI&&(r=2*Math.PI),g>=1&&y<=1&&(r>i&&b>=i&&b<=r||r<i&&(b>=i||b<=r))){var w=function(e,t,i,r,n,s,a){for(var c=new THREE.Geometry,u=0;u<a;u++){var l=new THREE.Vector3(0,0,0);Object(o.sampleEllipsePoint)(e,t,i,r,n,s,u/(a-1),l),c.vertices.push(l)}return c}(e,t,n,s,i,r,50);p(r-i,2*Math.PI)||w.vertices.pop(),w.applyMatrix((new THREE.Matrix4).makeTranslation(0,0,u.z));var x=nearestVertexInVertexToEdge(u,w),T=THREE.Vector2.prototype.distanceTo.call(x,u),A=new THREE.Vector2(e,t);this.snapCandidates.push(new m(c,T).makeEllipticalArc(A,n,s,i,r)),this.ellipticalArc=w,this.ellipticalArcCenter=new THREE.Vector3(e,t,u.z),this.vpIdElliptical=c}},this.snapping2D=function(e){if(e){var t=e.intersectPoint,r=e.fragId;if(void 0!==r){if(Array.isArray(r)||(r=[r]),i.hasTopology=!1,i.intersectPoint=t,i.radius=this.setDetectRadius(t),!(null!=a.model.getFragmentList()))return x=!0,i.geomType=l.SNAP_VERTEX,void(i.geomVertex=t);for(var n=new V(a,this,i.radius),o=0;o<r.length;++o){var c=a.impl.getRenderProxy(a.model,r[o]);if(c&&c.geometry)new s.VertexBufferReader(c.geometry).enumGeomsForObject(a.model.reverseMapDbId(e.dbId),n)}this.finishSnapping2D(n,t),!x&&A&&(x=!0,i.geomType=l.RASTER_PIXEL,i.geomVertex=t)}}},this.snapping2DOverlay=function(e,t,r){i.hasTopology=!1,i.intersectPoint=e,i.radius=this.setDetectRadius(e);for(var n=new V(a,this,i.radius),o=0;o<t.length;o++){var c=t[o];new s.VertexBufferReader(c.geometry).enumGeoms(r,n)}this.finishSnapping2D(n,e)},this.snapping2DWithSegmentEnum=function(e,t){i.hasTopology=!1,i.intersectPoint=e,i.radius=this.setDetectRadius(e);var r=new V(a,this,i.radius);t(e.x-i.radius,e.y-i.radius,e.x+i.radius,e.y+i.radius,r),this.finishSnapping2D(r,e)},this.finishSnapping2D=function(e,t){if(null!==T){e.snapCandidates=e.snapCandidates.filter((function(e){return e.viewportId===T}))}var r=function(e,t,i){if(e.sort((function(e,t){return e.distance-t.distance})),e.length<2)return null;for(var r={viewportId:e[0].viewportId,snapPoint:new THREE.Vector3(0,0,t.z)},n=e[0],s=1;s<e.length;s++){var o=e[s];if(n.getIntersection(o,r.snapPoint))if(THREE.Vector2.prototype.distanceTo.call(r.snapPoint,t)<i)return r}return null}(e.snapCandidates,t,e.detectRadius);if(r)return i.viewportIndex2d=r.viewportId,i.snapPoint=r.snapPoint,i.geomType=l.SNAP_INTERSECTION,i.geomVertex=r.snapPoint,void(x=!0);if(e.circularArc){if(i.viewportIndex2d=e.vpIdCircular,i.snapPoint=e.snapPoint,null!==T&&T!==i.viewportIndex2d)return;t.distanceTo(e.circularArc.vertices[0])<i.radius?(i.geomVertex=e.circularArc.vertices[0],i.geomType=l.SNAP_VERTEX):t.distanceTo(e.circularArc.vertices[e.circularArc.vertices.length-1])<i.radius?(i.geomVertex=e.circularArc.vertices[e.circularArc.vertices.length-1],i.geomType=l.SNAP_VERTEX):(this.lineStripToPieces(e.circularArc),i.geomEdge=e.circularArc,i.circularArcCenter=e.circularArcCenter,i.circularArcRadius=e.circularArcRadius,i.geomType=l.SNAP_CIRCULARARC),x=!0}else if(e.ellipticalArc){if(i.viewportIndex2d=e.vpIdElliptical,null!==T&&T!==i.viewportIndex2d)return;t.distanceTo(e.ellipticalArc.vertices[0])<i.radius?(i.geomVertex=e.ellipticalArc.vertices[0],i.geomType=l.SNAP_VERTEX):t.distanceTo(e.ellipticalArc.vertices[e.ellipticalArc.vertices.length-1])<i.radius?(i.geomVertex=e.ellipticalArc.vertices[e.ellipticalArc.vertices.length-1],i.geomType=l.SNAP_VERTEX):(this.lineStripToPieces(e.ellipticalArc),i.geomEdge=e.ellipticalArc,i.circularArcCenter=e.ellipticalArcCenter,i.circularArcRadius=null,i.geomType=l.SNAP_CIRCULARARC),x=!0}else if(e.lineGeom.vertices.length){if(i.viewportIndex2d=e.vpIdLine,null!==T&&T!==i.viewportIndex2d)return;if(i.geomEdge=e.lineGeom,this.markupMode){var n=e.lineGeom.vertices[0],s=e.lineGeom.vertices[1],o=new THREE.Vector3;o.addVectors(n,s),o.divideScalar(2);var a=t.distanceTo(o),c=t.distanceTo(n),h=t.distanceTo(s);i.geomEdge=e.lineGeom,a<i.radius?(i.geomVertex=o,i.geomType=l.SNAP_VERTEX):c<i.radius?(i.geomVertex=n,i.geomType=l.SNAP_VERTEX):h<i.radius?(i.geomVertex=s,i.geomType=l.SNAP_VERTEX):i.geomType=l.SNAP_EDGE,e.lineGeom.vertices[0].distanceTo(e.lineGeom.vertices[1])<u&&(i.geomType=l.SNAP_CIRCLE_CENTER)}else t.distanceTo(e.lineGeom.vertices[0])<i.radius?(e.lineGeom.vertices[0].distanceTo(e.lineGeom.vertices[1])<u?i.geomType=l.SNAP_CIRCLE_CENTER:i.geomType=l.SNAP_VERTEX,i.geomVertex=e.lineGeom.vertices[0]):d.forceSnapVertices||t.distanceTo(e.lineGeom.vertices[1])<i.radius?(i.geomVertex=e.lineGeom.vertices[1],i.geomType=l.SNAP_VERTEX):i.geomType=l.SNAP_EDGE;x=!0}},this.snappingLeaflet=function(e){if(e){var t=e.intersectPoint;i.intersectPoint=t,i.hasTopology=!1,i.radius=this.setDetectRadius(t),i.geomType=l.RASTER_PIXEL,i.geomVertex=t,x=!0}},this.snapMidpoint=function(){if(i.isMidpoint=!1,x&&i.geomType===l.SNAP_EDGE){var e=i.geomEdge,t=e.vertices[0],r=e.vertices[1],n=new THREE.Vector3((t.x+r.x)/2,(t.y+r.y)/2,(t.z+r.z)/2);i.intersectPoint.distanceTo(n)<2*i.radius&&(i.geomVertex=n,i.geomType=l.SNAP_MIDPOINT)}},this.setPerpendicular=function(e){i.isPerpendicular=e},this.lineStripToPieces=function(e){for(var t=e.vertices,i=t.length-2;i>0;i--)t.splice(i,0,t[i])},this.setDetectRadius=function(e){var t=Object(n.isMobileDevice)()?50:10,i=a.navigation,r=i.getCamera(),s=i.getPosition(),o=e.clone(),c=r.isPerspective?o.sub(s).length():i.getEyeVector().length(),u=i.getVerticalFov(),l=2*c*Math.tan(THREE.Math.degToRad(.5*u)),h=i.getScreenViewport(),d=this.getWindow().devicePixelRatio||1;return t*l/(h.height*d)},this.handleButtonDown=function(e,t){return b=!0,!1},this.handleButtonUp=function(e,t){return b=!1,!1},this.handleMouseMove=function(e){return b||this.onMouseMove({x:e.canvasX,y:e.canvasY}),!1},this.handleSingleTap=function(e){return this.handleMouseMove(e)},this.handlePressHold=function(e){if(Object(n.isMobileDevice)())switch(e.type){case"press":w=!0,this.onMouseMove({x:e.canvasX,y:e.canvasY});break;case"pressup":this.onMouseMove({x:e.canvasX,y:e.canvasY}),w=!1}return!1},this.handleGesture=function(e){if(Object(n.isMobileDevice)()&&w)switch(e.type){case"dragstart":case"dragmove":this.onMouseMove({x:e.canvasX,y:e.canvasY});break;case"dragend":this.onMouseMove({x:e.canvasX,y:e.canvasY}),w=!1}return!1},this.onMouseDown=function(e){return this.onMouseMove(e)},this.onMouseMove=function(e){this.clearSnapped();var t=a.impl.snappingHitTest(e.x,e.y,!1);if(!t&&A){var i=a.impl.clientToViewport(e.x,e.y);t={intersectPoint:a.impl.intersectGroundViewport(i)}}return!(!t||!t.intersectPoint)&&(t.face?this.snapping3D(t):t.dbId||0===t.dbId?this.snapping2D(t):this.snappingLeaflet(t),this.snapMidpoint(),!0)}}d.GlobalManagerMixin.call(y.prototype)},"./extensions/Snapping/SnapperIndicator.js":
/*!*************************************************!*\
  !*** ./extensions/Snapping/SnapperIndicator.js ***!
  \*************************************************/
/*! exports provided: SnapperIndicator */function(e,t,i){"use strict";i.r(t),i.d(t,"SnapperIndicator",(function(){return l}));var r=Bimfish.Viewing.MeasureCommon,n=r.isEqualVectors,s=r.EPSILON,o=r.SnapType,a="MeasureTool-snapper-geometries",c="MeasureTool-snapper-indicator",u=null;function l(e,t){this.viewer=e,this.snapper=t,this.overlayType=0,this.previewsIntersectPoint=null,this.viewer.impl.createOverlayScene(a),this.viewer.impl.createOverlayScene(c),this.geometryMaterial=new THREE.MeshPhongMaterial({color:52224,ambient:52224,opacity:.5,transparent:!0,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide}),this.indicatorMaterial=new THREE.MeshBasicMaterial({color:16742144,ambient:16742144,opacity:1,transparent:!1,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide})}l.prototype.constructor=l;var h=l.prototype;h.render=function(){var e=this.snapper.getSnapResult();n(this.previewsIntersectPoint,e.intersectPoint,s)||this.clearOverlay(a),this.clearOverlay(c),e.isEmpty()||((this.snapper.renderSnappedGeometry||e.hasTopology&&this.snapper.renderSnappedTopology)&&this.renderGeometry(e),this.renderIndicator(e),this.previewsIntersectPoint=e.intersectPoint.clone())},h.removeOverlay=function(e){this.viewer.impl.clearOverlay(e),this.viewer.impl.removeOverlayScene(e)},h.clearOverlay=function(e){this.removeOverlay(e),this.viewer.impl.createOverlayScene(e)},h.clearOverlays=function(){this.removeOverlay(a),this.viewer.impl.createOverlayScene(a),this.removeOverlay(c),this.viewer.impl.createOverlayScene(c),this.previewsIntersectPoint=null},h.addOverlay=function(e,t){this.viewer.impl.addOverlay(e,t)},h.drawFace=function(e,t,i){var r=new THREE.Mesh(e,t,!0);i===a&&(this.overlayType=1),this.addOverlay(i,r)},h.cylinderMesh=function(e,t,i,r){var n=(new THREE.Vector3).subVectors(t,e),s=new THREE.Matrix4;s.lookAt(e,t,(new THREE.Object3D).up),s.multiply((new THREE.Matrix4).set(1,0,0,0,0,0,1,0,0,-n.length(),0,0,0,0,0,1)),r=r||.5;var o=new THREE.CylinderGeometry(r,r,1,8,1,!0),a=new THREE.Mesh(o,i);return o=null,a.applyMatrix(s),a.position.x=(t.x+e.x)/2,a.position.y=(t.y+e.y)/2,a.position.z=(t.z+e.z)/2,a},h.renderGeometry=function(e){if(!n(this.previewsIntersectPoint,e.intersectPoint,s))switch(e.geomType){case o.SNAP_VERTEX:o.RASTER_PIXEL,this.drawPoint(e.geomVertex,this.geometryMaterial,a);break;case o.SNAP_EDGE:case o.SNAP_CURVEDEDGE:case o.SNAP_CIRCULARARC:case o.SNAP_MIDPOINT:this.drawLine(e.geomEdge,this.geometryMaterial,.3,a);break;case o.SNAP_FACE:case o.SNAP_CURVEDFACE:this.drawFace(e.geomFace,this.geometryMaterial,a)}},h.renderVertexIndicator=function(e){var t=r.getSnapResultPosition(e,this.viewer),i=1.2*this.setScale(t),n=this.viewer.navigation.getCameraRightVector().multiplyScalar(i),s=this.viewer.navigation.getCameraUpVector().multiplyScalar(i),o=new THREE.Geometry,a=new THREE.Vector3;a.addVectors(t,n),a.addVectors(a,s),o.vertices[0]=a.clone(),a.subVectors(t,n),a.addVectors(a,s),o.vertices[1]=a.clone(),this.drawLine(o,this.indicatorMaterial,.2,c),a.addVectors(t,n),a.subVectors(a,s),o.vertices[0]=a.clone(),a.subVectors(t,n),a.subVectors(a,s),o.vertices[1]=a.clone(),this.drawLine(o,this.indicatorMaterial,.2,c),a.subVectors(t,n),a.subVectors(a,s),o.vertices[0]=a.clone(),a.subVectors(t,n),a.addVectors(a,s),o.vertices[1]=a.clone(),this.drawLine(o,this.indicatorMaterial,.2,c),a.addVectors(t,n),a.subVectors(a,s),o.vertices[0]=a.clone(),a.addVectors(t,n),a.addVectors(a,s),o.vertices[1]=a.clone(),this.drawLine(o,this.indicatorMaterial,.2,c)},h.renderMidpointIndicator=function(e){var t=e.geomVertex,i=1.2*this.setScale(t),r=this.viewer.navigation.getCameraRightVector().multiplyScalar(i),n=this.viewer.navigation.getCameraUpVector().multiplyScalar(i),s=new THREE.Geometry,o=new THREE.Vector3;o.addVectors(t,r),o.subVectors(o,n),s.vertices[0]=o.clone(),o.subVectors(t,r),o.subVectors(o,n),s.vertices[1]=o.clone(),this.drawLine(s,this.indicatorMaterial,.2,c),o.subVectors(t,r),o.subVectors(o,n),s.vertices[0]=o.clone(),o.addVectors(t,n),s.vertices[1]=o.clone(),this.drawLine(s,this.indicatorMaterial,.2,c),o.addVectors(t,r),o.subVectors(o,n),s.vertices[0]=o.clone(),o.addVectors(t,n),s.vertices[1]=o.clone(),this.drawLine(s,this.indicatorMaterial,.2,c)},h.renderEdgeIndicator=function(e){var t=r.getSnapResultPosition(e,this.viewer),i=1.2*this.setScale(t),n=this.viewer.navigation.getCameraRightVector().multiplyScalar(i),s=this.viewer.navigation.getCameraUpVector().multiplyScalar(i),o=new THREE.Geometry,a=new THREE.Vector3;a.addVectors(t,n),a.subVectors(a,s),o.vertices[0]=a.clone(),o.vertices[1]=t.clone(),this.drawLine(o,this.indicatorMaterial,.2,c),a.subVectors(t,n),a.subVectors(a,s),o.vertices[0]=a.clone(),o.vertices[1]=t.clone(),this.drawLine(o,this.indicatorMaterial,.2,c),a.addVectors(t,s),o.vertices[0]=a.clone(),o.vertices[1]=t.clone(),this.drawLine(o,this.indicatorMaterial,.2,c)},h.renderCircleIndicator=function(e){var t=r.getSnapResultPosition(e,this.viewer);this.drawCircle(t,this.indicatorMaterial,c)},h.renderPerpendicular=function(e){var t=r.getSnapResultPosition(e,this.viewer),i=1.2*this.setScale(t),n=this.viewer.navigation.getCameraRightVector().multiplyScalar(i),s=this.viewer.navigation.getCameraUpVector().multiplyScalar(i),o=new THREE.Geometry,a=new THREE.Vector3;o.vertices[0]=t.clone(),a.subVectors(t,n),o.vertices[1]=a.clone(),this.drawLine(o,this.indicatorMaterial,.2,c),a.addVectors(t,n),a.subVectors(a,s),o.vertices[0]=a.clone(),a.subVectors(t,n),a.subVectors(a,s),o.vertices[1]=a.clone(),this.drawLine(o,this.indicatorMaterial,.2,c),a.subVectors(t,n),a.subVectors(a,s),o.vertices[0]=a.clone(),a.subVectors(t,n),a.addVectors(a,s),o.vertices[1]=a.clone(),this.drawLine(o,this.indicatorMaterial,.2,c),o.vertices[0]=t.clone(),a.subVectors(t,s),o.vertices[1]=a.clone(),this.drawLine(o,this.indicatorMaterial,.2,c)},h.renderPixelIndicator=function(e){var t=r.getSnapResultPosition(e,this.viewer),i=1.2*this.setScale(t),n=this.viewer.navigation.getCameraRightVector().multiplyScalar(i),s=this.viewer.navigation.getCameraUpVector().multiplyScalar(i),o=new THREE.Geometry,a=new THREE.Vector3;a.subVectors(t,n),a.addVectors(a,s),o.vertices[0]=a.clone(),o.vertices[1]=t.clone(),this.drawLine(o,this.indicatorMaterial,.2,c),a.addVectors(t,n),a.addVectors(a,s),o.vertices[0]=a.clone(),o.vertices[1]=t.clone(),this.drawLine(o,this.indicatorMaterial,.2,c),a.addVectors(t,n),a.subVectors(a,s),o.vertices[0]=a.clone(),o.vertices[1]=t.clone(),this.drawLine(o,this.indicatorMaterial,.2,c),a.subVectors(t,n),a.subVectors(a,s),o.vertices[0]=a.clone(),o.vertices[1]=t.clone(),this.drawLine(o,this.indicatorMaterial,.2,c)},h.renderIndicator=function(e){if(e.isPerpendicular)this.renderPerpendicular(e);else switch(e.geomType){case o.SNAP_VERTEX:case o.SNAP_INTERSECTION:this.renderVertexIndicator(e);break;case o.SNAP_MIDPOINT:this.renderMidpointIndicator(e);break;case o.SNAP_CIRCLE_CENTER:this.renderCircleIndicator(e);break;case o.SNAP_EDGE:case o.SNAP_CURVEDEDGE:this.renderEdgeIndicator(e);break;case o.SNAP_CIRCULARARC:this.viewer.model.is2d()?this.renderVertexIndicator(e):this.renderCircleIndicator(e);break;case o.SNAP_FACE:case o.SNAP_CURVEDFACE:this.renderVertexIndicator(e);break;case o.RASTER_PIXEL:this.renderPixelIndicator(e)}},h.drawLine=function(e,t,i,r){r===a&&(this.overlayType=2);for(var n=0;n<e.vertices.length;n+=2){var s=this.cylinderMesh(e.vertices[n],e.vertices[n+1],t,i);this.setEdgeScale(s),this.addOverlay(r,s)}},h.drawPoint=function(e,t,i){if(!this.viewer.model.getData().isLeaflet){u||(u=new THREE.SphereGeometry(1));var r=new THREE.Mesh(u,t);r.position.set(e.x,e.y,e.z),this.setPointScale(r),i===a&&(this.overlayType=3),this.addOverlay(i,r)}},h.drawCircle=function(e,t,i){var r=new THREE.TorusGeometry(1.2,.2,2,20),n=new THREE.Mesh(r,t);n.lookAt(this.viewer.navigation.getEyeVector().normalize()),r=null,n.position.set(e.x,e.y,e.z),this.setCircleScale(n),this.addOverlay(i,n)},h.setScale=function(e){var t=this.viewer.navigation,i=t.getCamera(),r=t.getPosition(),n=e.clone(),s=i.isPerspective?n.sub(r).length():t.getEyeVector().length(),o=t.getVerticalFov();return 5*(2*s*Math.tan(THREE.Math.degToRad(.5*o)))/t.getScreenViewport().height},h.setPointScale=function(e){var t=this.setScale(e.position);e.scale.x=t,e.scale.y=t,e.scale.z=t},h.setCircleScale=function(e){var t=this.setScale(e.position);e.scale.x=t,e.scale.y=t},h.setEdgeScale=function(e){var t=this.setScale(e.position);e.scale.x=t,e.scale.z=t},h.updatePointScale=function(e){if(3==this.overlayType){var t=this.viewer.impl.overlayScenes[e];if(t)for(var i=t.scene,r=0;r<i.children.length;r++){var n=i.children[r];n&&this.setPointScale(n)}}},h.updateEdgeScale=function(e){if(2==this.overlayType){var t=this.viewer.impl.overlayScenes[e];if(t)for(var i=t.scene,r=0;r<i.children.length;r++){var n=i.children[r];n&&this.setEdgeScale(n)}}},h.onCameraChange=function(){this.updatePointScale(a),this.updateEdgeScale(a),this.render()},h.destroy=function(){this.removeOverlay(a),this.removeOverlay(c),u&&(u.dispose(),u=null)}},"./extensions/Snapping/index.js":
/*!**************************************!*\
  !*** ./extensions/Snapping/index.js ***!
  \**************************************/
/*! no static exports found */function(e,t,i){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=Bimfish.Viewing,u=AutodeskNamespace("Bimfish.Viewing.Extensions.Snapping");function l(t,i){for(var r in t)t.hasOwnProperty(r)&&(e.exports[r]=t[r],i[r]=t[r])}l(i(/*! ./SnapMath.js */"./extensions/Snapping/SnapMath.js"),u),l(i(/*! ./Snapper.js */"./extensions/Snapping/Snapper.js"),u),l(i(/*! ./SnapperIndicator.js */"./extensions/Snapping/SnapperIndicator.js"),u);var h=function(e){function t(e,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,o(t).call(this,e,i))}var i,r,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(t,e),i=t,(r=[{key:"load",value:function(){return this.viewer.loadExtension("Bimfish.CompGeom")}},{key:"unload",value:function(){return!0}},{key:"activate",value:function(){return!0}},{key:"deactivate",value:function(){return!1}}])&&n(i.prototype,r),c&&n(i,c),t}(c.Extension);c.theExtensionManager.registerExtension("Bimfish.Snapping",h)},"./node_modules/webpack/buildin/global.js":
/*!***********************************!*\
  !*** (webpack)/buildin/global.js ***!
  \***********************************/
/*! no static exports found */function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},"./src/compat.js":
/*!***********************!*\
  !*** ./src/compat.js ***!
  \***********************/
/*! exports provided: getGlobal, isBrowser, isNodeJS, isIE11, launchFullscreen, exitFullscreen, inFullscreen, fullscreenElement, isFullscreenAvailable, getAndroidVersion, isTouchDevice, isIOSDevice, isAndroidDevice, isMobileDevice, isSafari, isFirefox, isChrome, isMac, isWindows, ObjectAssign, disableDocumentTouchSafari, enableDocumentTouchSafari, touchStartToClick */function(e,t,i){"use strict";i.r(t),function(e){function r(){return"undefined"!=typeof window&&null!==window?window:"undefined"!=typeof self&&null!==self?self:e}i.d(t,"getGlobal",(function(){return r})),i.d(t,"isBrowser",(function(){return o})),i.d(t,"isNodeJS",(function(){return a})),i.d(t,"isIE11",(function(){return c})),i.d(t,"launchFullscreen",(function(){return u})),i.d(t,"exitFullscreen",(function(){return l})),i.d(t,"inFullscreen",(function(){return h})),i.d(t,"fullscreenElement",(function(){return d})),i.d(t,"isFullscreenAvailable",(function(){return p})),i.d(t,"getAndroidVersion",(function(){return f})),i.d(t,"isTouchDevice",(function(){return v})),i.d(t,"isIOSDevice",(function(){return m})),i.d(t,"isAndroidDevice",(function(){return E})),i.d(t,"isMobileDevice",(function(){return b})),i.d(t,"isSafari",(function(){return w})),i.d(t,"isFirefox",(function(){return x})),i.d(t,"isChrome",(function(){return T})),i.d(t,"isMac",(function(){return A})),i.d(t,"isWindows",(function(){return V})),i.d(t,"ObjectAssign",(function(){return S})),i.d(t,"disableDocumentTouchSafari",(function(){return C})),i.d(t,"enableDocumentTouchSafari",(function(){return M})),i.d(t,"touchStartToClick",(function(){return P}));var n=r(),s=n&&n.document,o="undefined"!=typeof navigator,a=function(){return!o},c=o&&!!navigator.userAgent.match(/Edge|Trident\/7\./);function u(e,t){e.requestFullscreen?e.requestFullscreen(t):e.mozRequestFullScreen?e.mozRequestFullScreen(t):e.webkitRequestFullscreen?e.webkitRequestFullscreen(t):e.msRequestFullscreen&&e.msRequestFullscreen(t)}function l(e){h(e)&&(e.exitFullscreen?e.exitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.msExitFullscreen&&e.msExitFullscreen())}function h(e){return"webkitIsFullScreen"in e?!!e.webkitIsFullScreen:"fullscreenElement"in e?!!e.fullscreenElement:"mozFullScreenElement"in e?!!e.mozFullScreenElement:"msFullscreenElement"in e?!!e.msFullscreenElement:!!e.querySelector(".viewer-fill-browser")}function d(e){return e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement}function p(e){return e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullscreen||e.msRequestFullscreen}function f(e){var t=(e=e||navigator.userAgent).match(/Android\s([0-9\.]*)/);return!!t&&t[1]}function v(){return"undefined"!=typeof window&&("ontouchstart"in window||navigator.maxTouchPoints>0)}"undefined"!=typeof window&&c&&function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=s.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}e.prototype=n.CustomEvent.prototype,n.CustomEvent=e}(),ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(e,t){if(!t||t>this.byteLength?t=this.byteLength:t<0&&(t=this.byteLength+t)<0&&(t=0),e<0&&(e=this.byteLength+e)<0&&(e=0),t<=e)return new ArrayBuffer;for(var i=t-e,r=new Uint8Array(this,e,i),n=new Uint8Array(i),s=0;s<i;s++)n[s]=r[s];return n.buffer}),Math.log2=Math.log2||function(e){return Math.log(e)/Math.LN2},"undefined"!=typeof window&&(n.BlobBuilder=n.BlobBuilder||n.WebKitBlobBuilder||n.MozBlobBuilder||n.MSBlobBuilder);var g=o&&(/ip(ad|hone|od)/.test(navigator.userAgent.toLowerCase())||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1);function m(){return g}var y=o&&-1!==navigator.userAgent.toLowerCase().indexOf("android");function E(){return y}function b(){return!!o&&(m()||E())}function w(){if(!o)return!1;var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("safari")&&-1===e.indexOf("chrome")}function x(){return!!o&&-1!==navigator.userAgent.toLowerCase().indexOf("firefox")}function T(){return!!o&&-1!==navigator.userAgent.toLowerCase().indexOf("chrome")}function A(){return!!o&&-1!==navigator.userAgent.toLowerCase().indexOf("mac os")}function V(){if(!o)return!1;var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("win32")||-1!==e.indexOf("windows")}function S(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function R(e){var t=n.hasOwnProperty("pageXOffset")?n.pageXOffset:s.documentElement.scrollLeft,i=n.hasOwnProperty("pageYOffset")?n.pageYOffset:s.documentElement.scrollTop,r=void 0===e.pageX?e.changedTouches[0].pageX:e.pageX,o=void 0===e.pageY?e.changedTouches[0].pageY:e.pageY,a=s.elementFromPoint(r-t,o-i);return!a||"CANVAS"!==a.nodeName||(!!a.getAttribute(!0)||(e.preventDefault(),!1))}function C(){b()&&w()&&(s.documentElement.addEventListener("touchstart",R,!0),s.documentElement.addEventListener("touchmove",R,!0),s.documentElement.addEventListener("touchcanceled",R,!0),s.documentElement.addEventListener("touchend",R,!0))}function M(){b()&&w()&&(s.documentElement.removeEventListener("touchstart",R,!0),s.documentElement.removeEventListener("touchmove",R,!0),s.documentElement.removeEventListener("touchcanceled",R,!0),s.documentElement.removeEventListener("touchend",R,!0))}function P(e){e.target.className.indexOf("fullscreen")>-1||e.target.className.indexOf("webvr")>-1||(e.preventDefault(),e.stopPropagation(),e.target.click())}!function(){var e=r();e.performance||(e.performance=Date)}(),Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},String.prototype.repeat=String.prototype.repeat||function(e){if(e<1)return"";for(var t="",i=this.valueOf();e>1;)1&e&&(t+=i),e>>=1,i+=i;return t+i},Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{enumerable:!1,value:function(e,t,i){t=void 0===t?0:t,i=void 0===i?this.length:i;for(var r=t;r<i;++r)this[r]=e}}),Int32Array.prototype.lastIndexOf=Int32Array.prototype.lastIndexOf||function(e,t){return Array.prototype.lastIndexOf.call(this,e,t)},Array.prototype.find||Object.defineProperty(Array.prototype,"find",{enumerable:!1,value:function(e,t){for(var i=this.length,r=0;r<i;++r){var n=this[r];if(e.call(t,n,r,this))return n}}}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),r=1;r<arguments.length;r++){var n=arguments[r];if(null!=n)for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=n[s])}return i},writable:!0,configurable:!0}),"undefined"==typeof window||!c&&!m()||HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,i){var r=this;setTimeout((function(){for(var n=atob(r.toDataURL(t,i).split(",")[1]),s=n.length,o=new Uint8Array(s),a=0;a<s;a++)o[a]=n.charCodeAt(a);e(new Blob([o],{type:t||"image/png"}))}))}}),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(e,t){if(t=void 0!==t?t:this.length,"[object Array]"===Object.prototype.toString.call(this))return _slice.call(this,e,t);var i,r,n=[],s=this.length,o=e||0;o=o>=0?o:Math.max(0,s+o);var a="number"==typeof t?Math.min(t,s):s;if(t<0&&(a=s+t),(r=a-o)>0)if(n=new Array(r),this.charAt)for(i=0;i<r;i++)n[i]=this.charAt(o+i);else for(i=0;i<r;i++)n[i]=this[o+i];return n})}.call(this,i(/*! ./../node_modules/webpack/buildin/global.js */"./node_modules/webpack/buildin/global.js"))},"./src/wgs/scene/VertexBufferReader.js":
/*!*********************************************!*\
  !*** ./src/wgs/scene/VertexBufferReader.js ***!
  \*********************************************/
/*! exports provided: VertexBufferReader, BoundsCallback */function(e,t,i){"use strict";i.r(t),i.d(t,"VertexBufferReader",(function(){return s})),i.d(t,"BoundsCallback",(function(){return o}));var r=i(/*! three */"three"),n=2*Math.PI;function s(e){this.vb=e.vb.buffer,this.vbf=new Float32Array(this.vb),this.vbi=new Int32Array(this.vb),this.vbs=new Uint16Array(this.vb),this.ib=e.ib,this.stride=e.vbstride,this.vcount=this.vbf.length/this.stride,this.useInstancing=e.numInstances>0,this.useCompactBuffers=e.unpackXform,this.texData=this.useCompactBuffers&&e.tIdColor&&e.tIdColor.image&&e.tIdColor.image.data&&new Uint32Array(e.tIdColor.image.data.buffer)}function o(e){this.bounds=e,this.point=new r.Vector4,this.point.z=0,this.point.w=1}s.prototype.getDbIdAt=function(e){return this.texData?this.texData[this.vbs[e*this.stride*2+7]]:this.vbi[e*this.stride+7]},s.prototype.getColorAt=function(e){return this.texData?this.texData[this.vbs[e*this.stride*2+6]]:this.vbi[e*this.stride+6]},s.prototype.getVertexFlagsAt=function(e){return this.texData?this.vbi[e*this.stride+4]:this.vbi[e*this.stride+8]},s.prototype.getLayerIndexAt=function(e){return this.texData?65535&this.vbi[e*this.stride+5]:65535&this.vbi[e*this.stride+9]},s.prototype.getViewportIndexAt=function(e){return this.texData?this.vbi[e*this.stride+5]>>16&65535:this.vbi[e*this.stride+9]>>16&65535},s.prototype.decodeLineAt=function(e,t,i,r){if(r.onLineSegment){if(this.useCompactBuffers)var s=this.stride*e*2,o=this.useCompactBuffers.x*this.vbs[s]/65535+this.useCompactBuffers.z,a=this.useCompactBuffers.y*this.vbs[s+1]/65535+this.useCompactBuffers.w,c=this.vbs[s+2]/65535*n-Math.PI,u=this.vbs[s+3]/65535*Math.max(this.useCompactBuffers.x,this.useCompactBuffers.y),l=this.vbs[s+4]/32767*Math.max(this.useCompactBuffers.x,this.useCompactBuffers.y)*2;else{var h=this.stride*e;o=this.vbf[h],a=this.vbf[h+1],c=this.vbf[h+2]*n-Math.PI,u=this.vbf[h+3],l=2*this.vbf[h+4]}var d=o+u*Math.cos(c),p=a+u*Math.sin(c);r.onLineSegment(o,a,d,p,i,l)}},s.prototype.decodeCircularArcAt=function(e,t,i,r){if(r.onCircularArc){if(this.useCompactBuffers)var s=this.stride*e*2,o=this.useCompactBuffers.x*this.vbs[s]/65535+this.useCompactBuffers.z,a=this.useCompactBuffers.y*this.vbs[s+1]/65535+this.useCompactBuffers.w,c=this.vbs[s+2]/65535*n,u=this.vbs[s+3]/65535*n,l=this.vbs[s+5]/65535*Math.max(this.useCompactBuffers.x,this.useCompactBuffers.y);else{var h=this.stride*e;o=this.vbf[h],a=this.vbf[h+1],c=this.vbf[h+2]*n,u=this.vbf[h+3]*n,l=this.vbf[h+5]}r.onCircularArc(o,a,c,u,l,i)}},s.prototype.decodeEllipticalArcAt=function(e,t,i,r){if(r.onEllipticalArc){var s=this.stride*e,o=this.vbf[s],a=this.vbf[s+1],c=this.vbf[s+2]*n,u=this.vbf[s+3]*n,l=this.vbf[s+5],h=this.vbf[s+10],d=this.vbf[s+11];r.onEllipticalArc(o,a,c,u,l,h,d,i)}},s.prototype.decodeTexQuadAt=function(e,t,i,r){if(r.onTexQuad){if(this.useCompactBuffers)var s=this.stride*e*2,o=this.useCompactBuffers.x*this.vbs[s]/65535+this.useCompactBuffers.z,a=this.useCompactBuffers.y*this.vbs[s+1]/65535+this.useCompactBuffers.w,c=this.vbs[s+2]/65535*n,u=this.vbs[s+3]/65535*Math.max(this.useCompactBuffers.x,this.useCompactBuffers.y),l=this.vbs[s+4]/65535*Math.max(this.useCompactBuffers.x,this.useCompactBuffers.y);else{var h=this.stride*e;o=this.vbf[h],a=this.vbf[h+1],c=this.vbf[h+2]*n,u=this.vbf[h+3],l=this.vbf[h+4]}r.onTexQuad(o,a,u,l,c,i)}},s.prototype.decodeOneTriangleAt=function(e,t,i,r){if(r.onOneTriangle){if(this.useCompactBuffers)var n=this.stride*e*2,s=this.useCompactBuffers.x*this.vbs[n]/65535+this.useCompactBuffers.z,o=this.useCompactBuffers.y*this.vbs[n+1]/65535+this.useCompactBuffers.w,a=this.useCompactBuffers.x*this.vbs[n+2]/65535+this.useCompactBuffers.z,c=this.useCompactBuffers.y*this.vbs[n+3]/65535+this.useCompactBuffers.w,u=this.useCompactBuffers.x*this.vbs[n+4]/65535+this.useCompactBuffers.z,l=this.useCompactBuffers.y*this.vbs[n+5]/65535+this.useCompactBuffers.w;else{var h=this.stride*e;s=this.vbf[h],o=this.vbf[h+1],a=this.vbf[h+2],c=this.vbf[h+3],u=this.vbf[h+4],l=this.vbf[h+5]}r.onOneTriangle(s,o,a,c,u,l,i)}},s.prototype.decodeTriangleIndexed=function(e,t,i,r,n,s){if(s.onOneTriangle){if(this.useCompactBuffers){var o=this.stride*e*2,a=this.useCompactBuffers.x*this.vbs[o]/65535+this.useCompactBuffers.z,c=this.useCompactBuffers.y*this.vbs[o+1]/65535+this.useCompactBuffers.w;o=this.stride*t*2;var u=this.useCompactBuffers.x*this.vbs[o]/65535+this.useCompactBuffers.z,l=this.useCompactBuffers.y*this.vbs[o+1]/65535+this.useCompactBuffers.w;o=this.stride*i*2;var h=this.useCompactBuffers.x*this.vbs[o]/65535+this.useCompactBuffers.z,d=this.useCompactBuffers.y*this.vbs[o+1]/65535+this.useCompactBuffers.w}else{var p=this.stride*e;a=this.vbf[p],c=this.vbf[p+1];p=this.stride*t;u=this.vbf[p],l=this.vbf[p+1];p=this.stride*i;h=this.vbf[p],d=this.vbf[p+1]}s.onOneTriangle(a,c,u,l,h,d,n)}},s.prototype.enumGeomsForObject=function(e,t){if(this.useInstancing)for(var i=0;i<this.vcount;){var r=this.getVertexFlagsAt(i)>>8&255,n=this.getLayerIndexAt(i),s=this.getViewportIndexAt(i);if(a=this.getDbIdAt(i)===e)switch(r){case 1:this.decodeLineAt(i,n,s,t);break;case 2:this.decodeCircularArcAt(i,n,s,t);break;case 3:this.decodeEllipticalArcAt(i,n,s,t);break;case 4:this.decodeTexQuadAt(i,n,s,t);break;case 5:this.decodeOneTriangleAt(i,n,s,t)}i+=1}else for(i=0;i<this.ib.length;){var o=this.ib[i],a=(r=this.getVertexFlagsAt(o)>>8&255,n=this.getLayerIndexAt(o),s=this.getViewportIndexAt(o),this.getDbIdAt(o)===e);if(0===r)a&&this.decodeTriangleIndexed(this.ib[i],this.ib[i+1],this.ib[i+2],n,s,t),i+=3;else{if(a)switch(r){case 1:this.decodeLineAt(o,n,s,t);break;case 2:this.decodeCircularArcAt(o,n,s,t);break;case 3:this.decodeEllipticalArcAt(o,n,s,t);break;case 4:this.decodeTexQuadAt(o,n,s,t);break;case 5:this.decodeOneTriangleAt(o,n,s,t)}i+=6}}},s.prototype.enumGeomsForVisibleLayer=function(e,t){this.enumGeoms((function(t,i,r){return!e||0!==i&&-1!==e.indexOf(i)}),t)},s.prototype.enumGeoms=function(e,t){if(this.useInstancing)for(var i=0;i<this.vcount;){var r=this.getVertexFlagsAt(i)>>8&255,n=this.getLayerIndexAt(i),s=this.getViewportIndexAt(i),o=this.getDbIdAt(i);if(c=!e||e(o,n,s))switch(r){case 1:this.decodeLineAt(i,n,s,t);break;case 2:this.decodeCircularArcAt(i,n,s,t);break;case 3:this.decodeEllipticalArcAt(i,n,s,t);break;case 4:this.decodeTexQuadAt(i,n,s,t);break;case 5:this.decodeOneTriangleAt(i,n,s,t)}i+=1}else for(i=0;i<this.ib.length;){var a=this.ib[i],c=(r=this.getVertexFlagsAt(a)>>8&255,n=this.getLayerIndexAt(a),s=this.getViewportIndexAt(a),o=this.getDbIdAt(a),!e||e(o,n,s));if(0===r)c&&this.decodeTriangleIndexed(this.ib[i],this.ib[i+1],this.ib[i+2],n,s,t),i+=3;else{if(c)switch(r){case 1:this.decodeLineAt(a,n,s,t);break;case 2:this.decodeCircularArcAt(a,n,s,t);break;case 3:this.decodeEllipticalArcAt(a,n,s,t);break;case 4:this.decodeTexQuadAt(a,n,s,t);break;case 5:this.decodeOneTriangleAt(a,n,s,t)}i+=6}}},o.prototype.onVertex=function(e,t,i){this.point.x=e,this.point.y=t,this.bounds.expandByPoint(this.point)},o.prototype.onLineSegment=function(e,t,i,r,n){this.onVertex(e,t),this.onVertex(i,r)},o.prototype.onCircularArc=function(e,t,i,r,n,s){this.onEllipticalArc(e,t,i,r,n,n,0,s)},o.prototype.onEllipticalArc=function(e,t,i,r,n,s,o,a){0==o?i<=0&&r>=2*Math.PI-1e-5?this.onTexQuad(e,t,2*n,2*s,o,a):(this.point.x=e+Math.cos(i)*n,this.point.y=t+Math.sin(i)*s,this.bounds.expandByPoint(this.point),this.point.x=e+Math.cos(r)*n,this.point.y=t+Math.sin(r)*s,this.bounds.expandByPoint(this.point),i>r&&(this.point.x=e+n,this.point.y=t,this.bounds.expandByPoint(this.point),i-=2*Math.PI),i<.5*Math.PI&&r>.5*Math.PI&&(this.point.x=e,this.point.y=t+s,this.bounds.expandByPoint(this.point)),i<Math.PI&&r>Math.PI&&(this.point.x=e-n,this.point.y=t,this.bounds.expandByPoint(this.point)),i<1.5*Math.PI&&r>1.5*Math.PI&&(this.point.x=e,this.point.y=t-s,this.bounds.expandByPoint(this.point))):this.onTexQuad(e,t,2*n,2*s,o,a)},o.prototype.onTexQuad=function(e,t,i,n,s,o){var a=.5*i,c=.5*i;if(0==s)this.onVertex(e-a,t-c),this.onVertex(e+a,t+c);else{var u=new r.Matrix4,l=new r.Matrix4;u.makeRotationZ(s),l.makeTranslation(e,t,0),l.multiply(u);for(var h=0;h<4;h++)this.point.x=h%2==1?a:-a,this.point.y=h>=2?c:-c,this.point.applyMatrix4(l),this.bounds.expandByPoint(this.point)}},o.prototype.onOneTriangle=function(e,t,i,r,n,s,o){this.onVertex(e,t),this.onVertex(i,r),this.onVertex(n,s)}},three:
/*!************************!*\
  !*** external "THREE" ***!
  \************************/
/*! no static exports found */function(e,t){e.exports=THREE}});