/*!
 * LMV v7.9.0
 * 
 * Copyright 2019 Bimfish, Inc.
 * All rights reserved.
 * 
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Bimfish, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Bimfish, Inc.
 * 
 * Bimfish Forge Viewer Usage Limitations:
 * 
 * The Bimfish Forge viewer can only be used to view files generated by
 * Bimfish Forge services. The Bimfish Forge Viewer JavaScript must be
 * delivered from an Bimfish hosted URL.
 */
Bimfish.Extensions.AEC=function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s="./extensions/AEC/LibraryExports.js")}({"./extensions/AEC/CanvasBookmark/CanvasBookmark.css":
/*!**********************************************************!*\
  !*** ./extensions/AEC/CanvasBookmark/CanvasBookmark.css ***!
  \**********************************************************/
/*! no static exports found */function(e,t,i){var n=i(/*! !../../../node_modules/css-loader!../../../node_modules/sass-loader/dist/cjs.js!./CanvasBookmark.css */"./node_modules/css-loader/index.js!./node_modules/sass-loader/dist/cjs.js!./extensions/AEC/CanvasBookmark/CanvasBookmark.css");"string"==typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};i(/*! ../../../node_modules/style-loader/lib/addStyles.js */"./node_modules/style-loader/lib/addStyles.js")(n,o);n.locals&&(e.exports=n.locals)},"./extensions/AEC/CanvasBookmark/CanvasBookmark.js":
/*!*********************************************************!*\
  !*** ./extensions/AEC/CanvasBookmark/CanvasBookmark.js ***!
  \*********************************************************/
/*! exports provided: default */function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return T}));var n=i(/*! ./CanvasBookmarkIcons.js */"./extensions/AEC/CanvasBookmark/CanvasBookmarkIcons.js"),o=i(/*! ./CreateFrustumShape.js */"./extensions/AEC/CanvasBookmark/CreateFrustumShape.js"),r=i(/*! ./HCluster.js */"./extensions/AEC/CanvasBookmark/HCluster.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c,u,p,m,v,f,g,y,E,w=Bimfish.Viewing,b=w.Private,M=Bimfish.Viewing.UI,x=AutodeskNamespace("Bimfish.AEC"),k="CanvasBookmark_Extension_Overlay",S=(c=new THREE.Vector3,u=new THREE.Vector3,p=new THREE.Vector3,m=new THREE.Vector3,v=new THREE.Quaternion,f=new THREE.Quaternion,g=new THREE.Vector3,y=new THREE.Vector3,E=new THREE.Quaternion,function(e,t,i,n){return e.decompose(c,v,p),t.decompose(u,f,m),g.lerpVectors(c,u,i),y.lerpVectors(p,m,i),THREE.Quaternion.slerp(v,f,E,i),n.compose(g,E,y),n}),C=function(e){var t=e.clone();return t.transform=e.transform?e.transform.clone():new THREE.Matrix4,t},_=function(e,t){e.visiblityChangePending=!0,requestAnimationFrame((function(){t?e.container.classList.add("visible"):e.container.classList.remove("visible"),e.visiblityChangePending=!1}))},T=function(e){function t(e,i){var n,o,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(n=!(s=l(t).call(this,e,i))||"object"!==a(s)&&"function"!=typeof s?h(o):s).viewer=e,n.bookmarks=[],n.clusteredBookmarks=[],n.camera=n.viewer.navigation.getCamera(),n.cameraMovedCB=n.onCameraMoved.bind(h(n)),n.onVisibilityChangedCB=n.onVisibilityChanged.bind(h(n)),n.sectionBox=null,n.activeSectionBox=null,n.animStartSectionBox=null,n.animEndSectionBox=null,n.sectionBoxAnim=null,n.changeBookmarksVisibility=n.changeBookmarksVisibility.bind(h(n)),n.changeBookmarksVisibilityTimeout=null,n._clusteringEnabled=void 0!==n.options.clusterfck,n._clusteringThreshold=n.options.clusteringThreshold||110,n._clusteringEnabled&&(n.hcluster=new r.default(n.options.clusterfck,(function(e,t){var i=new THREE.Vector2(e.currentPosProjected.x,e.currentPosProjected.y);return new THREE.Vector2(t.currentPosProjected.x,t.currentPosProjected.y).distanceTo(i)}),n._clusteringThreshold)),n._filterOutInvisibleBookmark=n._filterOutInvisibleBookmark.bind(h(n)),n.levelChangedCB=n.onLevelChanged.bind(h(n)),n.extensionLoadedCB=n.onExtensionLoaded.bind(h(n)),n.isFrustumFading=!1,n.waitingCallbacks=[],n}var i,c,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),i=t,(c=[{key:"setBookmarksVisible",value:function(e){this.bookmarks.forEach((function(t){return _(t.marker,e)})),this.clusteredBookmarks.forEach((function(t){return _(t.marker,e)})),e||this.stopGhosting()}},{key:"onVisibilityChanged",value:function(e){this.viewer.prefs&&this.viewer.prefs.set("canvasBookmarks",e),this.setBookmarksVisible(e),e&&this.updateBookmarkPositions()}},{key:"isVisible",value:function(){return this.viewer.prefs&&this.viewer.prefs.get("canvasBookmarks")}},{key:"onCameraMoved",value:function(){this.setBookmarksVisible(!1),this.debounceBookmarksVisibility()}},{key:"createTooltip",value:function(e,t){e.setToolTip(t.name()),e._toolTipElement.innerHTML="<b>".concat(t.name(),"</b>")}},{key:"flyToBookmark",value:function(e){var t={position:e.pos,target:e.target,up:e.up};this.anim=b.flyToView(this.viewer,t,1)}},{key:"createBookmark",value:function(e){var t=this,i=e.extractCamera();if(i){var o=i.position,r=i.target,a=e.getRootNode().extractRefPointTransform();this.options.globalOffset&&a&&(o.applyMatrix4(a),o.sub(this.options.globalOffset),r.applyMatrix4(a),r.sub(this.options.globalOffset));var s=new THREE.Vector3(r.x-o.x,r.y-o.y,r.z-o.z).normalize(),l=new THREE.Vector3(0,0,1),h=new Bimfish.Viewing.UI.Button("b-".concat(e.name().replace(/\s/g,"")));h.container.classList.add("canvas-bookmark"),h.container.innerHTML=Object(n.createCameraIcon)(),_(h,this.isVisible()),this.createTooltip(h,e),this.viewer.container.appendChild(h.container);var d=h.getDimensions(),c=this.findSectionBox(e,e.name()),u=c?c.center().applyMatrix4(c.transform):null,p={marker:h,pos:c?u:o,cameraPos:o,dir:s,up:l,target:r,name:e.name(),anchorX:d.width/2,anchorY:d.height/2,fadeValue:0,hovered:!1,bubbleNode:e,clustered:!1};return h.container.addEventListener("mouseenter",(function(){t.onBookmarkMouseEnter(p)})),h.container.addEventListener("mouseleave",(function(){t.onBookmarkMouseLeave(p)})),h.addEventListener(M.Button.Event.CLICK,(function(){t.options&&t.options.onBookmark&&t.options.onBookmark(p.bubbleNode,i)})),p}}},{key:"createClusteredBookmark",value:function(e,t,i){var o=this,a=new Bimfish.Viewing.UI.Button(t);a.container.classList.add("clustered-canvas-bookmark"),a.container.innerHTML=Object(n.createClusteredCameraIcon)(),_(a,this.isVisible()&&i),this.viewer.container.appendChild(a.container);var s=r.default.ComputeMeanValueForFlattenCluster(e),l={marker:a,name:t,pos:s.center3D,currentPosProjected:s.center2D,cluster:e,fadeValue:0,hovered:!1,folded:!0};a.container.addEventListener("mouseenter",(function(){o.onClusteredBookmarkMouseEnter(l)})),a.container.addEventListener("mouseleave",(function(){o.onClusteredBookmarkMouseLeave(l)})),a.addEventListener(M.Button.Event.CLICK,(function(){o.onClusteredBookmarkClicked(l)})),l.marker.container.style.transform="translate(".concat(s.center2D.x,"px, ").concat(s.center2D.y,"px)"),this.clusteredBookmarks.push(l)}},{key:"deleteBookmark",value:function(e){this.viewer.container.removeChild(e.marker.container),this.hideFrustumShape(e)}},{key:"clearBookmarks",value:function(){var e=this;this.stopSectionBoxAnim(),this.applySectionBox(),this.bookmarks.forEach((function(t){e.deleteBookmark(t)})),this.bookmarks=[],this.clusteredBookmarks.forEach((function(t){e.deleteBookmark(t)})),this.clusteredBookmarks=[]}},{key:"resetBookmarks",value:function(e){var t=this;this.clearBookmarks(),e&&w.Document.getAecModelData(e).then((function(){for(var i=0;i<e.length;i++){var n=e[i],o=t.createBookmark(n);o&&t.bookmarks.push(o)}t.bookmarkData=e,t.updateBookmarkPositions()}))}},{key:"resetGlobalOffset",value:function(e){this.options.globalOffset=e,this.resetBookmarks(this.bookmarkData)}},{key:"showFrustumShape",value:function(e){e.frustumShape||(e.frustumShape=Object(o.createFrustumShape)(e.cameraPos,e.dir),this.viewer.impl.addOverlay(k,e.frustumShape),e.frustumShape.name=e.bubbleNode.name(),this.viewer.impl.updateCameraMatrices())}},{key:"hideFrustumShape",value:function(e){e.frustumShape&&(this.viewer.impl.removeOverlay(k,e.frustumShape),e.frustumShape=null)}},{key:"setFrustumFadeValue",value:function(e,t){e.fadeValue=t,e.frustumShape&&e.frustumShape.setFadeValue(t)}},{key:"updateFrustumShapeFading",value:function(e,t){var i=e.hovered&&e.fadeValue<1,n=!e.hovered&&e.fadeValue>0;if(!i&&!n)return!1;var o=t/500,r=t/500,a=e.fadeValue+(i?o:-r);return a=THREE.Math.clamp(a,0,1),this.setFrustumFadeValue(e,a),e.marker&&e.marker._toolTipElement&&(e.marker._toolTipElement.style.opacity=Math.min(1,3*a)),e.hovered||0!==e.fadeValue||this.hideFrustumShape(e),this.viewer.impl.invalidate(!1,!1,!0),!0}},{key:"requestTimer",value:function(){var e=this,t=this.getWindow();this.timerId=t.requestAnimationFrame((function(){return e.onTimer()}))}},{key:"onTimer",value:function(){var e=this,t=performance.now(),i=t-this.lastTime;this.lastTime=t,this.isFrustumFading=!1,this.bookmarks.forEach((function(t){var n=e.updateFrustumShapeFading(t,i);e.isFrustumFading=e.isFrustumFading||n})),this.isAllDone()&&(this.waitingCallbacks.forEach((function(e){return e()})),this.waitingCallbacks.length=0),this.requestTimer()}},{key:"findSectionBox",value:function(e,t){var i=e.search({type:"view"});if(!i.length||i[0].data.name!==t)return null;var n=i[0].data.sectionBox,o=i[0].data.sectionBoxTransform;if(!n||!o)return null;var r=(new THREE.Matrix4).fromArray([o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9],o[10],o[11],o[12],o[13],o[14],o[15]]),a=new THREE.Box3;a.min.set(n[0],n[1],n[2]),a.max.set(n[3],n[4],n[5]),a.transform=new THREE.Matrix4;var s=e.getRootNode().getAecModelData().refPointTransformation;if(this.options.globalOffset&&s){var l=this.options.globalOffset,h=w.BubbleNode.readMatrixFromArray12(s);a.transform.makeTranslation(-l.x,-l.y,-l.z),a.transform.multiply(h),a.transform.multiply(r)}return a}},{key:"setOverlaySceneVisible",value:function(e){var t=this.viewer.impl.overlayScenes[k],i=t&&t.scene;i&&(i.visible=e)}},{key:"getFadeExtension",value:function(){return this.viewer.getExtension("Bimfish.CrossFadeEffects")}},{key:"showGhosting",value:function(){var e=this,t=this.getFadeExtension();t&&(t.acquireControl("CanvasBookmarks",(function(){return e.stopGhosting()})),this.ghostingActive?this.stopGhostFadeOut():(this.viewer.impl.setCutPlaneSet("CanvasBookmark_CutPlanes"),this.setOverlaySceneVisible(!1),t.renderFadingImage(0),this.applySectionBox(this.activeSectionBox),this.setOverlaySceneVisible(!0),this.ghostingActive=!0),t.setCrossFadeOpacity(0,.3))}},{key:"stopGhosting",value:function(){if(this.ghostingActive){this.stopGhostFadeOut();var e=this.getFadeExtension();e&&e.releaseFadingImage(0),this.ghostingActive=!1}}},{key:"stopGhostFadeOut",value:function(){this.ghostFadeAnim&&(this.ghostFadeAnim.skip(),this.ghostFadeAnim=null)}},{key:"fadeOutGhosting",value:function(){var e=this.getFadeExtension();if(this.ghostingActive&&e){var t=e.getCrossFadeOpacity(0);this.ghostFadeAnim=b.fadeValue(t,0,.5,(function(t){return e.setCrossFadeOpacity(0,t)}))}}},{key:"onBookmarkMouseEnter",value:function(e){var t=this.findSectionBox(e.bubbleNode,e.name);t&&(this.showGhosting(),this.animateToSectionBox(t)),this.showFrustumShape(e),e.hovered=!0}},{key:"onBookmarkMouseLeave",value:function(e){this.animateToSectionBox(null),this.fadeOutGhosting(),e.hovered=!1}},{key:"onClusteredBookmarkMouseEnter",value:function(e){e.hovered=!0}},{key:"onClusteredBookmarkMouseLeave",value:function(e){e.hovered=!1}},{key:"onClusteredBookmarkClicked",value:function(e){if(e.folded){for(var t=function(e,t,i){var n=Math.cos(i),o=Math.sin(i),r=e.x-t.x,a=e.y-t.y;e.x=r*n-a*o+t.x,e.y=r*o+a*n+t.y},i=e.cluster.length,n=Math.round(360/i),o=new THREE.Vector2(e.currentPosProjected.x,e.currentPosProjected.y),r=new THREE.Vector2(o.x,o.y+35),a=0;a<i;++a){var s=e.cluster[a],l=r.clone();t(l,o,a*n*Math.PI/180),s.currentPosProjected.x=l.x,s.currentPosProjected.y=l.y,s.marker.container.style.transform="translate(".concat(l.x,"px, ").concat(l.y,"px)"),_(s.marker,!0)}e.marker.container.classList.add("declustered-canvas-bookmark")}else e.cluster.forEach((function(e){_(e.marker,!1)})),e.marker.container.classList.remove("declustered-canvas-bookmark");e.folded=!e.folded}},{key:"debounceBookmarksVisibility",value:function(){this.changeBookmarksVisibilityTimeout&&clearTimeout(this.changeBookmarksVisibilityTimeout),this.changeBookmarksVisibilityTimeout=setTimeout(this.changeBookmarksVisibility,100)}},{key:"changeBookmarksVisibility",value:function(){this.updateBookmarkPositions()}},{key:"updateBookmarkPositions",value:function(){var e=this;if(this.isVisible()){this.bookmarks.forEach((function(t){var i=t.bubbleNode.sectionBox,n=i?i.center():t.pos;t.currentPos3D=n;var o=e.project(n);o.x-=t.anchorX,o.y-=t.anchorY,t.currentPosProjected=new THREE.Vector3(o.x,o.y,o.z),t.marker.container.style.transform="translate(".concat(o.x,"px, ").concat(o.y,"px)")}));var t=this._clusteringEnabled?this.hcluster.createClusters(this.bookmarks):[];this.updateClusteredBookmarks(t)}}},{key:"updateClusteredBookmarks",value:function(e){var t=this;this.clusteredBookmarks.forEach((function(e){t.deleteBookmark(e)})),this.clusteredBookmarks=[],this.bookmarks.forEach((function(e){_(e.marker,!1)}));var i=this._getFloorSelector();if(void 0===(i&&i.currentFloor)){this.bookmarks.filter(this._filterOutInvisibleBookmark).forEach((function(e){e.clustered=!1,_(e.marker,!0)}));for(var n=0;n<e.length;n++){var o=e[n];o.size>1&&function(){var e=r.default.FlattenCluster(o),i=!1;e.forEach((function(e){e.clustered=!0,!i&&e.marker.isVisible()&&(i=!0),_(e.marker,!1)})),t.createClusteredBookmark(e,"c-".concat(e[0].bubbleNode.data.viewableID),i)}()}}}},{key:"project",value:function(e){var t=this.viewer.navigation.getScreenViewport(),i=(new THREE.Vector3).copy(e),n=new THREE.Matrix4;return n.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),i.applyProjection(n),new THREE.Vector3(Math.round((i.x+1)/2*t.width),Math.round((1-i.y)/2*t.height),i.z)}},{key:"load",value:function(){this.viewer.prefs.add("canvasBookmarks",!0),this.viewer.addEventListener(w.CAMERA_CHANGE_EVENT,this.cameraMovedCB);var e=this._getFloorSelector();return e&&e.addEventListener(Bimfish.AEC.FloorSelector.CURRENT_FLOOR_CHANGED,this.levelChangedCB),this.viewer.addEventListener(w.EXTENSION_LOADED_EVENT,this.extensionLoadedCB),this.updateBookmarkPositions(),this.viewer.impl.createOverlayScene(k),this.lastTime=performance.now(),this.requestTimer(),this.updateSettingsPanel||(this.updateSettingsPanel=this.configureSettings.bind(this),this.viewer.addEventListener(w.TOOLBAR_CREATED_EVENT,this.updateSettingsPanel)),!0}},{key:"unload",value:function(){this.clearBookmarks(),this.viewer.impl.removeOverlayScene(k),this.viewer.removeEventListener(w.CAMERA_CHANGE_EVENT,this.cameraMovedCB);var e=this._getFloorSelector();return e&&e.removeEventListener(Bimfish.AEC.FloorSelector.CURRENT_FLOOR_CHANGED,this.levelChangedCB),this.viewer.removeEventListener(w.EXTENSION_LOADED_EVENT,this.extensionLoadedCB),this.timerId&&(this.getWindow().cancelAnimationFrame(this.timerId),this.timerId=null),this.updateSettingsPanel&&(this.viewer.removeEventListener(w.TOOLBAR_CREATED_EVENT,this.updateSettingsPanel),this.updateSettingsPanel=null),!0}},{key:"applySectionBox",value:function(e){if(this.activeSectionBox=e,e){var t=b.SceneMath.box2CutPlanes(e,e.transform);this.viewer.impl.setCutPlaneSet("CanvasBookmark_CutPlanes",t)}else this.viewer.impl.setCutPlaneSet("CanvasBookmark_CutPlanes")}},{key:"getModelBox",value:function(){for(var e=this.viewer.impl.modelQueue().getModels(),t=new THREE.Box3,i=0;i<e.length;i++)t.union(e[i].getBoundingBox());return t}},{key:"stopSectionBoxAnim",value:function(){this.sectionBoxAnim&&(this.sectionBoxAnim.stop(),this.sectionBoxAnim=null)}},{key:"animateToSectionBox",value:function(e){var t=this;if(e||this.activeSectionBox){this.stopSectionBoxAnim(),this.animStartBox=this.activeSectionBox?C(this.activeSectionBox):C(this.getModelBox()),this.animEndBox=C(e||this.getModelBox()),this.sectionBox=e;var i=new THREE.Box3;i.transform=new THREE.Matrix4,this.sectionBoxAnim=b.fadeValue(0,1,.5,(function(e){e=b.smootherStep(e),function(e,t,i,n){n.min.lerpVectors(e.min,t.min,i),n.max.lerpVectors(e.max,t.max,i),S(e.transform,t.transform,i,n.transform)}(t.animStartBox,t.animEndBox,e,i),t.applySectionBox(i)}),(function(){t.applySectionBox(t.sectionBox),t.sectionBoxAnim=null}))}}},{key:"enableClustering",value:function(e){this._clusteringEnabled!==e&&(this._clusteringEnabled=e,this.updateClusteredBookmarks([]))}},{key:"setClusteringThreshold",value:function(e){this._clusteringThreshold!==e&&(this._clusteringThreshold=e,this.hcluster.setThreshold(e),this.updateClusteredBookmarks([]))}},{key:"isAllDone",value:function(){var e=this.sectionBoxAnim&&this.sectionBoxAnim.isRunning,t=this.bookmarks.some((function(e){return e.marker&&e.marker.visiblityChangePending}));return!e&&!this.isFrustumFading&&!t}},{key:"waitForAllDone",value:function(){var e=this;return this.onTimer(),this.isAllDone()?Promise.resolve():new Promise((function(t){e.waitingCallbacks.push(t)}))}},{key:"_filterOutInvisibleBookmark",value:function(e){var t=this.viewer.navigation.getScreenViewport();if(e.currentPosProjected.x<0||e.currentPosProjected.x>t.width)return!1;if(e.currentPosProjected.y<0||e.currentPosProjected.y>t.height)return!1;var i=this.camera.target.clone().sub(this.camera.position),n=e.pos.clone().sub(this.camera.position);return i.dot(n)>0}},{key:"onLevelChanged",value:function(){this.updateBookmarkPositions()}},{key:"onExtensionLoaded",value:function(e){"Bimfish.AEC.LevelsExtension"===e.extensionId&&this.updateBookmarkPositions()}},{key:"configureSettings",value:function(){if(this.viewer.getSettingsPanel){var e=this.viewer.getSettingsPanel(!0);if(e.is3dMode){var t=w.Extensions.ViewerSettingTab.Navigation;e.addLabel(t,"Location Icons"),e&&!e.showLocationIconsChkBoxId&&(e.showLocationIconsChkBoxId=e.addCheckbox(t,"Show location icons","Toggles availability of the location icons when looking at the project model",!0,this.onVisibilityChangedCB,"canvasBookmarks"))}}}},{key:"_getFloorSelector",value:function(){var e=this.viewer.getExtension("Bimfish.AEC.LevelsExtension");return e&&e.floorSelector}}])&&s(i.prototype,c),u&&s(i,u),t}(w.Extension);x.CanvasBookmarkExtension=T,Bimfish.Viewing.theExtensionManager.registerExtension("Bimfish.AEC.CanvasBookmarkExtension",T)},"./extensions/AEC/CanvasBookmark/CanvasBookmarkIcons.js":
/*!**************************************************************!*\
  !*** ./extensions/AEC/CanvasBookmark/CanvasBookmarkIcons.js ***!
  \**************************************************************/
/*! exports provided: createCameraIcon, createClusteredCameraIcon */function(e,t,i){"use strict";function n(){return['<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 114 114">',"<defs>",'<path id="camera-view-icon-3-with-shadow-v3-b" d="M60.934065,73.4602645 C54.1164768,73.4602645 48.5886781,67.9324658 48.5886781,61.1148776 C48.5886781,54.2963836 54.1164768,48.7694907 60.934065,48.7694907 C67.752559,48.7694907 73.2803577,54.2963836 73.2803577,61.1148776 C73.2803577,67.9324658 67.752559,73.4602645 60.934065,73.4602645 M78.7230158,42.834104 C77.2575106,42.9581919 75.7711731,42.808743 74.2984219,42.8748628 C73.4714712,42.9119986 72.9388896,42.637556 72.4470667,41.9817922 C70.947143,39.9827997 69.3693246,38.0417751 67.8621549,36.0491228 C67.287003,35.2873862 66.5959149,34.9939228 65.6521223,35.0029804 C62.0046628,35.0355874 58.354486,35.0401161 54.7070265,35.0002631 C53.7097946,34.9893941 53.0033088,35.3145587 52.4046073,36.1116196 C50.9028721,38.1088007 49.382116,40.0951128 47.7852769,42.0171165 C47.4311283,42.4437253 46.748192,42.7707014 46.1884378,42.8187062 C44.8515493,42.9346424 43.4974514,42.855842 41.9640149,42.855842 C41.9640149,42.2091358 41.9929989,41.6520989 41.9576746,41.0995907 C41.8897433,40.036239 41.3046281,39.4293858 40.2331246,39.4112707 C38.5112919,39.381381 36.7894591,39.3759465 35.0676263,39.4130822 C33.9934056,39.4366318 33.4291227,40.057977 33.3892696,41.1303863 C33.3693431,41.6557219 33.3856466,42.1819632 33.3856466,42.8078372 C31.121269,42.9074698 29.8523117,44.2289606 29,46.07941 L29,75.8722796 C30.0434252,78.4165343 31.9636175,79.1737422 34.6482636,79.1583444 C49.3911736,79.0686751 64.1340835,79.0713923 78.8769935,79.1556272 C81.5299383,79.1710249 83.372236,78.3377339 84.4011692,75.8722796 L84.4011692,46.07941 C83.3332887,43.5523646 81.4058504,42.6067605 78.7230158,42.834104"/>','<filter id="camera-view-icon-3-with-shadow-v3-a" width="125.3%" height="131.7%" x="-12.6%" y="-11.3%" filterUnits="objectBoundingBox">','<feOffset dy="2" in="SourceAlpha" result="shadowOffsetOuter1"/>','<feGaussianBlur in="shadowOffsetOuter1" result="shadowBlurOuter1" stdDeviation="2"/>','<feColorMatrix in="shadowBlurOuter1" values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.1 0"/>',"</filter>",'<path id="camera-view-icon-3-with-shadow-v3-d" d="M104.440851,57.2204256 C104.440851,83.2997158 83.2997158,104.440851 57.2204256,104.440851 C31.1411354,104.440851 10,83.2997158 10,57.2204256 C10,31.1411354 31.1411354,10 57.2204256,10 C83.2997158,10 104.440851,31.1411354 104.440851,57.2204256 Z"/>','<filter id="camera-view-icon-3-with-shadow-v3-c" width="125.5%" height="125.5%" x="-12.8%" y="-10.6%" filterUnits="objectBoundingBox">','<feMorphology in="SourceAlpha" operator="dilate" radius="5.045" result="shadowSpreadOuter1"/>','<feOffset dy="2" in="shadowSpreadOuter1" result="shadowOffsetOuter1"/>','<feMorphology in="SourceAlpha" radius="5.045" result="shadowInner"/>','<feOffset dy="2" in="shadowInner" result="shadowInner"/>','<feComposite in="shadowOffsetOuter1" in2="shadowInner" operator="out" result="shadowOffsetOuter1"/>','<feGaussianBlur in="shadowOffsetOuter1" result="shadowBlurOuter1" stdDeviation="2"/>','<feColorMatrix in="shadowBlurOuter1" values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.1 0"/>',"</filter>","</defs>",'<g fill="none" fill-rule="evenodd">','<use fill="#000" filter="url(#camera-view-icon-3-with-shadow-v3-a)" xlink:href="#camera-view-icon-3-with-shadow-v3-b"/>','<use fill="currentColor" xlink:href="#camera-view-icon-3-with-shadow-v3-b"/>',"<g>",'<use fill="#000" filter="url(#camera-view-icon-3-with-shadow-v3-c)" xlink:href="#camera-view-icon-3-with-shadow-v3-d"/>','<use stroke="currentColor" stroke-width="10.09" xlink:href="#camera-view-icon-3-with-shadow-v3-d"/>',"</g>","</g>","</svg>"].join("")}function o(){return['<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 652 598">','<path fill="currentColor" d="M254.7,94.3A157.6,157.6,0,1,0,412.3,251.9,157.6,157.6,0,0,0,254.7,94.3ZM173.6,281.4a24.2,24.2,0,1,1,23.9-24.2A23.8,23.8,0,0,1,173.6,281.4Zm86.6,0a24.2,24.2,0,1,1,23.9-24.2A23.8,23.8,0,0,1,260.2,281.4Zm86.7,0a24.2,24.2,0,1,1,23.9-24.2A23.8,23.8,0,0,1,346.9,281.4Z"/>','<circle fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="42.87px" cx="256" cy="256" r="221.5" transform="translate(-101.8 200.6) rotate(-36.2)"/>',"</svg>"].join("")}i.r(t),i.d(t,"createCameraIcon",(function(){return n})),i.d(t,"createClusteredCameraIcon",(function(){return o}))},"./extensions/AEC/CanvasBookmark/CreateFrustumShape.js":
/*!*************************************************************!*\
  !*** ./extensions/AEC/CanvasBookmark/CreateFrustumShape.js ***!
  \*************************************************************/
/*! exports provided: createFrustumShape */function(e,t,i){"use strict";function n(e,t){for(var i=THREE.Math.degToRad,n=Math.sin(i(17)),o=Math.sin(i(17)),r=Math.sqrt(1-n*n-o*o),a=new THREE.Vector3(-n,-o,r),s=new THREE.Vector3(n,-o,r),l=new THREE.Vector3(-n,o,r),h=new THREE.Vector3(n,o,r),d=new Float32Array([a.x,a.y,a.z,s.x,s.y,s.z,l.x,l.y,l.z,h.x,h.y,h.z,0,0,0]),c=new Uint32Array([4,1,0,4,3,1,4,2,3,4,0,2,0,1,3,0,3,2]),u=new Float32Array(3*c.length),p=0;p<c.length;p++){var m=c[p];u[3*p]=d[3*m],u[3*p+1]=d[3*m+1],u[3*p+2]=d[3*m+2]}var v=new THREE.BufferGeometry;v.addAttribute("position",new THREE.BufferAttribute(u,3)),v.computeVertexNormals();var f=new THREE.MeshPhongMaterial({color:5263615,transparent:!0,opacity:0,depthTest:!1,depthWrite:!1,blending:THREE.NoBlending}),g=new THREE.Mesh(v,f),y=new Uint32Array([4,0,4,1,4,3,4,2,0,1,1,3,3,2,2,0]),E=new THREE.BufferGeometry;E.addAttribute("index",new THREE.BufferAttribute(y,1)),E.addAttribute("position",new THREE.BufferAttribute(d,3)),E.isLines=!0;var w=new THREE.LineBasicMaterial({color:16777215,transparent:!0,side:THREE.DoubleSide,opacity:0,depthTest:!1,depthWrite:!1,blending:THREE.NoBlending}),b=new THREE.Mesh(E,w),M=new THREE.Scene;M.add(g),M.add(b),v.visible=!0,E.visible=!0,g.name="FrustumGizmo";M.scale.set(50,50,50),M.position.copy(e);var x=new THREE.Vector3(0,0,0),k=new THREE.Vector3(0,0,1),S=new THREE.Vector3(-t.x,-t.y,-t.z),C=(new THREE.Matrix4).lookAt(x,S,k);return M.rotation.setFromRotationMatrix(C),M.frustumCulled=!1,g.frustumCulled=!1,b.frustumCulled=!1,M.setFadeValue=function(e){f.opacity=.05*e,w.opacity=1*e},M}i.r(t),i.d(t,"createFrustumShape",(function(){return n}))},"./extensions/AEC/CanvasBookmark/HCluster.js":
/*!***************************************************!*\
  !*** ./extensions/AEC/CanvasBookmark/HCluster.js ***!
  \***************************************************/
/*! exports provided: default */function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t,i){return t&&o(e.prototype,t),i&&o(e,i),e}i.r(t),i.d(t,"default",(function(){return a}));var a=function(){function e(t,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;n(this,e),this._clusterfck=t,this.setDistanceFuncAndThreshold(i,o)}return r(e,null,[{key:"FlattenCluster",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.value?i.push(t.value):(e.FlattenCluster(t.left,i),e.FlattenCluster(t.right,i)),i}},{key:"ComputeMeanValueForFlattenCluster",value:function(e){var t=new THREE.Box3,i=new THREE.Box3;return e.forEach((function(e){t.expandByPoint(e.currentPosProjected),i.expandByPoint(e.currentPos3D)})),{center2D:t.center(),center3D:i.center()}}}]),r(e,[{key:"setDistanceFuncAndThreshold",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this._distanceFunc=e,this._threshold=t}},{key:"setThreshold",value:function(e){this._threshold=e}},{key:"createClusters",value:function(e){return this._clusterfck.hcluster(e,this._distanceFunc,this._clusterfck.AVERAGE_LINKAGE,this._threshold)}}]),e}()},"./extensions/AEC/DropMe/DropMe.css":
/*!******************************************!*\
  !*** ./extensions/AEC/DropMe/DropMe.css ***!
  \******************************************/
/*! no static exports found */function(e,t,i){var n=i(/*! !../../../node_modules/css-loader!../../../node_modules/sass-loader/dist/cjs.js!./DropMe.css */"./node_modules/css-loader/index.js!./node_modules/sass-loader/dist/cjs.js!./extensions/AEC/DropMe/DropMe.css");"string"==typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};i(/*! ../../../node_modules/style-loader/lib/addStyles.js */"./node_modules/style-loader/lib/addStyles.js")(n,o);n.locals&&(e.exports=n.locals)},"./extensions/AEC/DropMe/DropMe.js":
/*!*****************************************!*\
  !*** ./extensions/AEC/DropMe/DropMe.js ***!
  \*****************************************/
/*! exports provided: default */function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return v}));var n=i(/*! ./DropMeTool.js */"./extensions/AEC/DropMe/DropMeTool.js"),o=i(/*! ../common/AecModelData.js */"./extensions/AEC/common/AecModelData.js");function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?d(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=Bimfish.Viewing,p=Bimfish.Viewing.UI,m=AutodeskNamespace("Bimfish.AEC"),v=function(e){function t(e){var i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{teleportOnRelease:!0};return a(this,t),(i=l(this,h(t).call(this,e,o))).teleportOnRelease=o.teleportOnRelease,i.viewer=e,i._onModelLoaded=i._onModelLoaded.bind(d(i)),i._deactivateTool=i._deactivateTool.bind(d(i)),i.onDropOverride=null,i.options=o,i.options.triggerDeactivate=i._deactivateTool,i.options.isSupportedViewport=t.IsSupportedViewport,i.toggleIndex=o.toggleIndex||0,i.enableGuidance=o.enableGuidance||!1,i.dropMeTool=new n.default(e,(function(){var e;return(e=i)._onDrop.apply(e,arguments)}),i.options),i}var i,r,m;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,e),i=t,m=[{key:"IsSupportedViewport",value:function(e){var t=Boolean(o.default.getLinkedLevel(e)),i="FloorPlan"===e.viewType&&!t;return o.default.supports2DTo3DTransform(e)&&!i}}],(r=[{key:"load",value:function(){return this.viewer.addEventListener(u.MODEL_ADDED_EVENT,this._onModelLoaded),this.viewer.model&&this._initUI(this.viewer.model),!0}},{key:"unload",value:function(){return this.viewer.removeEventListener(u.MODEL_ADDED_EVENT,this._onModelLoaded),this.viewer.toolController.setIsLocked(!1),this._deactivateTool(),this._destroyUI(),!0}},{key:"setOnDrop",value:function(e){this.onDropOverride=e}},{key:"_destroyUI",value:function(){this._showDrop(!1),this.dropMeButton&&(this.dropMeButton.removeFromParent(),this.dropMeButton=null)}},{key:"_onDrop",value:function(e,t,i){this.teleportOnRelease&&(this.viewer.toolController.setIsLocked(!1),this._deactivateTool()),console.log("DropMe: 3D camera position is ".concat(JSON.stringify(e))),console.log("DropMe: 3D camera direction is ".concat(JSON.stringify(t))),this.onDropOverride?this.onDropOverride(e,t,i):this.options.onDrop?this.options.onDrop(e,t,i):console.warn("DropMe: No onDrop callback specified ")}},{key:"_onModelLoaded",value:function(e){this.uiInitialized?this._updateUI(e.model):this._initUI(e.model)}},{key:"_deactivateTool",value:function(){this.uiInitialized&&(this._showGuidenaceUI(!1),this.dropMeButton.setState(p.Button.State.INACTIVE)),this.viewer.toolController.deactivateTool("drop-me")}},{key:"isSupportedModel",value:function(e){if(!(e&&e.isAEC&&e.isAEC()&&e.is2d())||e.isPdf())return!1;if(!e.getDocumentNode())return!1;var i=o.default.findViewportsOnSheet(e);return i.length&&i.find(t.IsSupportedViewport)}},{key:"_updateUI",value:function(e){var t=this.viewer.getToolbar&&this.viewer.getToolbar();t&&(this.dropMeButton.removeFromParent(),t.getControl(u.TOOLBAR.NAVTOOLSID).addControl(this.dropMeButton,{index:this.toggleIndex}),this._showDrop(this.isSupportedModel(e)))}},{key:"_initUI",value:function(e){var t=this;this.viewer.getToolbar&&this.viewer.getToolbar()&&(this.dropMeButton=new p.Button("drop-me-icon"),this.dropMeButton.icon.innerHTML=f(),this._updateUI(e),this.dropMeButton.onClick=function(){t.dropMeTool.active?t._deactivateTool():(t.dropMeButton.setState(p.Button.State.ACTIVE),t.viewer.toolController.activateTool("drop-me"),t._showGuidenaceUI())},this.uiInitialized=!0)}},{key:"_showGuidenaceUI",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.enableGuidance)if(e){var t=this.getDocument();this.guidenaceUI=t.createElement("div"),this.guidenaceUI.className="dropme-guidenace-ui",this.guidenaceUI.innerHTML=Bimfish.Viewing.i18n.translate("Click on a location to ground yourself, then select a camera direction"),this.viewer.container.appendChild(this.guidenaceUI)}else this.viewer.container.contains(this.guidenaceUI)&&this.viewer.container.removeChild(this.guidenaceUI)}},{key:"_showDrop",value:function(e){if(this.dropMeButton){this.viewer.getToolbar().getControl(u.TOOLBAR.NAVTOOLSID)&&!this.container&&this.dropMeButton.setState(e?p.Button.State.INACTIVE:p.Button.State.DISABLED);var t=Bimfish.Viewing.i18n.translate("Click a 2D location to view that space in 3D"),i=Bimfish.Viewing.i18n.translate("Current view is not supported by Place Me");this.dropMeButton.setToolTip(e?t:i)}}}])&&s(i.prototype,r),m&&s(i,m),t}(u.Extension),f=function(){return['<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128">','<g stroke="currentColor" fill="currentColor">','<path d="M67,0c2.4.5,4.8.9,7.1,1.6C87.5,5.3,96.6,16.6,98,31a37.2,37.2,0,0,1-2.1,16.2c-4.7,13-23.6,48.1-31.6,58.2-.3-.2-.6-.3-.8-.5-11.1-17.6-21.9-35.4-30-54.7-4.6-10.9-4.6-21.7.6-32.3S47.5,2.6,58.3.7l3-.7ZM64,47A11.8,11.8,0,1,0,52.3,34.9,12,12,0,0,0,64,47Z"/>','<path d="M12.8,103.4c1.4-8,6.9-12.3,14-14.6s12-2.9,18.1-4.2c1.1-.2,2.4.5,3.4,1.5-4.5,1.1-9.1,1.8-13.5,3.3a35,35,0,0,0-9.6,5c-4,3-4.3,7.5-.7,10.9a28.7,28.7,0,0,0,9.6,6.2,87.3,87.3,0,0,0,59.9.1,28.2,28.2,0,0,0,8.7-5.2c4.9-4.1,4.8-9.7-.8-12.8S90.7,89.3,85,87.3c-1.6-.6-3.4-.6-5.3-1.7,1.1-.4,2.2-1.2,3.2-1.1,7.8.9,15.5,2.2,22.6,6,12,6.4,13,17.9,2.1,26.1-8.1,6.1-17.6,8.5-27.4,10L69.1,128H59.2l-5.2-.7c-9.1-.8-18-2.6-26.4-6.5s-13.4-8.1-14.9-16.8Z"/>',"</g>","</svg>"].join("")};m.DropMeExtension=v,Bimfish.Viewing.theExtensionManager.registerExtension("Bimfish.AEC.DropMeExtension",v)},"./extensions/AEC/DropMe/DropMeTool.js":
/*!*********************************************!*\
  !*** ./extensions/AEC/DropMe/DropMeTool.js ***!
  \*********************************************/
/*! exports provided: default */function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return m}));var n=i(/*! ./ViewPortOverlay.js */"./extensions/AEC/DropMe/ViewPortOverlay.js"),o=i(/*! ../common/AecModelData.js */"./extensions/AEC/common/AecModelData.js");function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=Bimfish.Viewing,c=(d.Private,d.GlobalManagerMixin),u="Auto",p="Manual",m=function(e){function t(e,i,o){var a,h,d;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),h=this,(a=!(d=s(t).call(this))||"object"!==r(d)&&"function"!=typeof d?l(h):d).names=["drop-me"],a.viewer=e,a.setGlobalManager(a.viewer.globalManager),a.options=o,void 0===a.options.teleportOnRelease&&(a.options.teleportOnRelease=!0),a.viewer.toolController.registerTool(l(a)),a.onDrop=i,a.active=!1,a._movedSinceFirstClick=!1,a.init(),a.cameraSelectionState={pending:!1,pos:null,target:null,inViewport:!1,initialVp:null},a.teleportationInProgress=0,a.isFirstClick=!0,a.viewPortOverlay=new n.default(a.viewer),a.escapeHotkeyId="Bimfish.AEC.DropMeToolEsc",a}var i,c,m;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),i=t,(c=[{key:"init",value:function(){var e=this;this.activate=function(){var t=e.viewer.toolController.getTool("gestures");t&&t.setGestureParameter("drag","threshold",0);var i=[{keycodes:[Bimfish.Viewing.KeyCode.ESCAPE],onRelease:function(){return e.options.triggerDeactivate&&e.options.triggerDeactivate()}}];e.viewer.getHotkeyManager().pushHotkeys(e.escapeHotkeyId,i),e.viewer.addEventListener(d.MODEL_ADDED_EVENT,e.options.triggerDeactivate),e.viewer.impl.pauseHighlight(!0),e.active=!0},this.deactivate=function(){var t=e.viewer.toolController.getTool("gestures");t&&t.restoreGestureParameterDefault("drag","threshold"),e.viewer.getHotkeyManager().popHotkeys(e.escapeHotkeyId),e._cancelTeleportation(),e._destroyCameraSelectorUi(),e.viewer.removeEventListener(d.MODEL_ADDED_EVENT,e.options.triggerDeactivate),e.viewer.impl.pauseHighlight(!1),e.active=!1,e._movedSinceFirstClick=!1},this.handleButtonDown=function(e){return!0},this.handleButtonUp=function(e){return!(!this._movedSinceFirstClick||this.isFirstClick)},this.handleSingleClick=function(t,i){if(e.isFirstClick){var n=e._get3DCameraPositionAndVp(t.canvasX,t.canvasY);n&&n.pos&&(e.cameraSelectionState.pos={x:t.canvasX,y:t.canvasY},e.cameraSelectionState.pending=!0,e.cameraSelectionState.initialVp=n.vp,e._createCameraSelectorUi(e.cameraSelectionState.pos),requestAnimationFrame((function(){e._movedSinceFirstClick||e.cameraSelectorPosition.classList.add("camera-selector-position--teleporting")})),"Section"===n.vp.viewType||i?e._runTeleportation(u):(e._scheduleTeleportation(),e.isFirstClick=!1,e.cursor="none",e.getCursor()))}else e.options.teleportOnRelease&&e.teleport();return!0},this.teleport=function(){e.cameraSelectionState.target={x:e.lastX,y:e.lastY},e._runTeleportation(p),e.isFirstClick=e.options.teleportOnRelease,e._movedSinceFirstClick=!1,e._recoverCursor()},this.handleMouseMove=function(t){e.isFirstClick||e._movedSinceFirstClick||(e._movedSinceFirstClick=!0),e.cursor&&e._recoverCursor();var i=e._get3DCameraPositionAndVp(t.canvasX,t.canvasY);if(e.cameraSelectionState.initialVp&&!e.isFirstClick?e._addVpOverlay(e.cameraSelectionState.initialVp):i&&i.pos?e._addVpOverlay(i.vp):e.viewPortOverlay.removeOverlay(),e.cameraSelectionState.inViewport=e.isFirstClick&&i&&i.pos||!e.isFirstClick,e.getCursor(),e.cameraSelectionState.pending){e.teleportationInProgress&&(e.cameraSelectorPosition.classList.remove("camera-selector-position--teleporting"),clearTimeout(e.teleportationInProgress),e.teleportationInProgress=0),e.lastX=t.canvasX,e.lastY=t.canvasY;var n=t.canvasX-e.cameraSelectionState.pos.x,o=t.canvasY-e.cameraSelectionState.pos.y,r=180*Math.atan2(o,n)/Math.PI;return 0===n&&0===o||(r+=90),e.cameraSelector.style.transform="rotate(".concat(r,"deg)"),e.options.teleportOnRelease||e.teleport(),!0}},this.handleSingleTap=function(e){return this.handleSingleClick(e,!0)},this.handleResize=function(){e.options.triggerDeactivate&&e.options.triggerDeactivate()},this.handleSingleTap=function(t,i){e.isFirstClick?e.handleSingleClick(t):e.handleMouseMove(t)},this.handleGesture=function(t){switch(t.type){case"dragstart":break;case"dragmove":return e.handleMouseMove(t,0);case"dragend":return!0;case"panmove":case"panstart":case"panend":case"pinchmove":case"pinchstart":case"pinchend":return!0}return!1}}},{key:"_recoverCursor",value:function(){this.cursor=null,this.getCursor()}},{key:"getCursor",value:function(){return this.cursor?this.cursor:this.cameraSelectionState.inViewport?"cell":"default"}},{key:"_addVpOverlay",value:function(e){this.viewPortOverlay.removeOverlay();var t=o.default.getViewportBounds(e,this.viewer.model.getUnitScale()),i=t.min,n=t.max;this.viewPortOverlay.addOverlay(i.x,i.y,n.x,n.y)}},{key:"_runTeleportation",value:function(e){this._mapToCameraPositionIn3D(e),this._cancelTeleportation()}},{key:"_scheduleTeleportation",value:function(){var e=this;this.teleportationInProgress=setTimeout((function(){e._runTeleportation(u)}),3e3)}},{key:"_cancelTeleportation",value:function(){this.teleportationInProgress&&(clearTimeout(this.teleportationInProgress),this.teleportationInProgress=0)}},{key:"_createCameraSelectorUi",value:function(e){var t=this.getDocument();this.cameraSelectorBackground=t.createElement("div"),this.cameraSelectorBackground.className="camera-selector-background",this.viewer.container.appendChild(this.cameraSelectorBackground),this.cameraSelectorBackground.style.top="".concat(e.y,"px"),this.cameraSelectorBackground.style.left="".concat(e.x,"px"),this.cameraSelectorPosition=t.createElement("div"),this.cameraSelectorPosition.className="camera-selector-position",this.viewer.container.appendChild(this.cameraSelectorPosition),this.cameraSelectorPosition.style.top="".concat(e.y-10,"px"),this.cameraSelectorPosition.style.left="".concat(e.x-10,"px"),this.cameraSelector=t.createElement("div"),this.cameraSelector.className="camera-selector",this.viewer.container.appendChild(this.cameraSelector),this.cameraSelector.style.top="".concat(e.y-100,"px"),this.cameraSelector.style.left="".concat(e.x-50,"px")}},{key:"_destroyCameraSelectorUi",value:function(){this.viewer.container.contains(this.cameraSelector)&&this.viewer.container.removeChild(this.cameraSelector),this.viewer.container.contains(this.cameraSelectorBackground)&&this.viewer.container.removeChild(this.cameraSelectorBackground),this.viewer.container.contains(this.cameraSelectorPosition)&&this.viewer.container.removeChild(this.cameraSelectorPosition),this.cameraSelectionState={pending:!1,pos:null,target:null,inViewport:!1,initialVp:null},this.isFirstClick=!0,this.viewPortOverlay.removeOverlay()}},{key:"_findViewport",value:function(e){var t=new THREE.Vector2(e.x,e.y),i=this.viewer.model;return o.default.findViewportAtPoint(i,t,this.options.isSupportedViewport)}},{key:"_mapToCameraPositionIn3DForFloorplan",value:function(e,t){var i=this._applyGeoRefTransform(e),n=new THREE.Vector3(0,1,0);if(this.cameraSelectionState.target){var o=this.cameraSelectionState.target.x,r=this.cameraSelectionState.target.y,a=this._get3DCameraPositionAndVp(o,r,!0);if(a&&a.pos){var s=this._applyGeoRefTransform(a.pos),l=s.x-i.x,h=s.y-i.y;0===l&&0===h||(n.setX(l).setY(h),n.normalize())}}var d=new THREE.Vector3(-n.y,n.x,0);n.applyAxisAngle(d,Math.PI/18),this.onDrop(i,n,t)}},{key:"_mapToCameraPositionIn3DForSection",value:function(e,t){var i=this._applyGeoRefTransform(e),n=new THREE.Vector3(0,1,0),o=new THREE.Vector3(-n.y,n.x,0);n.applyAxisAngle(o,Math.PI/18),this.onDrop(i,n,t)}},{key:"_mapToCameraPositionIn3D",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=this.cameraSelectionState.pos.x,i=this.cameraSelectionState.pos.y,n=this._get3DCameraPositionAndVp(t,i);n&&n.pos&&n.vp&&("FloorPlan"===n.vp.viewType||"EngineeringPlan"===n.vp.viewType||"CeilingPlan"===n.vp.viewType?this._mapToCameraPositionIn3DForFloorplan(n.pos,e):"Section"===n.vp.viewType&&this._mapToCameraPositionIn3DForSection(n.pos,u))}},{key:"_get3DCameraPositionAndVp",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.viewer.impl.clientToViewport(e,t),r=this.viewer.impl.intersectGroundViewport(n),a=this._findViewport(r)||i&&this.cameraSelectionState.initialVp;if(!a)return null;var s=this.viewer.model,l=s.getDocumentNode().getAecModelData(),h=this.viewer.model.getUnitScale(),d=o.default.get2DTo3DMatrix(a,h),c=r.clone().applyMatrix4(d);if("FloorPlan"===a.viewType){var u=o.default.findLevelForViewport(l,a);if(u){var p=5.74147;c.z=u.elevation+p}}return{pos:c,vp:a}}},{key:"_applyGeoRefTransform",value:function(e){var t=e.clone();if(this.options.useLocalModelCoords)return t;var i=this.viewer.model.getDocumentNode().getRootNode().extractRefPointTransform();return t.applyMatrix4(i),t}}])&&a(i.prototype,c),m&&a(i,m),t}(d.ToolInterface);c.call(m.prototype)},"./extensions/AEC/DropMe/ViewPortOverlay.js":
/*!**************************************************!*\
  !*** ./extensions/AEC/DropMe/ViewPortOverlay.js ***!
  \**************************************************/
/*! exports provided: default */function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.r(t),i.d(t,"default",(function(){return r}));var o=Bimfish.Viewing.Private,r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewer=t,this.overlayName="DropMeViewPortOverlay"}var t,i,r;return t=e,(i=[{key:"addOverlay",value:function(e,t,i,n){this.viewer.impl.createOverlayScene(this.overlayName);var o=this._createMesh(e,t,i,n);this.viewer.impl.addOverlay(this.overlayName,o)}},{key:"removeOverlay",value:function(){this.viewer.impl.removeOverlayScene(this.overlayName)}},{key:"_createMesh",value:function(e,t,i,n){var r=new o.VertexBufferBuilder(!1,void 0,4);r.addSegment(e,t,i,t,0,.1,2581042694,-1,0,0),r.addSegment(i,t,i,n,0,.1,2581042694,-1,0,0),r.addSegment(i,n,e,n,0,.1,2581042694,-1,0,0),r.addSegment(e,n,e,t,0,.1,2581042694,-1,0,0);var a={mesh:r.toMesh(),is2d:!0,packId:"0",meshIndex:1};o.BufferGeometryUtils.meshToGeometry(a);var s=a.geometry,l=this.viewer.impl.matman(),h=l.create2DMaterial(this.viewer.impl.model,{skipEllipticals:!0,skipCircles:!0,skipTriangleGeoms:!0,useInstancing:!1}),d=l.findMaterial(this.viewer.impl.model,h);return new THREE.Mesh(s,d)}}])&&n(t.prototype,i),r&&n(t,r),e}()},"./extensions/AEC/LibraryExports.js":
/*!******************************************!*\
  !*** ./extensions/AEC/LibraryExports.js ***!
  \******************************************/
/*! exports provided: FloorSelector, ListPanel, ListPanelEvents, LevelsExtension, HyperlinkTracker, HyperlinkExtension, DropMeExtension, CanvasBookmarkExtension, MinimapTool, Minimap3DExtension, AecModelData */function(e,t,i){"use strict";i.r(t);i(/*! ./ui/ListPanel.css */"./extensions/AEC/ui/ListPanel.css"),i(/*! ./DropMe/DropMe.css */"./extensions/AEC/DropMe/DropMe.css"),i(/*! ./CanvasBookmark/CanvasBookmark.css */"./extensions/AEC/CanvasBookmark/CanvasBookmark.css");var n=i(/*! ./levels/FloorSelector.js */"./extensions/AEC/levels/FloorSelector.js");i.d(t,"FloorSelector",(function(){return n.default}));var o=i(/*! ./levels/LevelsExtension.js */"./extensions/AEC/levels/LevelsExtension.js");i.d(t,"LevelsExtension",(function(){return o.default}));var r=i(/*! ./hyperlinks/HyperlinkTracker.js */"./extensions/AEC/hyperlinks/HyperlinkTracker.js");i.d(t,"HyperlinkTracker",(function(){return r.default}));var a=i(/*! ./hyperlinks/HyperlinkExtension.js */"./extensions/AEC/hyperlinks/HyperlinkExtension.js");i.d(t,"HyperlinkExtension",(function(){return a.default}));var s=i(/*! ./ui/ListPanel */"./extensions/AEC/ui/ListPanel.js");i.d(t,"ListPanel",(function(){return s.ListPanel})),i.d(t,"ListPanelEvents",(function(){return s.ListPanelEvents}));var l=i(/*! ./DropMe/DropMe.js */"./extensions/AEC/DropMe/DropMe.js");i.d(t,"DropMeExtension",(function(){return l.default}));var h=i(/*! ./CanvasBookmark/CanvasBookmark.js */"./extensions/AEC/CanvasBookmark/CanvasBookmark.js");i.d(t,"CanvasBookmarkExtension",(function(){return h.default}));var d=i(/*! ./Minimap3D/Minimap3D.js */"./extensions/AEC/Minimap3D/Minimap3D.js");i.d(t,"Minimap3DExtension",(function(){return d.default}));var c=i(/*! ./Minimap3D/MinimapTool.js */"./extensions/AEC/Minimap3D/MinimapTool.js");i.d(t,"MinimapTool",(function(){return c.default}));var u=i(/*! ./common/AecModelData.js */"./extensions/AEC/common/AecModelData.js");i.d(t,"AecModelData",(function(){return u.default}))},"./extensions/AEC/Minimap3D/FuzzyBox.js":
/*!**********************************************!*\
  !*** ./extensions/AEC/Minimap3D/FuzzyBox.js ***!
  \**********************************************/
/*! exports provided: default */function(e,t,i){"use strict";function n(e,t,i){t=t||function(e){var t=e.getFragmentList(),i=new THREE.Box3,n=new THREE.Vector3,o=new THREE.Vector3,r=new THREE.Vector3,a=0;function s(e){t.getWorldBounds(e,i),i.center(n);var s=i.size(o).length();r.add(n.multiplyScalar(s)),a+=s}for(var l=0;l<t.getCount();l++)s(l);return r.multiplyScalar(1/a),r}(e),i=i||.75;for(var n=e.getFragmentList(),o=new THREE.Box3,r=[],a=0;a<n.getCount();a++)if(n.getWorldBounds(a,o),!o.empty()){var s=o.distanceToPoint(t);0==s&&(s=t.distanceTo(o.center())),r.push({fragId:a,distance:s})}r.sort((function(e,t){return e.distance-t.distance}));var l=new THREE.Box3;for(a=0;a<r.length*i;a++){var h=r[a];n.getWorldBounds(h.fragId,o),l.union(o)}return l}i.r(t),i.d(t,"default",(function(){return n}))},"./extensions/AEC/Minimap3D/Minimap3D.css":
/*!************************************************!*\
  !*** ./extensions/AEC/Minimap3D/Minimap3D.css ***!
  \************************************************/
/*! no static exports found */function(e,t,i){var n=i(/*! !../../../node_modules/css-loader!../../../node_modules/sass-loader/dist/cjs.js!./Minimap3D.css */"./node_modules/css-loader/index.js!./node_modules/sass-loader/dist/cjs.js!./extensions/AEC/Minimap3D/Minimap3D.css");"string"==typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};i(/*! ../../../node_modules/style-loader/lib/addStyles.js */"./node_modules/style-loader/lib/addStyles.js")(n,o);n.locals&&(e.exports=n.locals)},"./extensions/AEC/Minimap3D/Minimap3D.js":
/*!***********************************************!*\
  !*** ./extensions/AEC/Minimap3D/Minimap3D.js ***!
  \***********************************************/
/*! exports provided: default */function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return M}));var n=i(/*! ./MinimapTool.js */"./extensions/AEC/Minimap3D/MinimapTool.js"),o=i(/*! ./SheetMap.js */"./extensions/AEC/Minimap3D/SheetMap.js"),r=i(/*! ./MinimapToolbar.js */"./extensions/AEC/Minimap3D/MinimapToolbar.js"),a=i(/*! ./FuzzyBox.js */"./extensions/AEC/Minimap3D/FuzzyBox.js"),s=i(/*! ./SheetMapTransition.js */"./extensions/AEC/Minimap3D/SheetMapTransition.js"),l=i(/*! ./MinimapMath.js */"./extensions/AEC/Minimap3D/MinimapMath.js");i(/*! ./Minimap3D.css */"./extensions/AEC/Minimap3D/Minimap3D.css");function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?m(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=Bimfish.Viewing,g=Bimfish.Viewing.Private,y=AutodeskNamespace("Bimfish.AEC"),E="Bimfish.AEC.LevelsExtension",w=function(e){return e.toString()+"px"},b=function(e){return e.toString()+"%"},M=function(e){function t(e){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return d(this,t),(i=u(this,p(t).call(this,e,r))).viewer=e,i.camera=i.viewer.navigation.getCamera(),i.trackUsage=r.trackUsage,i.sideBySideOptions=r.sideBySideOptions||{},i.cameraMovedCB=i.onCameraMoved.bind(m(i)),i.toolChangedCB=i.onToolChanged.bind(m(i)),i.geomLoadedCB=i.onGeomLoaded.bind(m(i)),i.onVisibilityChangedCB=i.onVisibilityChanged.bind(m(i)),i.viewerResizedCB=i.onResize.bind(m(i)),i.loadProgressCB=i.onLoadProgress.bind(m(i)),i.extensionLoadCB=i.onExtensionLoaded.bind(m(i)),i.levelChangedCB=i.update.bind(m(i)),i.levelChangeListenerRegistered=!1,i.onTimerCB=i.onTimer.bind(m(i)),i.visibleModelsChanged=i.setDefaultMapModel.bind(m(i)),i.draggingPlayerPosition=!1,i.minMapImageSize=r.minMapImageSize||300,i.maxMapImageSize=r.maxMapImageSize||2048,i.pixelsPerMeter=10,i.mapWidgetWidth=300,i.mapWidgetHeight=300,i.mapImageWidth=300,i.mapImageHeight=300,i.scaledImageWidth=0,i.scaledImageHeight=0,i.relMapWidgetSizeLongEdge=.2,i.relMapWidgetSizeShortEdge=.25,i.minMapWidgetSize=100,i.zoomScale=1,i.targetZoomLevel=0,i.zoomLevel=0,i.zoomSpeed=6,i.zoomAcc=16,i.lastZoomSpeed=0,i.scrollPos=new THREE.Vector2,i.targetScrollPos=new THREE.Vector2,i.maxScrollSpeed=500,i.maxScrollAcc=900,i.lastScrollSpeed=0,i.mapMatrix=new THREE.Matrix4,i.mapMatrixInverse=new THREE.Matrix4,i.currentLevelIndex=void 0,i.updatingMap=!1,i.mapValid=!1,i.mapCache={},i.tool=new n.default(m(i),i.trackUsage),i.playerPos=new THREE.Vector2,i.playerAngle=0,i.mapCenter=i.playerPos,i.lastCameraPos=i.camera.position.clone(),i.mapModels=null,i.autoScrollLocked=!1,i.modelIdToFuzzyBox=[],i.mapModelBox=new THREE.Box3,i.isLoading=!1,i.sheetMap=new o.default(m(i)),i.sheetMapTransition=new s.default(m(i)),i.visible=!1,i.useSheet=!1,i.sideBySideEnabled=i.sideBySideOptions.sideBySideDefault||!1,i.sideBySide=!1,i.sideBySideSplit=i.sideBySideOptions.sideBySideSplit||40,i.fadingWidgets=0,i.mapRotationAngle=0,i.sheetMapActive=!1,i.initWidgets(),i.waitingCallbacks=[],i.slidingInProgress=!1,i}var i,h,y;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,e),i=t,(h=[{key:"setMinimapVisible",value:function(e){var t=this;this.visible=e;var i=this.mapWidget.mapImage===this.placeholderDiv;this.getWindow().requestAnimationFrame((function(){e?(t.mapWidgetRoot.classList.add("visible"),t.viewer.getExtension("Bimfish.ViewCubeUi",(function(e){e.displayViewCube(!1,!1)}))):t.mapWidgetRoot.classList.remove("visible"),e&&!i?t.playerPositionWidget.classList.add("visible"):t.playerPositionWidget.classList.remove("visible")})),this.updateBimWalkInfoButtonPos(),e&&this.updateSideBySide()}},{key:"isEnabled",value:function(){return this.viewer.prefs&&this.viewer.prefs.get("miniMap3D")}},{key:"onVisibilityChanged",value:function(e){this.viewer.prefs&&this.viewer.prefs.set("miniMap3D",e),this.update()}},{key:"initPlaceholderWidget",value:function(){var e=this.getDocument();this.placeholderDiv=e.createElement("div"),this.placeholderDiv.className="minimap-placeholder",this.placeholderDiv.style.width=w(this.mapWidgetWidth),this.placeholderDiv.style.height=w(this.mapWidgetHeight);var t=e.createElement("div");t.className="minimap-progressWidget",this.placeholderDiv.appendChild(t),this.progressText=e.createElement("div"),this.progressText.className="minimap-progressText",t.appendChild(this.progressText),this.progressDiv=e.createElement("progress"),this.progressDiv.className="minimap-progress",this.progressDiv.setAttribute("max",100),t.appendChild(this.progressDiv)}},{key:"initWidgets",value:function(){var e=this,t=this.getDocument();this.mapWidgetRoot=t.createElement("div"),this.mapWidgetRoot.style.width=w(this.mapWidgetWidth),this.mapWidgetRoot.style.height=w(this.mapWidgetHeight),this.mapWidgetRoot.className="minimap3D",this.mapWidget=t.createElement("div"),this.mapWidget.className="minimapScrollArea",this.mapWidgetRoot.appendChild(this.mapWidget),this.playerPositionWidget=t.createElement("div"),this.playerPositionWidget.className="player-widget",this.mapWidget.appendChild(this.playerPositionWidget),this.playerFrustumWidget=t.createElement("div"),this.playerFrustumWidget.className="player-frustum",this.playerPositionWidget.appendChild(this.playerFrustumWidget),this.playerPositionWidget.anchorX=20,this.playerPositionWidget.anchorY=40;var i=t.createElement("div");i.className="player-position-fill",this.playerPositionWidget.appendChild(i),this.playerPositionWidget.posCircle=i;var n=t.createElement("div");n.className="player-position-hitarea",this.playerPositionWidget.posCircle.appendChild(n),this.playerPositionWidget.playerPositionHitArea=n,Bimfish.Viewing.isTouchDevice()&&(n.classList.add("touch"),this.playerFrustumWidget.classList.add("touch"),this.playerPositionWidget.posCircle.classList.add("touch"),this.playerPositionWidget.anchorX=40,this.playerPositionWidget.anchorY=80),this.toolbar=new r.default(this),this.initPlaceholderWidget(),this.setMinimapVisible(!1),this.mapWidget.addEventListener("transitionend",(function(){e.updateBimWalkInfoButtonPos(),e.updateSideBySide()})),this.initialized=!0}},{key:"load",value:function(){this.loaded=!0,this.viewer.prefs.add("miniMap3D",!0),this.updateMapSize(),this.viewer.container.appendChild(this.mapWidgetRoot);var e=this.getCache();return e.viewer=this.sheetMap.initMapViewer(this.mapWidget,e.viewer),this.tool.activate(),this.viewer.addEventListener(f.CAMERA_CHANGE_EVENT,this.cameraMovedCB),this.viewer.addEventListener(f.TOOL_CHANGE_EVENT,this.toolChangedCB),this.viewer.addEventListener(f.GEOMETRY_LOADED_EVENT,this.geomLoadedCB),this.viewer.addEventListener(f.VIEWER_RESIZE_EVENT,this.viewerResizedCB),this.viewer.addEventListener(f.PROGRESS_UPDATE_EVENT,this.loadProgressCB),this.viewer.addEventListener(f.EXTENSION_LOADED_EVENT,this.extensionLoadCB),this.updateFloorSelectHandler(),this.options.useCustomModel||(this.setDefaultMapModel(),this.viewer.addEventListener(f.MODEL_ADDED_EVENT,this.visibleModelsChanged),this.viewer.addEventListener(f.MODEL_REMOVED_EVENT,this.visibleModelsChanged)),this.updateSettingsPanel||(this.updateSettingsPanel=this.configureSettings.bind(this),this.viewer.addEventListener(f.TOOLBAR_CREATED_EVENT,this.updateSettingsPanel)),this.requestTimer(),!0}},{key:"unload",value:function(){return this.loaded=!1,this.viewer.container.contains(this.mapWidgetRoot)&&this.viewer.container.removeChild(this.mapWidgetRoot),this.tool.deactivate(),this.viewer.removeEventListener(f.CAMERA_CHANGE_EVENT,this.cameraMovedCB),this.viewer.removeEventListener(f.TOOL_CHANGE_EVENT,this.toolChangedCB),this.viewer.removeEventListener(f.GEOMETRY_LOADED_EVENT,this.geomLoadedCB),this.viewer.removeEventListener(f.VIEWER_RESIZE_EVENT,this.viewerResizedCB),this.viewer.removeEventListener(f.PROGRESS_UPDATE_EVENT,this.loadProgressCB),this.viewer.removeEventListener(f.EXTENSION_LOADED_EVENT,this.extensionLoadCB),this.updateFloorSelectHandler(),this.options.useCustomModel||(this.viewer.removeEventListener(f.MODEL_ADDED_EVENT,this.visibleModelsChanged),this.viewer.removeEventListener(f.MODEL_REMOVED_EVENT,this.visibleModelsChanged)),this.updateSettingsPanel&&(this.viewer.removeEventListener(f.TOOLBAR_CREATED_EVENT,this.updateSettingsPanel),this.updateSettingsPanel=null),this.cancelTimer(),!0}},{key:"onExtensionLoaded",value:function(e){e.extensionId===E&&this.updateFloorSelectHandler()}},{key:"updateFloorSelectHandler",value:function(){var e=this.viewer.getExtension(E);if(e){var t=this.levelChangeListenerRegistered;!t&&this.loaded?(e.floorSelector.addEventListener(Bimfish.AEC.FloorSelector.CURRENT_FLOOR_CHANGED,this.levelChangedCB),this.levelChangeListenerRegistered=!0):t&&!this.loaded&&(e.floorSelector.removeEventListener(Bimfish.AEC.FloorSelector.CURRENT_FLOOR_CHANGED,this.levelChangedCB),this.levelChangeListenerRegistered=!1)}}},{key:"updatePlayerWidget",value:function(){var e=this.playerPos.clone();this.mapPixelsToWidget(e);var t=this.playerPositionWidget.style;t.left=w(e.x-this.playerPositionWidget.anchorX),t.top=w(e.y-this.playerPositionWidget.anchorY),this.playerFrustumWidget.style.transform="rotate(".concat(this.playerAngle+this.mapRotationAngle,"rad)")}},{key:"computeTargetScrollPosition",value:function(){var e=this.mapCenter.x*this.zoomScale,t=this.mapCenter.y*this.zoomScale;this.targetScrollPos.x=e-.5*this.mapWidgetWidth,this.targetScrollPos.y=t-.5*this.mapWidgetHeight}},{key:"computePlayerPosition",value:function(){if(!this.updatingMap){var e=this.viewer.impl.camera.position,t=this.worldToMapPixels(e),i=this.viewer.impl.camera.target,n=this.worldToMapPixels(i);this.playerPos.copy(t),this.playerAngle=this.computeAngle(t,n)}}},{key:"applyScrolling",value:function(){if(this.mapValid){var e=this.mapWidget.mapImage.style;e.width=w(this.scaledImageWidth),e.height=w(this.scaledImageHeight),this.mapWidget.mapImage.style.left=w(-this.scrollPos.x),this.mapWidget.mapImage.style.top=w(-this.scrollPos.y)}this.sheetMap.ready&&this.sheetMap.syncCameraToMainMap(),this.updateRotation()}},{key:"resetScrolling",value:function(){this.zoomLevel=this.targetZoomLevel,this.computeTargetScrollPosition(),this.scrollPos.copy(this.targetScrollPos),this.applyScrolling()}},{key:"updateScrolling",value:function(e){if(!this.autoScrollLocked){this.computeTargetScrollPosition();var t=this.targetScrollPos.clone().sub(this.scrollPos),i=t.length();if(!this.scrollPos.equals(this.targetScrollPos)){if(i<.5)this.scrollPos.copy(this.targetScrollPos);else{var n=Object(l.motionSmoothing)(i,e,this.maxScrollSpeed,this.lastScrollSpeed,this.maxScrollAcc);t.multiplyScalar(n/i),this.scrollPos.add(t),e&&(this.lastScrollSpeed=n/e)}this.updatePlayerWidget(),this.applyScrolling()}}}},{key:"mapModelsReady",value:function(){if(!this.mapModels)return!1;for(var e=0;e<this.mapModels.length;e++)if(!this.mapModels[e].isLoadDone())return!1;return!0}},{key:"getCurrentLevel",value:function(){var e=this.viewer.getExtension(E);if(e){var t=e.floorSelector,i=t.floorData[t.currentFloor];return i||e._mapCameraToLevel()}}},{key:"updateSheetMap",value:function(){var e=this;if(!this.autoScrollLocked){var t=this.getCurrentLevel();if(t){var i=this.mapCache[t.index];if(i&&this.mapValid){var n=this.viewer.impl.camera.position,o=this.sheetMap.isUsable(n,t.guid),r=this.useSheet&&o;if(!this.sheetMapActive&&r)return this.sheetMapTransition.enterSheet(),void(this.sheetMapActive=!0);if(this.sheetMapActive&&!r&&(this.sheetMapTransition.exitSheet(),this.sheetMapActive=!1),(!r||!this.sheetMapActive)&&(this.useSheet||this.sheetMapActive)&&!this.sheetMap.loading){var a=i.sheetMaps.find((function(e){return e.isUsable(n,t.guid)}));a&&(this.sheetMapTransition.onSheetWillChange(),this.sheetMap.initMap(a,(function(){e.update()})))}}}}}},{key:"updateMapImage",value:function(){if(!this.updatingMap&&this.loaded&&this.mapModelsReady()){var e=this.getCurrentLevel();if(e){var t=e.index;if(this.currentLevelIndex!==t||!this.mapValid){Number.isInteger(t)&&(this.currentLevelIndex=t);var i=this.mapCache[this.currentLevelIndex];i?this.activateMap(i,e.name):this.createMinimap(this.currentLevelIndex,e.name,e.guid)}}}}},{key:"bimWalkActive",value:function(){var e=this.viewer.getExtension("Bimfish.BimWalk");return e&&e.tool&&e.tool.active}},{key:"updateMapCenter",value:function(){this.updatingMap||(this.widgetSizeChanged||0!==this.lastCameraPos.distanceTo(this.camera.position))&&(this.lastCameraPos=this.camera.position.clone(),this.widgetSizeChanged=!1,this.isOutside()?(this.setZoomLevel(this.getMinZoomLevel()),this.mapCenter=this.playerPos.clone(),this.mapCenter.x=.5*this.mapWidgetWidth/this.zoomScale,this.mapCenter.y=.5*this.mapWidgetHeight/this.zoomScale):this.mapCenter=this.playerPos)}},{key:"onCameraMoved",value:function(){this.update()}},{key:"update",value:function(){var e=this;if(!this.slidingInProgress){var t=this.visible;if(this.isEnabled()&&this.bimWalkActive()){if(this.isEnabled()&&this.bimWalkActive()&&!this.visible&&this.sideBySideEnabled){this.slidingInProgress=!0;var i=this.sideBySideSplit;this.sideBySideSplit=0,this.setSideBySideSplit(i,(function(){e.slidingInProgress=!1}))}this.mapModels?this.mapModelsReady()?(this.updateMapImage(),this.updateSheetMap(),this.updateMaxFloorTextWidth(),this.isLoading=!1,this.updateMapCenter(),this.setMinimapVisible(!0),this.computePlayerPosition(),this.updatePlayerWidget(),this.applyScrolling(),this.toolbar.update(),this.computeTargetScrollPosition(),t||this.resetScrolling()):this.showLoadProgress():this.setMinimapVisible(!1)}else if(this.sideBySide){var n=this.sideBySideSplit;this.slidingInProgress=!0,this.setSideBySideSplit(0,(function(){e.sideBySideSplit=n,e.setMinimapVisible(!1),e.viewer.addEventListener(f.CAMERA_CHANGE_EVENT,(function(){e.slidingInProgress=!1}),{once:!0})}))}else this.setMinimapVisible(!1)}}},{key:"onToolChanged",value:function(e){var t=this;this.updatingMap||"bimwalk"!==!e.toolName&&setTimeout((function(){return t.update()}),10)}},{key:"onGeomLoaded",value:function(e){this.update()}},{key:"showProgressWidget",value:function(){this.mapWidget.mapImage===this.placeholderDiv||(this.clearMapImage(),this.mapWidget.appendChild(this.placeholderDiv),this.placeholderDiv.style.opacity=0,this.fadeWidgetOpacity(this.placeholderDiv,1),this.updateProgressWidget(0),this.mapWidget.mapImage=this.placeholderDiv,this.setMinimapVisible(!0))}},{key:"setProgressText",value:function(e){this.progressText.innerHTML=e}},{key:"updateProgressWidget",value:function(e){this.progressDiv.setAttribute("value",e)}},{key:"showLoadProgress",value:function(){this.showProgressWidget(),this.useSheet&&this.sheetMap.loading?(this.progressDiv.removeAttribute("value"),this.setProgressText(Bimfish.Viewing.i18n.translate("Loading sheet..."))):(this.onLoadProgress(),this.setProgressText(Bimfish.Viewing.i18n.translate("Loading models..."))),this.setMinimapVisible(!0),this.isLoading=!0}},{key:"getLoadProgress",value:function(){for(var e=0,t=0,i=this.mapModels?this.mapModels.length:0,n=0;n<i;n++){var o=this.mapModels[n];if(o.isOTG()){var r=o.getData();e+=r.fragsLoaded,t+=r.metadata.stats.num_fragments}}return t?Math.floor(100*e/t):0}},{key:"onLoadProgress",value:function(){var e=this.useSheet&&this.sheetMap.initialized();if(this.isLoading&&!e){var t=this.getLoadProgress();this.updateProgressWidget(t)}}},{key:"clearFloorLabel",value:function(){var e=this,t=this.mapWidget.floorLabel;t&&(this.mapWidget.floorLabel=null,this.fadeWidgetOpacity(t,0,(function(){e.mapWidget.removeChild(t)})))}},{key:"clearMapImage",value:function(){var e=this;this.sheetMap.setVisible(!1),this.sheetMapActive=!1,this.clearFloorLabel();var t=this.mapWidget.mapImage;t&&(this.mapWidget.mapImage=null,this.fadeWidgetOpacity(t,0,(function(){e.mapWidget.mapImage!==t&&e.mapWidget.contains(t)&&e.mapWidget.removeChild(t)})),this.mapValid=!1)}},{key:"fadeWidgetOpacity",value:function(e,t,i){var n=this;e.fadeAnim&&(e.fadeAnim.skip(),e.fadeAnim=null);var o=e.style.opacity;this.fadingWidgets++,e.fadeAnim=g.fadeValue(0,1,.7,(function(i){i=g.smootherStep(i),e.style.opacity=g.lerp(o,t,i)}),(function(){n.fadingWidgets--,e.fadeAnim=null,i&&i()}))}},{key:"createFloorLabel",value:function(e){if(!this.options.hideFloorsLabel){var t=this.getDocument(),i=t.createElement("div");i.className="floorNameLabel",this.mapWidget.appendChild(i),this.mapWidget.floorLabel=i;var n=t.createElement("div");n.className="floorText",n.textContent=e,i.appendChild(n),this.mapWidget.floorText=n,this.updateMaxFloorTextWidth(),this.options.theme&&(i.classList.add(this.options.theme),n.classList.add(this.options.theme))}}},{key:"activateMap",value:function(e,t){var i=this;this.clearMapImage(),this.mapImageWidth=e.width,this.mapImageHeight=e.height,this.scaledImageWidth=this.zoomScale*this.mapImageWidth,this.scaledImageHeight=this.zoomScale*this.mapImageHeight,this.mapMatrix.copy(e.mapMatrix),this.mapMatrixInverse.getInverse(this.mapMatrix);var n=this.getDocument();this.mapWidget.mapImage=n.createElement("div"),this.mapWidget.mapImage.className="mapContainer",this.mapWidget.mapImage.innerHTML='<img class="mapImage" src="'.concat(e.imageUrl,'">'),this.mapWidget.mapImage.style.width=w(this.scaledImageWidth),this.mapWidget.mapImage.style.height=w(this.scaledImageHeight),this.mapWidget.appendChild(this.mapWidget.mapImage),this.mapWidget.mapImage.imageElement=this.mapWidget.mapImage.children[0],this.mapWidget.mapImage.imageElement.style.width="100%",this.mapWidget.mapImage.imageElement.style.height="100%",this.createFloorLabel(t),this.mapWidget.mapImage.style.opacity=0,this.fadeWidgetOpacity(this.mapWidget.mapImage,1),this.mapWidget.floorLabel&&this.fadeWidgetOpacity(this.mapWidget.floorLabel,1),this.mapValid=!0,this.computePlayerPosition(),this.resetScrolling(),this.updatePlayerWidget(),this.setMinimapVisible(!0),e.sheetMaps.forEach((function(e){return i.mapWidget.mapImage.appendChild(e.thumbnail.div)}))}},{key:"cancelMapUpdate",value:function(){this.screenShotInProgress&&(this.screenShotInProgress.stop(),this.updatingMap=!1)}},{key:"getFuzzyBox",value:function(){if(this.mapModelBox.makeEmpty(),this.mapModels){for(var e=0;e<this.mapModels.length;e++){var t=this.mapModels[e],i=this.modelIdToFuzzyBox[t.id];i||(i=Object(a.default)(t),this.modelIdToFuzzyBox[t.id]=i),this.mapModelBox.union(i)}return this.mapModelBox}}},{key:"createMinimap",value:function(e,t,i){var n=this;this.showProgressWidget(),this.setProgressText("Creating map for:<br><b>"+t);var r=this.getFuzzyBox();if(r.empty())this.setMinimapVisible(!1);else{var a=r.size(),s=this.mapModels[0].getUnitScale(),h=2/s;a.x+=h,a.y+=h;var d=a.x*s*this.pixelsPerMeter,c=a.y*s*this.pixelsPerMeter,u=a.y;if(d<this.minMapImageSize&&c<this.minMapImageSize){var p=Math.min(d,c),m=this.minMapImageSize/p;d*=m,c*=m}var v=Math.max(d,c);if(v>this.maxMapImageSize){var g=this.maxMapImageSize/v;d*=g,c*=g}if(d<this.minMapImageSize)d=this.minMapImageSize;else if(this.mapImageHeight<this.minMapImageSize){var y=this.mapImageHeight;u*=(c=this.minMapImageSize)/y}var w,b,M,x,k,S,C=new f.UnifiedCamera(d,c),_=(w=this.viewer,b=e,M=w.getExtension(E),x=M&&M.floorSelector&&M.floorSelector.floorData[b],k=x.zMin+.5*(x.zMax-x.zMin),{zMin:(S=M.floorSelector.floorData[b-1])?.5*(S.zMin+S.zMax):x.zMin,zMax:k});Object(l.setTopView)(C,r,_.zMin,_.zMax,u),Object(l.compute3DTo2DMatrix)(C,this.mapMatrix),this.mapMatrixInverse.getInverse(this.mapMatrix);var T=this.mapMatrix.clone();this.updatingMap=!0;var B,L,P,D=this.viewer.impl.getMaterials(),A=this.viewer.impl.renderer().getConfig();A.clearAlpha=0;var O={camera:C,onProgress:function(e){return n.updateProgressWidget(e)},beforeRender:function(){B=D.getPolygonOffsetOn(),L=D.getPolygonOffsetFactor(),P=D.getPolygonOffsetUnits(),D.togglePolygonOffset(!0,1,5)},afterRender:function(){D.togglePolygonOffset(B,L,P)},renderConfig:A,models:this.mapModels,fragOptions:{isFragVisible:function(){return!0},isFragOff:function(){return!1}},excludeCutPlanes:!0,excludeThemingColors:!0};this.screenShotInProgress=this.viewer.impl.getScreenShotProgressive(d,c,(function(t){n.updatingMap=!1,n.screenShotInProgress=null;var r=o.default.createSheetMapConfigs(n.mapModels,i,n.mapMatrix,d,c);n.mapCache[e]={imageUrl:t,width:d,height:c,mapMatrix:T,sheetMaps:r},n.update(),n.updateThumbnailVisiblity()}),O)}}},{key:"worldToMapPixels",value:function(e){return Object(l.worldToMapPixels)(e,this.mapMatrix,this.mapImageWidth,this.mapImageHeight)}},{key:"mapPixelsToWorld",value:function(e,t,i){return Object(l.mapPixelsToWorld)(e,t,i,this.mapMatrixInverse,this.mapImageWidth,this.mapImageHeight)}},{key:"computeAngle",value:function(e,t){var i=t.x-e.x,n=t.y-e.y,o=Math.atan2(n,i);return o+=Math.PI/2}},{key:"setDefaultMapModel",value:function(){var e=this.viewer.getVisibleModels();e&&e.every((function(e){return e.is3d()}))?this.setMapModels(e):this.setMapModels(null)}},{key:"setMapModels",value:function(e){var t=this;(e||this.mapModels)&&(e&&this.mapModels&&e.length===this.mapModels.length&&e.every((function(e){return t.mapModels.indexOf(e)>=0}))||(this.mapModels=e&&e.length?e.slice():null,this.cancelMapUpdate(),this.mapCache={},this.sheetMap.clearSheetCache(),this.mapValid=!1,this.update()))}},{key:"configureSettings",value:function(){if(this.viewer.getSettingsPanel){var e=this.viewer.getSettingsPanel(!0);if(e.is3dMode){var t=f.Extensions.ViewerSettingTab.Navigation;e.addLabel(t,"3D Mini-map"),e.showMinimapChkBoxId||(e.showMinimapChkBoxId=e.addCheckbox(t,"Show 3D mini-map","Toggles availability of the 3D mini-map when using first person mode",!0,this.onVisibilityChangedCB,"miniMap3D"))}}}},{key:"requestTimer",value:function(){var e=this.getWindow();this.animTimerId=e.requestAnimationFrame(this.onTimerCB)}},{key:"cancelTimer",value:function(){this.getWindow().cancelAnimationFrame(this.animTimerId)}},{key:"onTimer",value:function(){var e=performance.now(),t=e-this.lastTimer;this.lastTimer=e,t=Math.min(t||0,1e3),t/=1e3,this.updateZoomScale(t),this.updateScrolling(t),this.requestTimer(),this.isAllDone()&&(this.waitingCallbacks.forEach((function(e){return e()})),this.waitingCallbacks.length=0)}},{key:"setZoomScale",value:function(e){if(!this.autoScrollLocked){var t=this.zoomScale;if(this.zoomScale=e,this.scaledImageWidth=this.mapImageWidth*this.zoomScale,this.scaledImageHeight=this.mapImageHeight*this.zoomScale,this.computeTargetScrollPosition(),e<t){var i=this.mapCenter.x,n=this.mapCenter.y,o=i*t-this.scrollPos.x,r=n*t-this.scrollPos.y;this.scrollPos.x=i*this.zoomScale-o,this.scrollPos.y=n*this.zoomScale-r}else{var a=e/t,s=this.scrollPos.x*a,l=this.scrollPos.y*a,h=this.mapWidgetWidth*a,d=this.mapWidgetHeight*a,c=s+h-this.mapWidgetWidth,u=l+d-this.mapWidgetHeight;this.scrollPos.copy(this.targetScrollPos),this.scrollPos.x=THREE.Math.clamp(this.scrollPos.x,s,c),this.scrollPos.y=THREE.Math.clamp(this.scrollPos.y,l,u)}this.updatePlayerWidget(),this.applyScrolling()}}},{key:"getMinZoomLevel",value:function(){var e=this.mapWidgetWidth/this.mapImageWidth,t=this.mapWidgetHeight/this.mapImageHeight;return Math.log2(Math.min(e,t))}},{key:"getMaxZoomLevel",value:function(){return this.sheetMapActive?3:0}},{key:"setZoomLevel",value:function(e,t){this.targetZoomLevel=e,t||(this.zoomLevel=this.targetZoomLevel,this.lastZoomSpeed=0,this.setZoomScale(Math.pow(2,this.zoomLevel)))}},{key:"updateZoomScale",value:function(e){var t=this.targetZoomLevel-this.zoomLevel;if(0!==t){var i=t>0;(t=Math.abs(t))<.001?this.zoomLevel=this.targetZoomLevel:(t=Object(l.motionSmoothing)(t,e,this.zoomSpeed,this.lastZoomSpeed,this.zoomAcc),e&&(this.lastZoomSpeed=t/e),this.zoomLevel+=t*(i?1:-1)),this.setZoomScale(Math.pow(2,this.zoomLevel))}}},{key:"updateMaxFloorTextWidth",value:function(){if(this.mapWidget.floorText){var e=this.sideBySide?130:50;this.mapWidget.floorText.style.maxWidth="".concat(parseInt(this.mapWidget.style.width)-e,"px")}}},{key:"setWidgetSize",value:function(e,t){this.mapWidgetWidth=e,this.mapWidgetHeight=t;var i=w(e),n=w(t);this.placeholderDiv.style.width=i,this.placeholderDiv.style.height=n,this.mapWidgetRoot.style.width=i,this.mapWidgetRoot.style.height=n,this.sheetMap.onResize(),this.widgetSizeChanged=!0,this.update()}},{key:"updateMapSize",value:function(){var e,t,i=this.viewer.container.clientWidth,n=this.viewer.container.clientHeight;if(this.sideBySide)this.verticalSideBySide?(e=i,t=n*(this.sideBySideSplit/(100-this.sideBySideSplit))):(e=i*(this.sideBySideSplit/(100-this.sideBySideSplit)),t=n);else{var o=Math.max(i,n),r=Math.min(i,n);t=e=Math.min(this.relMapWidgetSizeLongEdge*o,this.relMapWidgetSizeShortEdge*r)}this.setWidgetSize(e,t)}},{key:"onResize",value:function(){if(this.sideBySide){var e=this.viewer.container.parentElement.getBoundingClientRect();if(!this.lastContainerBounds||this.lastContainerBounds.width!==e.width&&this.lastContainerBounds.height!==e.height)return this.lastContainerBounds=e,void this.updateSideBySide(!0)}this.updateMapSize()}},{key:"updateBimWalkInfoButtonPos",value:function(){var e=this.viewer.getExtension("Bimfish.BimWalk"),t=e&&e.getInfoButton();if(t&&!e.options.disableBimWalkInfoIcon){this.toolbar.mapButtonBar.style.right="0px",this.toolbar.mapButtonBar.style.marginTop="4px";var i=this.getWindow().getComputedStyle(this.mapWidget),n=this.visible||i.opacity>0?this.mapWidgetWidth:0;this.sideBySide&&(n=0);var o=n+20;t.style.right=w(o)}}},{key:"isOutside",value:function(){return!this.mapPixelValid(this.playerPos.x,this.playerPos.y)}},{key:"mapPixelValid",value:function(e,t){return e>=0&&t>=0&&e<this.mapImageWidth&&t<this.mapImageHeight}},{key:"setSheetMapEnabled",value:function(e){this.useSheet=e,this.update(),this.updateThumbnailVisiblity()}},{key:"setSideBySideEnabled",value:function(e){this.sideBySideEnabled=e,this.updateSideBySide()}},{key:"updateThumbnailVisiblity",value:function(){for(var e in this.mapCache)for(var t=this.mapCache[e].sheetMaps,i=0;i<t.length;i++){var n=t[i],r=this.useSheet?o.default.OverlayOpacity:0;this.fadeWidgetOpacity(n.thumbnail.div,r)}}},{key:"setSideBySideSplit",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!this.sideBySideOptions.animateSideBySideMode;i?(this.sideBySideSplit=e,this.updateSideBySide(!0),this.updateBimWalkInfoButtonPos(),t&&t()):this.animateSideBySideSplit(e,t)}},{key:"animateSideBySideSplit",value:function(e,t){var i=this,n=this.sideBySideSplit;g.fadeValue(0,1,.2,(function(t){t=g.smootherStep(t),i.sideBySideSplit=g.lerp(n,e,t),i.updateSideBySide(!0),i.updateBimWalkInfoButtonPos()}),(function(){t&&t()}))}},{key:"updateSideBySide",value:function(e){var t=this.sideBySide;if(this.sideBySide=this.visible&&this.sideBySideEnabled,e||t!==this.sideBySide){if(this.sideBySide){var i=this.viewer.container.parentElement.getBoundingClientRect();this.viewer.container.parentElement.appendChild(this.mapWidgetRoot),this.mapWidgetRoot.classList.add("side-by-side"),i.width>=i.height?(this.viewer.container.style.width=(100-this.sideBySideSplit).toString()+"%",this.viewer.container.style.height="100%",this.sideBySideOptions.left2DView?this.viewer.container.style.left=this.sideBySideSplit.toString()+"%":this.viewer.container.style.right=this.sideBySideSplit.toString()+"%",this.viewer.container.style.top="0px",this.sideBySideOptions.left2DView&&this.mapWidgetRoot.classList.add("left-2d-view"),this.verticalSideBySide=!1,this.setRotation(0)):(this.viewer.container.style.width="100%",this.viewer.container.style.height=(100-this.sideBySideSplit).toString()+"%",this.viewer.container.style.top=this.sideBySideSplit.toString()+"%",this.viewer.container.style.left="0px",this.viewer.container.style.right="initial",this.verticalSideBySide=!0,this.setRotation(Math.PI/2)),this.sideBySideOptions.onSideBySideUpdated&&this.sideBySideOptions.onSideBySideUpdated(this.sideBySideSplit)}else this.viewer.container.appendChild(this.mapWidgetRoot),this.viewer.container.style.width="100%",this.viewer.container.style.height="100%",this.viewer.container.style.left="0%",this.viewer.container.style.top="0%",this.mapWidgetRoot.classList.remove("side-by-side"),this.mapWidgetRoot.classList.remove("left-2d-view"),this.setRotation(0);this.viewer.resize(),this.updateMapSize(),this.resetScrolling()}}},{key:"sheetMapsAvailable",value:function(){var e=this.getCurrentLevel(),t=e&&this.mapCache[e.index];return t&&t.sheetMaps&&t.sheetMaps.length}},{key:"animationActive",value:function(){var e=Math.abs(this.zoomLevel-this.targetZoomLevel)>1e-9,t=this.targetScrollPos.clone().sub(this.scrollPos).length()>=.5,i=this.fadingWidgets>0,n=this.sheetMapTransition.isRunning();return e||t||i||n}},{key:"setRotation",value:function(e){this.mapRotationAngle=e,this.updateRotation()}},{key:"updateRotation",value:function(){var e=this.mapWidget.mapImage;if(e&&this.mapValid){var t=this.scrollPos.x+.5*this.mapWidgetWidth,i=this.scrollPos.y+.5*this.mapWidgetHeight;t*=100/this.scaledImageWidth,i*=100/this.scaledImageHeight,e.style.transformOrigin=b(t)+" "+b(i);var n="rotate("+this.mapRotationAngle.toString()+"rad)";e.style.transform=n}}},{key:"getWidgetCenter",value:function(){return new THREE.Vector2((this.scrollPos.x+.5*this.mapWidgetWidth)/this.zoomScale,(this.scrollPos.y+.5*this.mapWidgetHeight)/this.zoomScale)}},{key:"widgetToMapPixels",value:function(e){e.x+=this.scrollPos.x,e.y+=this.scrollPos.y,e.x/=this.zoomScale,e.y/=this.zoomScale;var t=this.getWidgetCenter();Object(l.rotateAround)(e,t,-this.mapRotationAngle)}},{key:"mapPixelsToWidget",value:function(e){var t=this.getWidgetCenter();Object(l.rotateAround)(e,t,this.mapRotationAngle),e.x*=this.zoomScale,e.y*=this.zoomScale,e.x-=this.scrollPos.x,e.y-=this.scrollPos.y}},{key:"isAllDone",value:function(){var e=this.currentLevelIndex===this.getCurrentLevel(),t=!this.scrollPos.equals(this.targetScrollPos),i=this.zoomLevel!==this.targetZoomLevel||this.sheetMapTransition.isRunning();return this.mapModelsReady()&&!this.updatingMap&&!this.sheetMap.loading&&!e&&!this.slidingInProgress&&!this.tool.flyToAnimRunning()&&!t&&!i}},{key:"waitForAllDone",value:function(){var e=this;return this.update(),this.isAllDone()?Promise.resolve():new Promise((function(t){e.waitingCallbacks.push(t)}))}}])&&c(i.prototype,h),y&&c(i,y),t}(f.Extension);y.Minimap3DExtension=M,Bimfish.Viewing.theExtensionManager.registerExtension("Bimfish.AEC.Minimap3DExtension",M)},"./extensions/AEC/Minimap3D/MinimapMath.js":
/*!*************************************************!*\
  !*** ./extensions/AEC/Minimap3D/MinimapMath.js ***!
  \*************************************************/
/*! exports provided: worldToMapPixels, mapPixelsToWorld, posIsInsideMap, setCameraFromFrustumCorners, setTopView, compute3DTo2DMatrix, motionSmoothing, rotateAround, expandToSquare, boundsToUnitQuad */function(e,t,i){"use strict";i.r(t),i.d(t,"worldToMapPixels",(function(){return n})),i.d(t,"mapPixelsToWorld",(function(){return o})),i.d(t,"posIsInsideMap",(function(){return a})),i.d(t,"setCameraFromFrustumCorners",(function(){return s})),i.d(t,"setTopView",(function(){return l})),i.d(t,"compute3DTo2DMatrix",(function(){return h})),i.d(t,"motionSmoothing",(function(){return d})),i.d(t,"rotateAround",(function(){return c})),i.d(t,"expandToSquare",(function(){return u})),i.d(t,"boundsToUnitQuad",(function(){return p}));var n=function(e,t,i,n){var o=e.clone().applyProjection(t);return new THREE.Vector2((o.x+1)/2*i,(1-o.y)/2*n)},o=function(e,t,i,n,o,r){var a=e/o*2-1,s=t/r*2-1,l=new THREE.Vector3(a,-s,0).applyProjection(n);return l.z=i,l},r=null,a=function(e,t){var i=(r=r||new THREE.Vector3).copy(e).applyProjection(t);return Math.abs(i.x)<1&&Math.abs(i.y)<1},s=function(e,t,i,n){e.up.x=n.x-t.x,e.up.y=n.y-t.y,e.position.x=.5*(i.x+n.x),e.position.y=.5*(i.y+n.y);var o=e.up.length();e.up.multiplyScalar(1/o);var r=o;e.position.z=e.target.z+r,e.target.x=e.position.x,e.target.y=e.position.y,Bimfish.Viewing.Navigation.prototype.orient(e,e.target,e.position,e.up)},l=function(e,t,i,n,o){var r=THREE.Box3.prototype.center.call(t);e.position.copy(r),e.position.z=n,e.target.copy(e.position),e.target.z-=o,e.isPerspective=!1,e.up.set(0,1,0),e.worldup.set(0,1,0),e.near=0,e.far=n-i,e.updateCameraMatrices()},h=function(e,t){t.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse)},d=function(e,t,i,n,o){var r=Math.min(i,n+o*t),a=o*Math.sqrt(2*e/o),s=(r=Math.min(a,r))*t;return Math.min(e,s)},c=function(e,t,i){var n=Math.cos(i),o=Math.sin(i),r=e.x-t.x,a=e.y-t.y;e.x=r*n-a*o+t.x,e.y=r*o+a*n+t.y},u=function(e){var t=e.size(),i=e.center(),n=.5*Math.max(t.x,t.y);e.min.set(i.x-n,i.y-n),e.max.set(i.x+n,i.y+n)},p=function(e,t){var i=t.max.x-t.min.x,n=t.max.y-t.min.y;e.x-=t.min.x,e.y-=t.min.y,e.x/=i,e.y/=n}},"./extensions/AEC/Minimap3D/MinimapTool.js":
/*!*************************************************!*\
  !*** ./extensions/AEC/Minimap3D/MinimapTool.js ***!
  \*************************************************/
/*! exports provided: default */function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return l}));var n=i(/*! ./MinimapMath.js */"./extensions/AEC/Minimap3D/MinimapMath.js");function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=Bimfish.Viewing.GlobalManagerMixin,s=new THREE.Vector3(0,0,1),l=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;o(this,e),this.parent=t,this.setGlobalManager(this.parent.globalManager),this.trackUsage=i,this.avatarInteractionTracked=!1,this.zoomTracked=!1,this.dragDirectionStart=this.dragDirectionStart.bind(this),this.dragDirectionMove=this.dragDirectionMove.bind(this),this.dragDirectionEnd=this.dragDirectionEnd.bind(this),this.dragPositionStart=this.dragPositionStart.bind(this),this.dragPositionMove=this.dragPositionMove.bind(this),this.dragPositionEnd=this.dragPositionEnd.bind(this),this.dragMapStart=this.dragMapStart.bind(this),this.dragMapMove=this.dragMapMove.bind(this),this.dragMapEnd=this.dragMapEnd.bind(this),this.onWheel=this.onWheel.bind(this),this.onDblClick=this.onDblClick.bind(this),this.handleGesture=this.handleGesture.bind(this),this.lastAngle=void 0,this.zoomSensitivity=.05,this.dragLock=!1,this.flyToTime=1,this.flyToAnim=null}var t,i,a;return t=e,(i=[{key:"onWheel",value:function(e){if(!this.parent.animationActive()){var t=e.wheelDelta/40,i=this.parent.targetZoomLevel+t*this.zoomSensitivity,n=this.parent.getMaxZoomLevel(),o=this.parent.getMinZoomLevel();if((i=THREE.Math.clamp(i,o,n))!==this.parent.targetZoomLevel){var r=this.getMapPosition(e);if(this.parent.setZoomLevel(i,!1),!this.dragLock){this.parent.resetScrolling();var a=this.getMapPosition(e),s=r.clone().sub(a);this.parent.mapCenter=this.parent.mapCenter.clone().add(s),this.parent.resetScrolling()}this.zoomTracked||(this.zoomTracked=!0,this.trackUsage&&this.trackUsage({zoom_tracked:!0})),e.stopPropagation(),e.preventDefault()}}}},{key:"activate",value:function(){this.parent.playerPositionWidget.playerPositionHitArea.addEventListener("mousedown",this.dragPositionStart),this.parent.playerPositionWidget.playerPositionHitArea.addEventListener("touchstart",this.dragPositionStart),this.parent.playerPositionWidget.addEventListener("mousedown",this.dragDirectionStart),this.parent.playerPositionWidget.addEventListener("touchstart",this.dragDirectionStart),this.parent.mapWidget.addEventListener("mousedown",this.dragMapStart),this.parent.mapWidget.addEventListener("wheel",this.onWheel),this.parent.mapWidget.addEventListener("dblclick",this.onDblClick),Bimfish.Viewing.isTouchDevice()&&(this.hammer=new Bimfish.Viewing.Hammer.Manager(this.parent.mapWidget,{recognizers:[Bimfish.Viewing.GestureRecognizers.drag,Bimfish.Viewing.GestureRecognizers.doubletap,Bimfish.Viewing.GestureRecognizers.pinch],handlePointerEventMouse:!1,inputClass:Bimfish.Viewing.isIE11?Bimfish.Viewing.Hammer.PointerEventInput:Bimfish.Viewing.Hammer.TouchInput}),this.hammer.get("pinch").recognizeWith([this.hammer.get("drag")]),this.hammer.on("pinchstart pinchmove pinchend",this.handleGesture),this.hammer.on("dragstart dragmove dragend",this.handleGesture),this.hammer.on("doubletap",this.onDblClick))}},{key:"deactivate",value:function(){this.parent.playerPositionWidget.playerPositionHitArea.removeEventListener("mousedown",this.dragPositionStart),this.parent.playerPositionWidget.playerPositionHitArea.removeEventListener("touchend",this.dragPositionStart),this.parent.playerPositionWidget.removeEventListener("mousedown",this.dragDirectionStart),this.parent.playerPositionWidget.removeEventListener("touchstart",this.dragDirectionStart),this.parent.mapWidget.removeEventListener("mousedown",this.dragMapStart),this.parent.mapWidget.removeEventListener("wheel",this.onWheel),this.parent.mapWidget.removeEventListener("dblclick",this.onDblClick),this.hammer&&this.hammer.destroy(),this.dragPositionEnd(),this.dragDirectionEnd(),this.dragMapEnd()}},{key:"getNormalizedPointersDistance",value:function(e){if(e.pointers[0]&&e.pointers[1]){var t=(e.pointers[1].clientX-e.pointers[0].clientX)/this.parent.mapWidgetWidth,i=(e.pointers[1].clientY-e.pointers[0].clientY)/this.parent.mapWidgetHeight;return Math.sqrt(t*t+i*i)}return 0}},{key:"setMeanPoint",value:function(e){e.pointers[0]&&e.pointers[1]&&(e.clientX=(e.pointers[1].clientX+e.pointers[0].clientX)/2,e.clientY=(e.pointers[1].clientY+e.pointers[0].clientY)/2)}},{key:"handleGesture",value:function(e){if(!this.dragLock||"map"===this.dragType){this.convertEventHammerToMouse(e),this.setMeanPoint(e);var t=3e3*this.getNormalizedPointersDistance(e);switch(e.wheelDelta=t-(this.lastPinchDistance||0),this.lastPinchDistance=t,e.type){case"dragstart":this.dragMapStart(e);break;case"dragmove":this.dragMapMove(e);break;case"dragend":this.dragMapEnd(e);break;case"pinchstart":this.lastDragMapPoint=null,this.dragMapStart(e),this.lastDragMapPoint=this.getMapPosition(e,!0);break;case"pinchmove":this.dragMapMove(e),this.onWheel(e),this.lastDragMapPoint=this.getMapPosition(e,!0);break;case"pinchend":this.dragMapEnd(e),this.onWheel(e)}}}},{key:"getMapPosition",value:function(e,t){var i=this.parent.mapWidget.getBoundingClientRect();e.type.contains("touch")&&(e.clientX=e.touches[0].pageX,e.clientY=e.touches[0].pageY);var n=new THREE.Vector2(e.clientX-i.left,e.clientY-i.top);return t?(n.x/=this.parent.zoomScale,n.y/=this.parent.zoomScale):this.parent.widgetToMapPixels(n),n}},{key:"dragMapStart",value:function(e){this.dragLock||this.parent.animationActive()||(this.dragType="map",this.addWindowEventListener("mousemove",this.dragMapMove),this.addWindowEventListener("mouseup",this.dragMapEnd),this.lastDragMapPoint=this.getMapPosition(e,!0),this.parent.mapCenter=this.parent.mapCenter.clone(),this.dragLock=!0,e.stopPropagation(),e.preventDefault())}},{key:"dragMapMove",value:function(e){if(!this.dragLock||"map"===this.dragType){var t=this.getMapPosition(e,!0);if(this.lastDragMapPoint){var i=this.lastDragMapPoint.sub(t);Object(n.rotateAround)(i,{x:0,y:0},-this.parent.mapRotationAngle),this.parent.mapCenter.add(i)}this.lastDragMapPoint=t,this.parent.resetScrolling(),this.parent.update(),e.stopPropagation()}}},{key:"dragMapEnd",value:function(e){this.dragLock&&"map"!==this.dragType||(this.removeWindowEventListener("mousemove",this.dragMapMove),this.removeWindowEventListener("mouseup",this.dragMapEnd),this.lastDragMapPoint=null,this.parent.update(),this.dragLock=!1,e&&e.stopPropagation())}},{key:"dragPositionStart",value:function(e){this.dragLock||(this.dragType="position",this.addWindowEventListener("mousemove",this.dragPositionMove),this.addWindowEventListener("mouseup",this.dragPositionEnd),this.addWindowEventListener("touchmove",this.dragPositionMove),this.addWindowEventListener("touchend",this.dragPositionEnd),this.parent.autoScrollLocked=!0,this.dragLock=!0,e.stopPropagation(),e.preventDefault())}},{key:"dragPositionMove",value:function(e){if(!this.dragLock||"position"===this.dragType){var t=this.getMapPosition(e),i=t.x,n=t.y;i=THREE.Math.clamp(i,0,this.parent.mapImageWidth),n=THREE.Math.clamp(n,0,this.parent.mapImageHeight);var o=this.parent.viewer.impl.camera,r=o.position.z,a=o.position.clone(),s=this.parent.mapPixelsToWorld(i,n,r);o.position.copy(s);var l=o.position.clone().sub(a);o.target.add(l),o.target.z=r,this.parent.viewer.impl.invalidate(!0,!0,!0),this.parent.viewer.dispatchEvent({type:Bimfish.Viewing.CAMERA_CHANGE_EVENT,camera:o}),e.stopPropagation()}}},{key:"dragPositionEnd",value:function(e){this.dragLock&&"position"!==this.dragType||(this.parent.autoScrollLocked=!1,this.removeWindowEventListener("mousemove",this.dragPositionMove),this.removeWindowEventListener("mouseup",this.dragPositionEnd),this.removeWindowEventListener("touchmove",this.dragPositionMove),this.removeWindowEventListener("touchend",this.dragPositionEnd),this.avatarInteractionTracked||(this.avatarInteractionTracked=!0,this.trackUsage&&this.trackUsage({avatar_interaction_tracked:!0})),this.parent.update(),this.dragLock=!1,e&&e.stopPropagation())}},{key:"dragDirectionStart",value:function(e){if(!this.dragLock){this.dragType="direction";var t=this.parent.playerPos,i=this.getMapPosition(e);this.lastAngle=this.parent.computeAngle(t,i),this.addWindowEventListener("mousemove",this.dragDirectionMove),this.addWindowEventListener("mouseup",this.dragDirectionEnd),this.addWindowEventListener("touchmove",this.dragDirectionMove),this.addWindowEventListener("touchend",this.dragDirectionEnd),this.dragLock=!0,e.stopPropagation(),e.preventDefault()}}},{key:"dragDirectionMove",value:function(e){if(!this.dragLock||"direction"===this.dragType){var t=this.parent.playerPos,i=this.getMapPosition(e),n=this.parent.computeAngle(t,i),o=this.lastAngle-n,r=this.parent.viewer.impl.camera,a=r.target.clone().sub(r.position);a.applyAxisAngle(s,o),a.add(r.position),r.target.copy(a),r.up.applyAxisAngle(s,o),this.parent.viewer.impl.syncCamera(),this.parent.viewer.dispatchEvent({type:Bimfish.Viewing.CAMERA_CHANGE_EVENT,camera:r}),this.lastAngle=n,e.stopPropagation()}}},{key:"dragDirectionEnd",value:function(e){this.dragLock&&"direction"!==this.dragType||(this.removeWindowEventListener("mousemove",this.dragDirectionMove),this.removeWindowEventListener("mouseup",this.dragDirectionEnd),this.removeWindowEventListener("touchmove",this.dragDirectionMove),this.removeWindowEventListener("touch",this.dragDirectionEnd),this.dragLock=!1,e&&e.stopPropagation())}},{key:"onDblClick",value:function(e){this.convertEventHammerToMouse(e);var t=this.getMapPosition(e),i=t.x,n=t.y;if((this.parent.mapValid||this.parent.useSheet&&this.parent.sheetMap.ready)&&this.parent.mapPixelValid(i,n)){var o=this.parent.viewer.impl.camera,r=o.getWorldDirection();r.z=Math.max(r.z,0);var a=this.parent.getCurrentLevel(),s=this.parent.mapModels&&this.parent.mapModels[0];if(a&&s){var l=1.7/s.getUnitScale(),h=a.zMin+l;if(isFinite(h)){var d=this.parent.mapPixelsToWorld(i,n,h),c=d.clone().add(r),u={position:d,target:c,up:o.up};this.parent.isOutside()?(o.position.copy(d),o.target.copy(d).add(r),this.parent.viewer.impl.invalidate(!0,!0,!0),this.parent.viewer.dispatchEvent({type:Bimfish.Viewing.CAMERA_CHANGE_EVENT,camera:o}),this.parent.targetZoomLevel=0):this.flyToAnim=Bimfish.Viewing.Private.flyToView(this.parent.viewer,u,this.flyToTime),e.stopPropagation(),e.preventDefault()}}}}},{key:"flyToAnimRunning",value:function(){return this.flyToAnim&&this.flyToAnim.isRunning}},{key:"convertEventHammerToMouse",value:function(e){e.pointers&&(e.clientX=e.pointers[0].clientX,e.clientY=e.pointers[0].clientY)}}])&&r(t.prototype,i),a&&r(t,a),e}();a.call(l.prototype)},"./extensions/AEC/Minimap3D/MinimapToolbar.js":
/*!****************************************************!*\
  !*** ./extensions/AEC/Minimap3D/MinimapToolbar.js ***!
  \****************************************************/
/*! exports provided: default */function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.r(t),i.d(t,"default",(function(){return s}));var o=Bimfish.Viewing,r=o.UI,a=o.GlobalManagerMixin,s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=t,this.setGlobalManager(t.globalManager);var i=this.getDocument();this.mapButtonBar=i.createElement("div"),this.mapButtonBar.classList.add("map-button-bar"),t.mapWidgetRoot.appendChild(this.mapButtonBar),this.mapButtonBar.classList.add("adsk-viewing-viewer"),this.mapButtonBar.classList.add(t.viewer.theme),this.sideBySideButton=new r.Button("Minimap_SideBySide"),this.sideBySideButton.setGlobalManager(this.globalManager),this.sideBySideButton.onClick=function(){return t.setSideBySideEnabled(!t.sideBySideEnabled)},this.sideBySideButton.icon.innerHTML=h(),this.mapButtonBar.appendChild(this.sideBySideButton.container),this.shrinkIcon=i.createElement("div"),this.shrinkIcon.innerHTML=d(),this.sideBySideButton.container.appendChild(this.shrinkIcon),this.sheetModeButton=new r.Button("Minimap_SheetMode"),this.sheetModeButton.setGlobalManager(this.globalManager),this.sheetModeButton.onClick=function(){return t.setSheetMapEnabled(!t.useSheet)},this.sheetModeButton.icon.innerHTML=l(),this.mapButtonBar.appendChild(this.sheetModeButton.container);var n=function(e){e.container.style.width="17px",e.container.style.height="17px",e.icon.classList.remove("adsk-button-icon"),e.setToolTip("");var t=e._toolTipElement.style;t.bottom="6.5px",t.top="auto",t.left="auto",t.right="130%",t.zIndex=3};n(this.sideBySideButton),n(this.sheetModeButton),this.parent.options.enableSheetMapAndSideBySide||(this.mapButtonBar.style.display="none"),this.sheetModeButton.icon.style.display="inline",this.update()}var t,i,o;return t=e,(i=[{key:"setSideBySideButtonDisabled",value:function(e){this.parent.options.sideBySideButtonDisabled=e}},{key:"update",value:function(){this.shrinkIcon.style.display=this.parent.sideBySideEnabled?"inline":"none",this.sideBySideButton.icon.style.display=this.parent.sideBySideEnabled?"none":"inline";var e=this.parent.sheetMapsAvailable(),t=e?this.parent.useSheet?r.Button.State.ACTIVE:r.Button.State.INACTIVE:r.Button.State.DISABLED;this.sheetModeButton.setState(t),this.sideBySideButton.setState(this.parent.options.sideBySideButtonDisabled?r.Button.State.DISABLED:r.Button.State.INACTIVE);var i=Bimfish.Viewing.i18n.translate("Show large map"),n=Bimfish.Viewing.i18n.translate("Show small map"),o=Bimfish.Viewing.i18n.translate("Show sheet"),a=Bimfish.Viewing.i18n.translate("No sheets available");this.sideBySideButton.setToolTip(this.parent.sideBySideEnabled?n:i),this.sheetModeButton.setToolTip(e?o:a),this.parent.sideBySideEnabled?(this.mapButtonBar.classList.add("side-by-side"),this.parent.sideBySideOptions.left2DView&&this.mapButtonBar.classList.add("left-2d-view")):this.mapButtonBar.classList.remove("side-by-side")}}])&&n(t.prototype,i),o&&n(t,o),e}();a.call(s.prototype);var l=function(){return['<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 70 61">','<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">','<rect id="Rectangle" stroke="#000000" stroke-width="3" x="51.5" y="41.5" width="1" height="7"></rect>','<rect id="Rectangle-Copy" stroke="#000000" stroke-width="3" x="51.5" y="28.5" width="1" height="7"></rect>','<rect id="Rectangle-Copy-2" stroke="#000000" stroke-width="3" x="51.5" y="11.5" width="1" height="10"></rect>','<rect id="Rectangle-Copy-3" stroke="#000000" stroke-width="3" x="58.5" y="11.5" width="1" height="17"></rect>','<rect id="Rectangle-Copy-4" stroke="#000000" stroke-width="3" x="58.5" y="35.5" width="1" height="3"></rect>','<rect id="Rectangle-Copy-5" stroke="#000000" stroke-width="3" x="58.5" y="45.5" width="1" height="3"></rect>','<path d="M11.5,11.5 L11.5,28.5 L29.5,28.5 L29.5,48.5 L44.5,48.5 L44.5,11.5 L11.5,11.5 Z" id="Path-3" stroke="#000000" stroke-width="3"></path>','<path d="M11.5,35.5 L11.5,45.5 L23.5,45.5 L23.5,35.5 L11.5,35.5 Z" id="Path-3" stroke="#000000" stroke-width="3"></path>','<path d="M3,3 L3,57 L67,57 L67,3 L3,3 Z" id="Path-3" stroke="#000000" stroke-width="6"></path>',"</g>","</svg>"].join("")},h=function(){return['<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70 70">','<g fill-rule="evenodd">','<polygon points="9.013 5.28 21.779 5.28 21.779 0 0 0 0 21.779 5.28 21.779 5.28 9.013 23.363 27.097 27.097 23.363"/>','<polygon points="27.097 46.637 23.363 42.903 5.28 60.987 5.28 48.221 0 48.221 0 70 21.779 70 21.779 64.72 9.013 64.72"/>','<polygon points="48.221 0 48.221 5.28 60.987 5.28 42.903 23.363 46.637 27.097 64.72 9.013 64.72 21.779 70 21.779 70 0"/>','<polygon points="64.72 48.221 64.72 60.987 46.637 42.903 42.903 46.637 60.987 64.72 48.221 64.72 48.221 70 70 70 70 48.221"/>',"</g>","</svg>"].join("")},d=function(){return['<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70 70">','<g fill-rule="evenodd">','<polygon points="9.013 5.28 21.779 5.28 21.779 0 0 0 0 21.779 5.28 21.779 5.28 9.013 23.363 27.097 27.097 23.363" transform="rotate(180 13.548 13.548)"/>','<polygon points="27.097 46.637 23.363 42.903 5.28 60.987 5.28 48.221 0 48.221 0 70 21.779 70 21.779 64.72 9.013 64.72" transform="rotate(180 13.548 56.452)"/>','<polygon points="48.221 0 48.221 5.28 60.987 5.28 42.903 23.363 46.637 27.097 64.72 9.013 64.72 21.779 70 21.779 70 0" transform="rotate(180 56.452 13.548)"/>','<polygon points="64.72 48.221 64.72 60.987 46.637 42.903 42.903 46.637 60.987 64.72 48.221 64.72 48.221 70 70 70 70 48.221" transform="rotate(180 56.452 56.452)"/>',"</g>","</svg>"].join("")}},"./extensions/AEC/Minimap3D/SheetMap.js":
/*!**********************************************!*\
  !*** ./extensions/AEC/Minimap3D/SheetMap.js ***!
  \**********************************************/
/*! exports provided: default */function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return c}));var n=i(/*! ../common/AecModelData.js */"./extensions/AEC/common/AecModelData.js"),o=i(/*! ./MinimapMath.js */"./extensions/AEC/Minimap3D/MinimapMath.js"),r=i(/*! ./SheetThumbnail.js */"./extensions/AEC/Minimap3D/SheetThumbnail.js");function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),e}var h=Bimfish.Viewing,d=function(){function e(t,i,n,o){a(this,e),this.sheetNode=t,this.viewport=i,this.mapMatrix=n,this.mapMatrixInv=(new THREE.Matrix4).getInverse(n),this.levelGuid=o,this.thumbnail=void 0}return l(e,[{key:"isUsable",value:function(e,t){return this.levelGuid===t&&Object(o.posIsInsideMap)(e,this.mapMatrix)}}]),e}(),c=function(){function e(t){a(this,e),this.mapViewer=null,this.sheetRegion=null,this.ready=!1,this.loading=!1,this.levelGuid=null,this.sheetCache=[],this.config=null,this.visible=!1,this.tmpMatrix=new THREE.Matrix4,this.tmpVec=new THREE.Vector3,this.parent=t}return l(e,[{key:"initMapViewer",value:function(e,t){if(t)e.appendChild(t.container);else{var i=h.getGlobal(),n=i.NOP_VIEWER;(t=new Bimfish.Viewing.Viewer3D(e,{})).initialize(),i.NOP_VIEWER=n;var o=t.container.style;o.zIndex=1,o.opacity=0,o.pointerEvents="none",o.width="100%",o.height="100%"}return this.mapViewer=t,this.setVisible(!1),t}},{key:"clearSheetCache",value:function(){this.mapViewer&&(this.sheetCache=[],this.mapViewer.impl.unloadCurrentModel(),this.ready=!1)}},{key:"setVisible",value:function(e){this.mapViewer&&(this.mapViewer.container.style.visibility=e?"visible":"hidden",this.visible=e)}},{key:"cropToViewport",value:function(){var e=[new THREE.Vector4(0,-1,0,this.sheetRegion.min.y),new THREE.Vector4(0,1,0,-this.sheetRegion.max.y),new THREE.Vector4(-1,0,0,this.sheetRegion.min.x),new THREE.Vector4(1,0,0,-this.sheetRegion.max.x)];this.mapViewer.impl.setCutPlaneSet("SheetRegion",e)}},{key:"clearCutPlanes",value:function(){this.mapViewer.impl.setCutPlaneSet("SheetRegion",[])}},{key:"clearMap",value:function(){this.levelGuid=void 0,this.loading=!1,this.ready=!1,this.config=null,this.setVisible(!1),this.clearCutPlanes();var e=this.mapViewer.model;e&&this.mapViewer.hideModel(e.id)}},{key:"findMap",value:function(t,i,n){return e.findMaps(t,i).find((function(e){return Object(o.posIsInsideMap)(n,e.mapMatrix)}))}},{key:"refineThumbnail",value:function(e,t){if(!t.thumbnailRefined){t.thumbnailRefined=!0;var i=e.getBoundingBox(),n=e.getDocumentNode().search({type:"view"})[0],o=n&&n.getViewBox();o&&(i.min.x=o[0],i.min.y=o[1],i.max.x=o[2],i.max.y=o[3]);var r=new Bimfish.Viewing.UnifiedCamera(1e3,1e3);r.setViewFromBox(i,!0);var a={camera:r};this.screenShotInProgress=this.mapViewer.impl.getScreenShotProgressive(1e3,1e3,(function(e){t.thumbnail.refineImage(e)}),a)}}},{key:"initMap",value:function(e,t){var i=this;this.clearMap(),this.loading=!0,this.config=e;var o=function(o){if(i.sheetCache[e.sheetNode.id]=o,e===i.config){var r=o.getUnitScale();i.sheetRegion=n.default.getViewportBounds(e.viewport,r),i.cropToViewport(),i.refineThumbnail(o,e),i.loading=!1,i.ready=!0,t()}};this.mapMatrix=e.mapMatrix,this.config=e;var r=function(e){if(e.isLoadDone())o(e);else{i.mapViewer.addEventListener(Bimfish.Viewing.GEOMETRY_LOADED_EVENT,(function t(n){n.model===e&&(o(e),i.mapViewer.removeEventListener(Bimfish.Viewing.GEOMETRY_LOADED_EVENT,t))}))}},a=this.sheetCache[e.sheetNode.id];if(a)this.mapViewer.showModel(a.id),r(a);else{var s=e.sheetNode.getRootNode().getDocument();this.mapViewer.loadDocumentNode(s,e.sheetNode).catch((function(t){console.error("Failed to load sheet for minimap: ",e.sheetNode.name(),": ",t)})).then(r)}}},{key:"isUsable",value:function(e,t){return this.ready&&this.config.isUsable(e,t)}},{key:"onResize",value:function(){this.mapViewer&&this.mapViewer.resize()}},{key:"getAspectRatio",value:function(){return(this.sheetRegion.max.x-this.sheetRegion.min.x)/(this.sheetRegion.max.y-this.sheetRegion.min.y)}},{key:"initialized",value:function(){return this.loading||this.ready}},{key:"widgetToSheet",value:function(e){this.parent.widgetToMapPixels(e);var t=this.parent.mapPixelsToWorld(e.x,e.y,0);t.applyMatrix4(this.config.mapMatrix),t.x=(t.x+1)/2,t.y=(t.y+1)/2;var i=this.sheetRegion.max.x-this.sheetRegion.min.x,n=this.sheetRegion.max.y-this.sheetRegion.min.y;e.x=this.sheetRegion.min.x+i*t.x,e.y=this.sheetRegion.min.y+n*t.y}},{key:"syncCameraToMainMap",value:function(){var e=this.parent.mapWidgetWidth,t=this.parent.mapWidgetHeight,i=new THREE.Vector2(0,t),n=new THREE.Vector2(e,t),r=new THREE.Vector2(0,0);this.widgetToSheet(i),this.widgetToSheet(n),this.widgetToSheet(r);var a=this.mapViewer.impl.camera;Object(o.setCameraFromFrustumCorners)(a,i,n,r),this.mapViewer.impl.invalidate(!0,!0)}}],[{key:"computeMapMatrix",value:function(e,t,i){var o=n.default.getViewportBounds(e,1),r=n.default.remapRectangle(o.min.x,o.min.y,o.max.x,o.max.y,-1,-1,1,1),a=n.default.get3DTo2DMatrix(e,1),s=(new THREE.Matrix4).multiplyMatrices(r,a);if(t.myData.placementWithOffset){var l=i||new THREE.Matrix4;l.getInverse(t.myData.placementWithOffset),s.multiply(l)}return s}},{key:"findMaps",value:function(t,i){for(var o=[],r=0;r<t.length;r++){var a=t[r],s=a.getDocumentNode().getAecModelData(),l=s&&n.default.findViewportsForLevel(s,i).filter(n.default.supports2DTo3DTransform);if(l)for(var h=a.getDocumentNode().getRootNode(),c=0;c<l.length;c++){var u=l[c],p=n.default.findSheetForViewport(h,u);if(p){var m=e.computeMapMatrix(u,a,this.tmpMatrix);o.push(new d(p,u,m,i))}}}return o}},{key:"createSheetMapConfigs",value:function(t,i,n,o,a){for(var s=e.findMaps(t,i),l=[],h=0;h<s.length;h++){var d=s[h];d.sheetNode.search({type:"view"}).length>0&&(d.thumbnail=new r.default(d,n,o,a),l.push(d))}return l}}]),e}();c.OverlayOpacity=.5},"./extensions/AEC/Minimap3D/SheetMapTransition.js":
/*!********************************************************!*\
  !*** ./extensions/AEC/Minimap3D/SheetMapTransition.js ***!
  \********************************************************/
/*! exports provided: default */function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return h}));var n=i(/*! ./SheetMap.js */"./extensions/AEC/Minimap3D/SheetMap.js");function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=Bimfish.Viewing,a=r.Private,s=r.GlobalManagerMixin,l=function(e){var t=e.ownerDocument,i=(t.defaultView||t.parentWindow).getComputedStyle(e);return parseFloat(i.opacity)},h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setGlobalManager(t.globalManager),this.minimap=t,this.sheetMap=t.sheetMap,this.angleStart=void 0,this.angleEnd=void 0,this.zoomLevelStart=void 0,this.zoomLevelEnd=void 0,this.viewerOpacityStart=void 0,this.viewerOpacityEnd=void 0,this.thumbnailOpacityStart=void 0,this.thumbnailOpacityEnd=void 0,this.zoomingIn=!1,this.animTime=2}var t,i,r;return t=e,(i=[{key:"stop",value:function(){this.anim&&this.anim.stop()}},{key:"isRunning",value:function(){return this.anim&&this.anim.isRunning}},{key:"isZoomingIn",value:function(){return this.zoomingIn&&this.anim&&this.anim.isRunning}},{key:"isZoomingOut",value:function(){return!this.zoomingIn&&this.anim&&this.anim.isRunning}},{key:"enterSheet",value:function(){var e=this;this.isZoomingIn()||(this.stop(),this.zoomIn=!0,this.startAngle=this.minimap.mapRotationAngle,this.endAngle=-this.minimap.sheetMap.config.thumbnail.angle,this.zoomLevelStart=this.minimap.zoomLevel,this.zoomLevelEnd=this.getTargetZoomLevel(),this.viewerOpacityStart=l(this.minimap.sheetMap.mapViewer.container),this.viewerOpacityEnd=n.default.OverlayOpacity,this.thumbnailOpacityStart=l(this.minimap.sheetMap.config.thumbnail.div),this.thumbnailOpacityEnd=0,this.anim=a.fadeValue(0,1,this.animTime,(function(t){return e.update(t)})),this.sheetMap.setVisible(!0))}},{key:"exitSheet",value:function(){var e=this;this.isZoomingOut()||(this.stop(),this.zoomIn=!1,this.startAngle=this.minimap.mapRotationAngle,this.endAngle=0,this.zoomLevelStart=this.minimap.zoomLevel,this.zoomLevelEnd=.5*this.minimap.zoomLevel,this.viewerOpacityStart=l(this.sheetMap.mapViewer.container),this.viewerOpacityEnd=0,this.thumbnailOpacityStart=l(this.sheetMap.config.thumbnail.div),this.thumbnailOpacityEnd=n.default.OverlayOpacity,this.anim=a.fadeValue(0,1,this.animTime,(function(t){return e.update(t)}),(function(){e.sheetMap.setVisible(!1)})))}},{key:"getTargetZoomLevel",value:function(){var e=this.minimap.viewer.impl.camera.position,t=this.sheetMap.config.mapMatrix,i=this.sheetMap.config.mapMatrixInv,n=this.minimap.mapWidgetHeight,o=e.clone().applyMatrix4(t),r=Math.abs(o.y),a=Math.abs(1-o.y),s=Math.max(r,a),l=o.clone(),h=o.clone();l.y-=s,h.y+=s,l.applyMatrix4(i),h.applyMatrix4(i),l=this.minimap.worldToMapPixels(l),h=this.minimap.worldToMapPixels(h);var d=n/l.distanceTo(h);return Math.log2(d)}},{key:"update",value:function(e){e=a.smootherStep(e);var t=a.lerp(this.startAngle,this.endAngle,e),i=a.lerp(this.zoomLevelStart,this.zoomLevelEnd,e);this.minimap.setZoomLevel(i),this.minimap.setRotation(t),this.sheetMap.syncCameraToMainMap();var n=a.lerp(this.viewerOpacityStart,this.viewerOpacityEnd,e),o=a.lerp(this.thumbnailOpacityStart,this.thumbnailOpacityEnd,e);this.sheetMap.mapViewer.container.style.opacity=n,this.minimap.useSheet&&(this.sheetMap.config.thumbnail.div.style.opacity=o)}},{key:"onSheetWillChange",value:function(){this.stop(),this.minimap.useSheet&&this.sheetMap.config&&(this.sheetMap.config.thumbnail.div.style.opacity=n.default.OverlayOpacity)}}])&&o(t.prototype,i),r&&o(t,r),e}();s.call(h.prototype)},"./extensions/AEC/Minimap3D/SheetThumbnail.js":
/*!****************************************************!*\
  !*** ./extensions/AEC/Minimap3D/SheetThumbnail.js ***!
  \****************************************************/
/*! exports provided: default */function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return l}));var n=i(/*! ./MinimapMath.js */"./extensions/AEC/Minimap3D/MinimapMath.js");function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=Bimfish.Viewing,a=function(e){return e.toString()+"%"},s=function(e,t){var i=t.max.x-t.min.x,n=t.max.y-t.min.y,o=-t.min.x/i,r=(t.max.y-1)/n,s=1/i,l=1/n;e.style.left=a(100*o),e.style.top=a(100*r),e.style.width=a(100*s),e.style.height=a(100*l)},l=function(){function e(t,i,o,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.div=function(e){var t=r.getGlobal().document,i=t.createElement("div"),n=e.getRootNode().getDocument(),o=n.getThumbnailPath(e.data,400,400);if(Bimfish.Viewing.endpoint.getUseCookie())i.innerHTML='<img class="mapImage" src="'.concat(o,'" crossOrigin="use-credentials">');else{var a=t.createElement("image");a.classList.add("mapImage"),i.appendChild(a);var s=n.getThumbnailOptions(e.data,400,400);Bimfish.Viewing.Document.requestThumbnailWithSecurity(s,(function(t,i){if(t)console.warn("Failed to load sheet thumbnail. Error: ".concat(t,", Urn: ").concat(s.urn,", SheetName: ").concat(e.name()));else{var n=r.getGlobal().URL.createObjectURL(i);a.src=n}}))}var l=t.createElement("image");return l.classList.add("mapImage"),l.style.opacity=0,i.appendChild(l),i.preImage=i.children[0],i.image=l,i.className="sheetmap-thumbnail",i}(t.sheetNode);var h=t.sheetNode,d=t.viewport,c=t.mapMatrixInv,u=function(e,t){var i=Bimfish.AEC.AecModelData.getViewportBounds(t,.0254),o=e.search({type:"view"})[0];if(!o)return null;var r=o.getViewBox(),a=new THREE.Box2;return a.min.set(r[0],r[1]),a.max.set(r[2],r[3]),Object(n.expandToSquare)(a),Object(n.boundsToUnitQuad)(i.min,a),Object(n.boundsToUnitQuad)(i.max,a),i}(h,d);s(this.div.preImage,u),s(this.div.image,u);var p=new THREE.Vector3(-1,-1,0).applyMatrix4(c),m=new THREE.Vector3(1,-1,0).applyMatrix4(c),v=new THREE.Vector3(-1,1,0).applyMatrix4(c);p=Object(n.worldToMapPixels)(p,i,o,l),m=Object(n.worldToMapPixels)(m,i,o,l),v=Object(n.worldToMapPixels)(v,i,o,l),p.y=l-p.y,m.y=l-m.y,v.y=l-v.y,this.angle=function(e,t,i,n,o,r){var s=i.distanceTo(t),l=n.distanceTo(t),h=t.x,d=t.y,c=-Math.atan2(i.y-t.y,i.x-t.x);return e.style.width=a(100*s/o),e.style.height=a(100*l/r),e.style.left=a(100*h/o),e.style.bottom=a(100*d/r),e.style.transformOrigin="0% 100%",e.style.transform="rotate("+c.toString()+"rad)",c}(this.div,p,m,v,o,l)}var t,i,l;return t=e,(i=[{key:"refineImage",value:function(e){var t=this;this.div.image.src=e,Bimfish.Viewing.Private.fadeValue(0,1,1,(function(e){return t.div.image.style.opacity=e}),(function(){return t.div.removeChild(t.div.preImage)}))}}])&&o(t.prototype,i),l&&o(t,l),e}()},"./extensions/AEC/common/AecModelData.js":
/*!***********************************************!*\
  !*** ./extensions/AEC/common/AecModelData.js ***!
  \***********************************************/
/*! exports provided: default */function(e,t,i){"use strict";i.r(t);var n=AutodeskNamespace("Bimfish.AEC"),o=function(e,t,i,n,o,r,a,s){var l=(a-o)/(i-e),h=(s-r)/(n-t),d=o-l*e,c=r-h*t,u=new THREE.Matrix4;return u.elements[0]=l,u.elements[5]=h,u.elements[12]=d,u.elements[13]=c,u},r=function(e,t){var i=e.geometryViewportRegion;if(!i)return null;var n=.3048*(1/t),o=new THREE.Box2;return o.min.x=(i[0]+.01)*n,o.min.y=(i[1]+.01)*n,o.max.x=(i[3]-.01)*n,o.max.y=(i[4]-.01)*n,o},a=function(e,t){var i=r(e,t),n=e.sectionBox,a=Bimfish.Viewing.BubbleNode.readMatrixFromArray12(n.transform),s=o(i.min.x,i.min.y,i.max.x,i.max.y,0,0,1,1),l=function(e){var t=new THREE.Matrix4;switch(e){case 0:return t;case 1:t.elements[0]=0,t.elements[4]=-1,t.elements[12]=1,t.elements[1]=1,t.elements[5]=0;break;case 2:t.elements[0]=0,t.elements[4]=1,t.elements[1]=-1,t.elements[5]=0,t.elements[13]=1;break;default:console.warn("Unexpected enum value for view rotation: ",e)}return t}(e.viewportRotation),h=o(0,0,1,1,n.min.x,n.min.y,n.max.x,n.max.y);return a.multiply(h).multiply(l).multiply(s)},s=function(e){var t=e instanceof Bimfish.Viewing.BubbleNode?e:e.getDocumentNode(),i=t.getAecModelData();return i&&i.viewports?i.viewports.filter((function(e){return e.sheetGuid===t.guid()})):[]},l=function(e){var t=e.extensions&&e.extensions.viewRange,i=t&&t.cutPlane;return i&&i.levelGuid},h={get2DTo3DMatrix:a,get3DTo2DMatrix:function(e,t){var i=a(e,t);return i.getInverse(i),i},getViewportBounds:r,remapRectangle:o,findSheetForViewport:function(e,t){return e.search(Bimfish.Viewing.BubbleNode.SHEET_NODE).find((function(e){return e.guid()===t.sheetGuid}))},findViewportsForLevel:function(e,t){return(e.viewports||[]).filter((function(e){return l(e)===t}))},supports2DTo3DTransform:function(e){return Boolean(["FloorPlan","CeilingPlan","EngineeringPlan"].includes(e.viewType)&&e.sectionBox&&e.geometryViewportRegion&&e.isCropBoxActive&&!e.hasBreaks&&!e.extensions.hasRegions)},getLinkedLevel:l,findViewportsOnSheet:s,findViewportAtPoint:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,n=s(e);i&&(n=n.filter(i));var o=function(e){return e.bounds&&e.bounds.containsPoint(t)};if((n=(n=n.map((function(t){return{viewport:t,bounds:r(t,e.getUnitScale())}}))).filter(o)).length){var a=function(e,t){return Math.min(Math.min(t.x-e.min.x,e.max.x-t.x),Math.min(t.y-e.min.y,e.max.y-t.y))},l=function(e,i){var n=a(e.bounds,t);return a(i.bounds,t)>n?i:e};return n.reduce(l).viewport}},findLevelForViewport:function(e,t){var i=l(t);return i&&e.levels.find((function(e){return e.guid===i}))}};t.default=h,n.AecModelData=h},"./extensions/AEC/hyperlinks/HyperlinkExtension.js":
/*!*********************************************************!*\
  !*** ./extensions/AEC/hyperlinks/HyperlinkExtension.js ***!
  \*********************************************************/
/*! exports provided: default */function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return c}));var n=i(/*! ./HyperlinkTracker */"./extensions/AEC/hyperlinks/HyperlinkTracker.js");function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=Bimfish.Viewing,d=AutodeskNamespace("Bimfish.AEC"),c=function(e){function t(e,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=a(this,s(t).call(this,e,i))).hyperlinkTracker=new n.default(o.viewer,o.options.rootBubbleNode,o.options.loadViewableCb,o.options.hyperlinksAddedCb),o}var i,o,h;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,e),i=t,(o=[{key:"load",value:function(){return this.viewer.toolController.activateTool("hyperlink-tracker"),!0}},{key:"unload",value:function(){return this.viewer.toolController.deactivateTool("hyperlink-tracker"),!0}}])&&r(i.prototype,o),h&&r(i,h),t}(h.Extension);d.HyperlinkExtension=c,Bimfish.Viewing.theExtensionManager.registerExtension("Bimfish.AEC.HyperlinkExtension",c)},"./extensions/AEC/hyperlinks/HyperlinkTracker.js":
/*!*******************************************************!*\
  !*** ./extensions/AEC/hyperlinks/HyperlinkTracker.js ***!
  \*******************************************************/
/*! exports provided: default */function(t,i,n){"use strict";n.r(i),n.d(i,"default",(function(){return a}));var o=Bimfish.Viewing,r=Bimfish.Viewing.Private;function a(t,i,n,a){o.ToolInterface.call(this),this.names=["hyperlink-tracker"],t.toolController.registerTool(this);var s,l,h=t,d=n,c=a,u=[0,0],p={},m=0,v=!1,f=!1;function g(){var e,t=p[u[1]];if(!t){var i=1===(e=h.impl.modelQueue().getModels()).length?e[0]:void 0;i&&(t=p[i.id])}return t}function y(e){return e&&Object.keys(e).length>0}function E(e,t,i,n){var o=4*i,r=t.stringBoxes[o+1],a=t.stringBoxes[o+3],s=.2*(a-r);r-=s,a+=s;var l=t.stringBoxes[o]-s,h=t.stringBoxes[o+2]+s,d=t.stringDbIds[i],c=e.vcount;e.addVertexPolytriangle(l,r,2009054015,d,0,0),e.addVertexPolytriangle(h,r,2009054015,d,0,0),e.addVertexPolytriangle(h,a,2009054015,d,0,0),e.addVertexPolytriangle(l,a,2009054015,d,0,0),e.addIndices([0,1,2,0,2,3],c),e.addSegment(l,r,h,r,0,-2*n,-4211905,d,0,0,0),e.addSegment(h,r,h,a,0,-2*n,-4211905,d,0,0,0),e.addSegment(h,a,l,a,0,-2*n,-4211905,d,0,0,0),e.addSegment(l,a,l,r,0,-2*n,-4211905,d,0,0,0)}function w(t){if(t&&t.is2d()){var i=p[t.id];if(!i){var n=t.getDocumentNode(),o=n&&n.getRootNode(),a=o&&o.search({role:"2d",type:"geometry"});if(a&&a.length){i=p[t.id]={};var s="";t.myData&&(s=t.myData.basePath);var l=a.map((function(e){var t=function(e){if(e.children){var t=!0,i=!1,n=void 0;try{for(var o,r=e.children[Symbol.iterator]();!(t=(o=r.next()).done);t=!0){var a=o.value;if("resource"===a.type()){var s=a.urn();if(s){var l=s.split("/");return l.pop(),l.join("/")}}}}catch(e){i=!0,n=e}finally{try{t||null==r.return||r.return()}finally{if(i)throw n}}}return null}(e);if(-1===s.indexOf(t)){var i=e.name().split(" ")[0];if(i.length>2)return i}return""}));i.numHyperlinks=0;for(var d=new r.VertexBufferBuilder,u=1/(t.getData().loadOptions.modelScale||1),m=t.getData(),v=0;v<m.strings.length;v++){var f=l.indexOf(m.strings[v]);f>=0&&(i[m.stringDbIds[v]]=a[f],E(d,m,v,u),i.numHyperlinks++)}i.boxFragId=function(e,t){var i=e.getFragmentList().vizmeshes.length,n={mesh:t.toMesh(),is2d:!0,packId:"0",meshIndex:i};r.BufferGeometryUtils.meshToGeometry(n);var o=h.impl.matman().create2DMaterial(e,{}),a=h.impl.setupMesh(e,n.geometry,o,e.getData().loadOptions.placementTransform);return e.activateFragment(i,a),i}(t,d),c&&c(e.model.id,i.numHyperlinks)}}}}function b(e){w(e.model)}function M(e){for(var t=h.getVisibleModels().concat(h.getHiddenModels()),i=0;i<t.length;i++){var n=t[i];n.is2d()&&n.isLoadDone()&&e(n)}}this.update=function(){if(f)m=0;else if(v){var e=h.impl.clientToViewport(s,l);m=h.impl.renderer().idAtPixel(e.x,e.y,u),v=!1}return!1},this.handleSingleClick=function(){if(h.model&&h.model.is2d()){var e=h.impl.clientToViewport(s,l);m=h.impl.renderer().idAtPixel(e.x,e.y,u);var t=g(),i=y(t)?t[m]:null;return!!i&&(d(i,t.numHyperlinks),!0)}},this.handleButtonDown=function(e){return f=!0,s=e.canvasX,l=e.canvasY,!1},this.handleButtonUp=function(){return f=!1,!1},this.handleMouseMove=function(e){return s=e.canvasX,l=e.canvasY,v=!0,!1},this.activate=function(){M((function(e){w(e)})),h.addEventListener(o.GEOMETRY_LOADED_EVENT,b),h.impl.invalidate(!0,!0)},this.deactivate=function(){h.removeEventListener(o.GEOMETRY_LOADED_EVENT,b),M((function(e){var t=p[e.id];t&&function(e,t){var i=e.getFragmentList();i.vizmeshes[t].geometry.dispose(),delete i.vizmeshes[t]}(e,t.boxFragId)})),p={},h.impl.invalidate(!0,!0)},this.getCursor=function(){var e=g();return m<-1&&y(e)&&e[m]?"pointer":null}}AutodeskNamespace("Bimfish.AEC").HyperlinkTracker=a},"./extensions/AEC/levels/FloorSelector.js":
/*!************************************************!*\
  !*** ./extensions/AEC/levels/FloorSelector.js ***!
  \************************************************/
/*! exports provided: default */function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return p}));var n=i(/*! ./FloorSelectorFilter.js */"./extensions/AEC/levels/FloorSelectorFilter.js");function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=Bimfish.Viewing,a=Bimfish.Viewing.Private,s=AutodeskNamespace("Bimfish.AEC"),l=1e20,h=-l,d=0,c=1,u=2,p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r.EventDispatcher.prototype.apply(this),this._viewer=t,this._renderer=t.impl.renderer(),this._cameraMovedCB=this._interruptFading.bind(this),t.addEventListener(r.CAMERA_CHANGE_EVENT,this._cameraMovedCB),this._viewerResizeCB=this._onViewerResized.bind(this),t.addEventListener(r.VIEWER_RESIZE_EVENT,this._viewerResizeCB),this._renderOptionsChangedCB=this._onRenderOptionsChanged.bind(this),t.addEventListener(r.RENDER_OPTION_CHANGED_EVENT,this._renderOptionsChangedCB),this._floorSelectionFilterToBeUpdated=this._runFloorSelectorFilterEventHandler.bind(this),t.addEventListener(r.MODEL_ADDED_EVENT,this._floorSelectionFilterToBeUpdated),t.addEventListener(r.OBJECT_TREE_CREATED_EVENT,this._floorSelectionFilterToBeUpdated),this._modelUnloadingCB=this._runModelUnloadingEventHandler.bind(this),t.addEventListener(r.MODEL_UNLOADED_EVENT,this._modelUnloadingCB),this._floors=[],this._currentMode=u,this._hovering=!1,this._floorSectionMin=void 0,this._floorSectionMax=void 0,this._zMinAllModels=void 0,this._zMaxAllModels=void 0,this._floorAnim=null,this._fadeAnim=null,this._ghostFloorOpacity=0,this._currentMode=u,this._currentFloor=void 0,this._aoVisible=!0,this._aoOpacity=void 0,this._floorSelectorFilter=new n.default(this._viewer),this._floorFilterData=void 0,this._floorRollOverActive=!1,this.enabled=!0,this.offscreenRenderBudget=void 0}var t,i,s;return t=e,(i=[{key:"dtor",value:function(){this._viewer&&(this._viewer.removeEventListener(r.CAMERA_CHANGE_EVENT,this._cameraMovedCB),this._viewer.removeEventListener(r.VIEWER_RESIZE_EVENT,this._viewerResizeCB),this._viewer.removeEventListener(r.RENDER_OPTION_CHANGED_EVENT,this._renderOptionsChangedCB),this._viewer.removeEventListener(r.OBJECT_TREE_CREATED_EVENT,this._floorSelectionFilterToBeUpdated),this._viewer.removeEventListener(r.MODEL_ADDED_EVENT,this._floorSelectionFilterToBeUpdated),this._viewer.removeEventListener(r.MODEL_UNLOADED_EVENT,this._modelUnloadingCB),this._viewer=null)}},{key:"resetState",value:function(){this._floors=[],this._selectFloor(void 0),this._clearFloorSection(),this._floorSelectorFilter.clearFilter()}},{key:"enterHoverMode",value:function(){this._currentMode!==c&&this._setMode(d),this._hovering=!0}},{key:"exitHoverMode",value:function(){this._currentMode!==c&&this._setMode(u),this._hovering=!1,this._setSpatialFilterForRollOver()}},{key:"_getFadeExtension",value:function(){return this._viewer.getExtension("Bimfish.CrossFadeEffects")}},{key:"_ghostFloorsEnabled",value:function(){return Boolean(this._getFadeExtension())}},{key:"rollOverFloor",value:function(e){var t=this._ghostFloorsEnabled()||void 0===this._currentFloor,i=this._renderer.spatialFilterForRollOverSupported();if(void 0===e||!i||!t)return this._setSpatialFilterForRollOver(),void this._renderer.rolloverObjectId(0);this._renderer.rolloverObjectId(1),this._setSpatialFilterForRollOver(e),this._viewer.impl.invalidate(!1,!0,!0)}},{key:"selectFloor",value:function(t,i){this.floorSelectionValid(t)&&(i?this._moveToFloor(t):this._selectFloor(t),this._runFloorSelectorFilter(),this._ghostFloorsEnabled()||this.rollOverFloor(),this.fireEvent({type:e.CURRENT_FLOOR_CHANGED,levelIndex:t}))}},{key:"floorSelectionValid",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return!(!Number.isInteger(e)&&void 0!==e||!this.floorData||0===this.floorData.length||this.currentFloor===e||!(void 0===e||e>=0||this.floorData.length>e))}},{key:"isVisible",value:function(e,t){this._tmpNodeBox||(this._tmpNodeBox=new Float32Array(6));var i=this._floors[this._currentFloor];if(void 0===i)return!0;var n=e.getInstanceTree();if(!n)return!0;var o=this._tmpNodeBox;n.getNodeBox(t,o);var r=o[2],a=o[5];return!(r>i.zMax||a<i.zMin)&&this._floorSelectorFilter.isVisible(e,t)}},{key:"setEnabled",value:function(e){this.enabled=e,this._applySelectedFloorSection()}},{key:"_stopFloorAnim",value:function(){this._floorAnim&&(this._floorAnim.stop(),this._floorAnim=null)}},{key:"_stopFadeAnim",value:function(){this._fadeAnim&&(this._fadeAnim.stop(),this._fadeAnim=null)}},{key:"_leaveHoverMode",value:function(){var e=this._getFadeExtension();e&&(e.releaseFadingImage(0),e.releaseFadingImage(1),e.setModelTargetIndexForAll(void 0),this._applySelectedFloorSection(),this._setAOVisible(!0))}},{key:"_interruptFading",value:function(){!this._hovering&&this._fadeAnim&&this._fadeAnim.isRunning&&(this._stopFadeAnim(),this._leaveHoverMode())}},{key:"_onViewerResized",value:function(){this._stopFadeAnim(),this._leaveHoverMode(),this._hovering&&this.enterHoverMode()}},{key:"_onRenderOptionsChanged",value:function(){this._floorRollOverActive&&!this._renderer.spatialFilterForRollOverSupported()&&this.rollOverFloor()}},{key:"_getVisibleModels",value:function(){return this._viewer.impl.modelQueue().getModels()}},{key:"_updateZLimits",value:function(){var e=this._getVisibleModels();this._zMinAllModels=l,this._zMaxAllModels=h;for(var t=0;t<e.length;t++){var i=e[t].getBoundingBox();this._zMinAllModels=Math.min(i.min.z,this._zMinAllModels),this._zMaxAllModels=Math.max(i.max.z,this._zMaxAllModels)}this._zMinAllModels>this._zMaxAllModels&&(this._zMinAllModels=h,this._zMaxAllModels=l)}},{key:"_setAOVisible",value:function(e){if(e!==this._aoVisible){this._aoVisible=e;var t=this._renderer.getBlendPass(),i=0;e?(0!==t.uniforms.aoOpacity.value&&console.warn("ao opacity should not be changed while FloorSelector is in use."),i=this._aoOpacity):this._aoOpacity=t.uniforms.aoOpacity.value,this._renderer.setAOOptions(this._renderer.getAORadius(),this._renderer.getAOIntensity(),i)}}},{key:"_setGhostFloorOpactiy",value:function(e){var t=this._getFadeExtension();t&&t.setCrossFadeOpacity(1,this._ghostFloorOpacity),this._ghostFloorOpacity=e}},{key:"_setSpatialFilterForRollOver",value:function(t){var i=void 0,n=this._floors[t],o=function(e,t){return"bool spatialFilter(vec3 worldPos) { return (worldPos.z >= float("+e+") && worldPos.z <= float("+t+")); }"};n?i=o(n.zMin,n.zMax):t===e.AllFloors&&(i=o(this._zMinAllModels,this._zMaxAllModels)),this._renderer.setSpatialFilterForRollOver(i);var r=this._getFadeExtension();r&&r.crossFade.setSaoHeuristicEnabled(!i),this._floorRollOverActive=!!i}},{key:"_applyFloorSection",value:function(e,t){if(this.enabled){Number.isFinite(e)||(e=h),Number.isFinite(t)||(t=l);var i=[new THREE.Vector4(0,0,-1,e),new THREE.Vector4(0,0,1,-t)];this._viewer.impl.setCutPlaneSet("Bimfish.AEC.FloorSelector",i)}else this._viewer.impl.setCutPlaneSet("Bimfish.AEC.FloorSelector",i)}},{key:"_applySelectedFloorSection",value:function(){var e=void 0!==this._floorSectionMin?this._floorSectionMin:h,t=void 0!==this._floorSectionMax?this._floorSectionMax:l;this._applyFloorSection(e,t)}},{key:"_setFloorSection",value:function(e,t){this._floorSectionMin=isNaN(e)?void 0:e,this._floorSectionMax=isNaN(t)?void 0:t,this._applySelectedFloorSection()}},{key:"_clearFloorSection",value:function(){this._updateZLimits(),this._applyFloorSection()}},{key:"_setMode",value:function(e){var t=this;if(e!==this._currentMode)if(this._currentMode=e,e===d){var i=this._getFadeExtension();if(i){i.acquireControl("FloorSelector",(function(){return t._interruptFading()})),i.setModelTargetIndexForAll(void 0),this._applySelectedFloorSection(),this._renderer.rolloverObjectId(0),this._setAOVisible(!0),i.renderFadingImage(0,this.offscreenRenderBudget),i.setCrossFadeOpacity(0,1),this._clearFloorSection(),i.setModelTargetIndexForAll(1),this._setAOVisible(!1),this._stopFadeAnim();var n=this._setGhostFloorOpactiy.bind(this);this._fadeAnim=a.fadeValue(this._ghostFloorOpacity,.2,.5,n)}}else if(e===c){var o=this._getFadeExtension();o&&(o.setClearEnabled(1,!1),o.setClearEnabled(0,!0),o.setModelTargetIndexForAll(0),o.setCrossFadeOpacity(0,1)),this._setAOVisible(!0),this._applySelectedFloorSection()}else if(e===u){this._stopFadeAnim();var r=this._setGhostFloorOpactiy.bind(this),s=this._leaveHoverMode.bind(this);this._fadeAnim=a.fadeValue(this._ghostFloorOpacity,0,.5,r,s)}}},{key:"_moveToFloor",value:function(e){var t=this;this._currentFloor=e,this._setMode(c);var i=this._floors[e];this._updateZLimits();var n=void 0===this._floorSectionMin?this._zMinAllModels:this._floorSectionMin,o=void 0===this._floorSectionMax?this._zMaxAllModels:this._floorSectionMax,r=i?i.zMin:this._zMinAllModels,s=i?i.zMax:this._zMaxAllModels;this._stopFloorAnim(),this._floorAnim=a.fadeValue(0,1,.5,(function(e){var i=a.smootherStep(e),l=a.lerp(n,r,i),h=a.lerp(o,s,i);t._setFloorSection(l,h);var d=t._renderer.getBlendPass().uniforms.highlightIntensity;d.value=Math.min(d.value,1-i)}),(function(){var e=t._hovering?d:u;t._setMode(e)}))}},{key:"_selectFloor",value:function(e){this._stopFloorAnim(),this._currentFloor=e;var t=this._floors[e],i=t?t.zMin:void 0,n=t?t.zMax:void 0;this._setFloorSection(i,n)}},{key:"_runFloorSelectorFilter",value:function(){if(this._floorSelectorFilter.clearFilter(),this._floorFilterData&&void 0!==this._currentFloor){var e=this._floors[this._currentFloor];this._floorSelectorFilter.filter(this._floorFilterData,e)}}},{key:"_runFloorSelectorFilterEventHandler",value:function(e){e.model.isObjectTreeLoaded()&&(this._floorFilterData&&void 0!==this._currentFloor?this._runFloorSelectorFilter():this._floorSelectorFilter.clearFilter())}},{key:"_runModelUnloadingEventHandler",value:function(e){this._floorFilterData&&void 0!==this._currentFloor&&this._floorSelectorFilter.unhideModel(e.model)}},{key:"floorData",get:function(){return this._floors},set:function(e){this.resetState(),this._floors=Array.isArray(e)?e:[]}},{key:"floorFilterData",get:function(){return this._floorFilterData},set:function(e){this._floorFilterData=e}},{key:"currentFloor",get:function(){return this._currentFloor}}])&&o(t.prototype,i),s&&o(t,s),e}();p.AllFloors=-1,p.NoFloor=void 0,p.CURRENT_FLOOR_CHANGED="currentFloorChanged",s.FloorSelector=p},"./extensions/AEC/levels/FloorSelectorFilter.js":
/*!******************************************************!*\
  !*** ./extensions/AEC/levels/FloorSelectorFilter.js ***!
  \******************************************************/
/*! exports provided: default */function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.r(t),i.d(t,"default",(function(){return r}));var o=AutodeskNamespace("Bimfish.AEC"),r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._viewer=t,this._dbIdsToUnhide=new Map,this._cache={}}var t,i,o;return t=e,(i=[{key:"filter",value:function(e,t){var i=this;if(!e)throw new Error("floorFilterData cannot be undefined.");if(!(e.modelsDbIds instanceof Map))throw new Error("floorFilterData.modelsDbIds has to be a Map.");if(!t)throw new Error("floor cannot be undefined.");var n=this._getLevelHeightFactor(e.levelHeightFactor),o=e.modelsDbIds;if(this._hasModelDbIds(o)){var r=t.zMin,a=t.zMax,s=r+(a-r)*n,l=a+.1*(a-r);this._cache[t.name]||(this._cache[t.name]={});var h=this._viewer.impl.modelQueue().getModels(),d=function(e,n){var r=h[e];if(!r.visibilityManager)return console.warn("The VisibilityManager of the model with ID = ".concat(r.id," is not yet initialized.")),"break";if(i._cache[t.name][r.id]){var a=i._cache[t.name][r.id];return a.size>0&&i.hideDbIds(r,a),"continue"}var d=r.getInstanceTree();if(!d)return console.warn("The instanceTree of the model with ID = ".concat(r.id," is not yet initialized.")),"continue";var c=new Set,u=o.get(r.id);if(!u)return"continue";u.forEach((function(e){var t=new Float32Array(6);d.getNodeBox(e,t);var i=t[2],n=t[5];(i>=s&&i<=l||n>=s&&n<=l||i<=s&&n>=l)&&c.add(e)})),c.size>0&&i.hideDbIds(r,c),i._cache[t.name][r.id]=c};e:for(var c=0,u=h.length;c<u;c++)switch(d(c)){case"break":break e;case"continue":continue}}}},{key:"hideDbIds",value:function(e,t){if(e.visibilityManager)if(t.forEach((function(t){e.visibilityManager.setNodeOff(t,!0)})),this._dbIdsToUnhide.has(e)){var i=this._dbIdsToUnhide.get(e),n=!0,o=!1,r=void 0;try{for(var a,s=i[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value;i.add(l)}}catch(e){o=!0,r=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw r}}}else this._dbIdsToUnhide.set(e,t)}},{key:"clearFilter",value:function(){0!==this._dbIdsToUnhide.size&&this._dbIdsToUnhide.forEach(function(e,t){t.visibilityManager&&(e.forEach((function(e){t.visibilityManager.setNodeOff(e,!1)})),this._dbIdsToUnhide.delete(t))}.bind(this))}},{key:"unhideModel",value:function(e){this._dbIdsToUnhide.delete(e)}},{key:"_hasModelDbIds",value:function(e){if(0===e.size)return!1;var t=!0,i=!1,n=void 0;try{for(var o,r=e.values()[Symbol.iterator]();!(t=(o=r.next()).done);t=!0){var a=o.value;if(a&&a.length>0)return!0}}catch(e){i=!0,n=e}finally{try{t||null==r.return||r.return()}finally{if(i)throw n}}return!1}},{key:"_getLevelHeightFactor",value:function(e){if(void 0===e)return.5;if("number"!=typeof e)throw new Error("floorFilterData.levelHeightFactor has to be a number");if(e<0||e>=1)throw new Error("floorFilterData.levelHeightFactor has to be a number between 0-1.");return e}},{key:"reApplyFilter",value:function(e){var t=this._dbIdsToUnhide.get(e),i=e.visibilityManager;t&&i&&t.forEach((function(e){i.setNodeOff(e,!0)}))}},{key:"isVisible",value:function(e,t){var i=this._dbIdsToUnhide.get(e);return!i||!i.has(t)}}])&&n(t.prototype,i),o&&n(t,o),e}();o.FloorSelectorFilter=r},"./extensions/AEC/levels/LevelUtils.js":
/*!*********************************************!*\
  !*** ./extensions/AEC/levels/LevelUtils.js ***!
  \*********************************************/
/*! exports provided: transformLevelsByMatrix, transformLevels, modelToLevels, aecModelDataToLevels, chooseMainModel, modelDataOccluders */function(e,t,i){"use strict";function n(e){var t=e.extension;return t&&t.hasOwnProperty("projectElevation")?t.projectElevation:e.elevation}function o(e,t){var i=new THREE.Vector3,n=function(e){return i.set(0,0,e),i.applyMatrix4(t),i.z};e.forEach((function(e){e.zMin=n(e.zMin),e.zMax=n(e.zMax)}))}function r(e,t){t&&o(e,Bimfish.Viewing.BubbleNode.readMatrixFromArray12(t))}function a(e){var t=e.getDocumentNode().getAecModelData();return t&&t.levels&&t.levels.length?s(t):[]}function s(e,t){var i=e.levels.filter((function(e){var t=e.extension;return!t||(!t.hasOwnProperty("buildingStory")||t.buildingStory)})),a=[],s=i.length;return i.forEach((function(e,t){var o=void 0;if(t+1<s)o=n(i[t+1]);else{var r=i[i.length-1];o=n(r)+r.height}a.push({index:a.length,name:e.name,zMin:n(e)-1/12,zMax:o,guid:e.guid})})),t?o(a,t):r(a,e.refPointTransformation),a}function l(e){var t=e.impl.modelQueue().getModels(),i=null,n=-1;return t.forEach((function(e){if(!e.is2d()){var t=e.getDocumentNode();if(t)t.getAecModelData()&&(t.data.size>n?(i=e,n=t.data.size):t.data.size||-1!==n||(i=e,n=0))}})),i}function h(e){var t=e.impl.modelQueue().getModels(),i=new Map;return t.forEach((function(e){if(!e.is2d()){var t=e.getDocumentNode();if(t){var n=t.getAecModelData();n&&i.set(e.id,n.levelOccluderIds)}}})),{modelsDbIds:i}}i.r(t),i.d(t,"transformLevelsByMatrix",(function(){return o})),i.d(t,"transformLevels",(function(){return r})),i.d(t,"modelToLevels",(function(){return a})),i.d(t,"aecModelDataToLevels",(function(){return s})),i.d(t,"chooseMainModel",(function(){return l})),i.d(t,"modelDataOccluders",(function(){return h}))},"./extensions/AEC/levels/LevelsExtension.js":
/*!**************************************************!*\
  !*** ./extensions/AEC/levels/LevelsExtension.js ***!
  \**************************************************/
/*! exports provided: default */function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return m}));var n=i(/*! ./FloorSelector */"./extensions/AEC/levels/FloorSelector.js"),o=i(/*! ./LevelUtils */"./extensions/AEC/levels/LevelUtils.js"),r=i(/*! ../ui/ListPanel */"./extensions/AEC/ui/ListPanel.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=Bimfish.Viewing,u=c.UI,p=AutodeskNamespace("Bimfish.AEC"),m=function(e){function t(e,i){var n,o,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(n=!(r=l(t).call(this,e,i))||"object"!==a(r)&&"function"!=typeof r?h(o):r).container=n.options.panelUIContainers&&n.options.panelUIContainers.levelsPanel,n._onCameraMoved=n._onCameraMoved.bind(h(n)),n._onMove=void 0,n._subscribedForLocationUpdates=!1,n._currentLevel=void 0,n}var i,p,m;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),i=t,(p=[{key:"setOnCameraMove",value:function(e){!this._subscribedForLocationUpdates&&e?(this.viewer.addEventListener(c.CAMERA_CHANGE_EVENT,this._onCameraMoved),this._subscribedForLocationUpdates=!0,this._onMove=e):e||(this.viewer.removeEventListener(c.CAMERA_CHANGE_EVENT,this._onCameraMoved),this._subscribedForLocationUpdates=!1,this._onMove=null,this._currentLevel=null)}},{key:"_onCameraMoved",value:function(){if(this._onMove){var e=this._mapCameraToLevel();e&&(this._currentLevel&&e.guid===this._currentLevel.guid||(this._currentLevel=e,this._onMove(e)))}}},{key:"_mapCameraToLevel",value:function(){var e=this.floorSelector.floorData;if(e.length){var t=this.viewer.impl.camera.position.z;return t<e[0].zMin?e[0]:t>e[e.length-1].zMax?e[e.length-1]:e.find((function(e){return e.zMin<=t&&e.zMax>=t}))}}},{key:"onToolbarCreated",value:function(){if(!this.container){var e=this.viewer.getToolbar().getControl(c.TOOLBAR.MODELTOOLSID);e&&e.addControl(this.levelsButton)}}},{key:"_createUI",value:function(){var e=this;this.levelsButton=new u.Button("toolbar-levelsTool"),this.levelsButton.setToolTip("Levels"),this.levelsButton.icon.innerHTML=v(),this.levelsPanel=new r.ListPanel(this.container||this.viewer.container,"LevelsPanel-"+this.viewer.id,"Levels"),this.levelsPanel.setGlobalManager(this.globalManager),this.container||this.viewer.addPanel&&this.viewer.addPanel(this.levelsPanel),this.levelsPanel.addVisibilityListener((function(t){e.levelsButton.setState(t?u.Button.State.ACTIVE:u.Button.State.INACTIVE)})),this.levelsPanel.closer.addEventListener("click",(function(){e.onPanelVisibilityToggled&&e.onPanelVisibilityToggled(!1)})),this.levelsPanel.addEventListener(r.ListPanelEvents.ITEM_MOUSE_ENTER,(function(t){var i=t.item.index;i===e.floorSelector.currentFloor&&(i=n.default.AllFloors),e.floorSelector.rollOverFloor(i),e.hoveredFloor=i})),this.levelsPanel.addEventListener(r.ListPanelEvents.ITEM_MOUSE_LEAVE,(function(t){e.hoveredFloor===t.item.index&&(e.hoveredFloor=void 0,e.floorSelector.rollOverFloor(n.default.NoFloor))})),this.levelsPanel.addEventListener(r.ListPanelEvents.ITEM_SELECT,(function(t){var i=t.item.index!==e.floorSelector.currentFloor?t.item.index:void 0;e.floorSelector.selectFloor(i,!0)})),this.levelsPanel.container.addEventListener("mouseenter",(function(){return e.floorSelector.enterHoverMode()})),this.levelsPanel.container.addEventListener("mouseleave",(function(){return e.floorSelector.exitHoverMode()})),this.floorSelector.addEventListener(n.default.CURRENT_FLOOR_CHANGED,(function(){return e.levelsPanel.updateItemStates()})),this.levelsPanel.setItemHandlers((function(t){return t.index===e.floorSelector.currentFloor}),(function(e){return e.text})),this.levelsButton.onClick=function(){var t=!e.levelsPanel.isVisible();e.levelsPanel.setVisible(t),e.onPanelVisibilityToggled&&e.onPanelVisibilityToggled(t)}}},{key:"setAecModelData",value:function(e,t){if(e!==this.aecModelData){this.aecModelData=e,this.floorSelector.floorData=e?Object(o.aecModelDataToLevels)(e,t):[];for(var i=this.floorSelector.floorData,n=[],r=0;r<i.length;r++){var a=i[r];n.push({text:a.name,index:r})}n.reverse(),this.levelsPanel.setItems(n),this._updateOccluderData()}}},{key:"_updateOccluderData",value:function(){var e=this.aecModelData?Object(o.modelDataOccluders)(this.viewer):void 0;this.floorSelector.floorFilterData=e}},{key:"load",value:function(){var e=this;return this.floorSelector=new n.default(this.viewer),this.updateFloorSelector=function(){if(!1!==e.options.autoDetectAecModelData){var t=Object(o.chooseMainModel)(e.viewer),i=t&&t.getDocumentNode(),n=i&&i.getAecModelData(),r=t&&t.myData.placementWithOffset;e.setAecModelData(n,r)}e._updateOccluderData();var a=e.viewer.getVisibleModels().some((function(e){return e.is3d()}));e.floorSelector.setEnabled(a)},this.viewer.addEventListener(c.MODEL_ROOT_LOADED_EVENT,this.updateFloorSelector),this.viewer.addEventListener(c.MODEL_UNLOADED_EVENT,this.updateFloorSelector),this.viewer.addEventListener(c.MODEL_ADDED_EVENT,this.updateFloorSelector),this._createUI(),this.updateFloorSelector(),!0}},{key:"unload",value:function(){return this.container||this.viewer.removePanel&&this.viewer.removePanel(this.levelsPanel),this.floorSelector.selectFloor(void 0,!1),this.levelsPanel=null,this.updateFloorSelector&&(this.viewer.removeEventListener(c.MODEL_ROOT_LOADED_EVENT,this.updateFloorSelector),this.viewer.removeEventListener(c.MODEL_UNLOADED_EVENT,this.updateFloorSelector),this.viewer.removeEventListener(c.MODEL_ADDED_EVENT,this.updateFloorSelector),this.updateFloorSelector=null),this._subscribedForLocationUpdates&&(this.viewer.removeEventListener(c.CAMERA_CHANGE_EVENT,this._onCameraMoved),this._onMove=null,this._currentLevel=null),this.floorSelector=null,!0}},{key:"getState",value:function(e){if(this.viewer.model&&!this.viewer.model.is2d()){var t=this.floorSelector.currentFloor;e.floorGuid=t?this.floorSelector.floorData[t].guid:null}}},{key:"restoreState",value:function(e,t){if(e.floorGuid){var i=this.floorSelector.floorData.find((function(t){return t.guid===e.floorGuid}));i&&this.floorSelector.selectFloor(i.index,!1)}else this.floorSelector.selectFloor(n.default.NoFloor,!1);return!0}}])&&s(i.prototype,p),m&&s(i,m),t}(c.Extension),v=function(){return['<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">','<g stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">','<path d="M4 8 L12 3 L 20 8 L12 13Z"/>','<path d="M4 12 L12 17 L 20 12"/>','<path d="M4 16 L12 21 L 20 16"/>Ä',"</g>","</svg>"].join("")};p.LevelsExtension=m,Bimfish.Viewing.theExtensionManager.registerExtension("Bimfish.AEC.LevelsExtension",m)},"./extensions/AEC/ui/ListPanel.css":
/*!*****************************************!*\
  !*** ./extensions/AEC/ui/ListPanel.css ***!
  \*****************************************/
/*! no static exports found */function(e,t,i){var n=i(/*! !../../../node_modules/css-loader!../../../node_modules/sass-loader/dist/cjs.js!./ListPanel.css */"./node_modules/css-loader/index.js!./node_modules/sass-loader/dist/cjs.js!./extensions/AEC/ui/ListPanel.css");"string"==typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};i(/*! ../../../node_modules/style-loader/lib/addStyles.js */"./node_modules/style-loader/lib/addStyles.js")(n,o);n.locals&&(e.exports=n.locals)},"./extensions/AEC/ui/ListPanel.js":
/*!****************************************!*\
  !*** ./extensions/AEC/ui/ListPanel.js ***!
  \****************************************/
/*! exports provided: ListPanelEvents, ListPanel */function(e,t,i){"use strict";i.r(t),i.d(t,"ListPanelEvents",(function(){return r})),i.d(t,"ListPanel",(function(){return a}));var n=Bimfish.Viewing,o=Bimfish.Viewing.UI,r={ITEM_SELECT:"itemSelect",ITEM_MOUSE_ENTER:"itemMouseEnter",ITEM_MOUSE_LEAVE:"itemMouseLeave"};function a(e,t,i,r){o.DockingPanel.call(this,e,t,i,r),n.EventDispatcher.prototype.apply(this),this.container.classList.add("list-panel"),this.container.dockRight=!0,this.createScrollContainer({left:!1,heightAdjustment:65,marginTop:0})}a.prototype=Object.create(o.DockingPanel.prototype),a.prototype.setItems=function(e){this.buttons=[],this.items=e,this.listDiv&&this.scrollContainer.removeChild(this.listDiv);var t=this.getDocument();this.listDiv=t.createElement("div"),this.listDiv.classList.add("itemList"),this.scrollContainer.appendChild(this.listDiv);for(var i=this,n=function(e){var n=i._getItemText?i._getItemText(e):"<no item text>",o=t.createElement("div");o.classList.add("listItem"),o.item=e,o.setAttribute("title",n),o.addEventListener("click",(function(){i.fireEvent({type:r.ITEM_SELECT,item:e})})),o.addEventListener("mouseenter",(function(){i.fireEvent({type:r.ITEM_MOUSE_ENTER,item:e})})),o.addEventListener("mouseleave",(function(){i.fireEvent({type:r.ITEM_MOUSE_LEAVE,item:e})}));var a=t.createElement("span");a.innerHTML=n,a.classList.add("text");var s=t.createElement("div");s.classList.add("textContainer"),s.appendChild(a),o.appendChild(s);var l=t.createElement("span");l.classList.add("list-panel-item-warning"),o.appendChild(l),o.warnSpan=l;var h=t.createElement("span");return h.classList.add("icon"),o.appendChild(h),o},o=0;o<e.length;o++){var a=n(e[o]);this.listDiv.appendChild(a),this.buttons.push(a)}this.updateItemStates()},a.prototype.updateItemStates=function(){if(this.buttons)for(var e=0;e<this.buttons.length;e++){var t=this.buttons[e];t.classList.remove("selected"),this._isSelected&&this._isSelected(t.item)&&t.classList.add("selected");var i=this._getWarningText&&this._getWarningText(t.item);t.warnSpan.style.visibility=i?"visible":"hidden",t.warnSpan.setAttribute("title",i||"")}},a.prototype.setItemHandlers=function(e,t,i){this._isSelected=e,this._getItemText=t,this._getWarningText=i,this.updateItemStates()},o.ListPanelEvents=r,o.ListPanel=a},"./node_modules/css-loader/index.js!./node_modules/sass-loader/dist/cjs.js!./extensions/AEC/CanvasBookmark/CanvasBookmark.css":
/*!***************************************************************************************************************************!*\
  !*** ./node_modules/css-loader!./node_modules/sass-loader/dist/cjs.js!./extensions/AEC/CanvasBookmark/CanvasBookmark.css ***!
  \***************************************************************************************************************************/
/*! no static exports found */function(e,t,i){(e.exports=i(/*! ../../../node_modules/css-loader/lib/css-base.js */"./node_modules/css-loader/lib/css-base.js")(!1)).push([e.i,"/*\nhttps://stackoverflow.com/questions/27900053/css-transition-with-visibility-not-working\n\nVisibility is an animatable property according to the spec, but transitions on visibility do not work gradually, as one might expect.\nInstead transitions on visibility delay hiding an element. On the other hand making an element visible works immediately.\nThis is as it is defined by the spec (in the case of the default timing function) and as it is implemented in the browsers.\n\n    ==> transition: visibility 0.7s, opacity 0.7s;\n*/\n.canvas-bookmark.adsk-button, .clustered-canvas-bookmark.adsk-button, .declustered-canvas-bookmark.adsk-button {\n  position: absolute;\n  left: 0px;\n  top: 0px;\n  border-style: none !important;\n  /* Avoid border on button-hover */\n  color: white;\n  margin: none;\n  padding: 0px;\n  transition: visibility 0.5s, opacity 0.5s;\n  opacity: 0;\n  visibility: hidden; }\n\n.canvas-bookmark.adsk-button {\n  width: 22px;\n  height: 22px; }\n\n.clustered-canvas-bookmark.adsk-button {\n  width: 29px;\n  height: 29px; }\n\n.declustered-canvas-bookmark.adsk-button {\n  width: 29px;\n  height: 29px;\n  color: lightgrey; }\n\n.canvas-bookmark.visible {\n  opacity: 1;\n  visibility: visible; }\n\n.clustered-canvas-bookmark.visible {\n  opacity: 1;\n  visibility: visible; }\n",""])},"./node_modules/css-loader/index.js!./node_modules/sass-loader/dist/cjs.js!./extensions/AEC/DropMe/DropMe.css":
/*!***********************************************************************************************************!*\
  !*** ./node_modules/css-loader!./node_modules/sass-loader/dist/cjs.js!./extensions/AEC/DropMe/DropMe.css ***!
  \***********************************************************************************************************/
/*! no static exports found */function(e,t,i){(e.exports=i(/*! ../../../node_modules/css-loader/lib/css-base.js */"./node_modules/css-loader/lib/css-base.js")(!1)).push([e.i,".camera-selector {\n  width: 0;\n  height: 0;\n  border-left: 50px solid transparent;\n  border-right: 50px solid transparent;\n  border-top: 100px solid #0696D7;\n  border-radius: 50%;\n  transform-origin: bottom center;\n  position: absolute;\n  opacity: 0.8;\n  pointer-events: none;\n  z-index: 1; }\n\n.camera-selector-position {\n  width: 20px;\n  height: 20px;\n  border-radius: 50%;\n  background-color: #0696D7;\n  position: absolute;\n  opacity: 0.8;\n  pointer-events: none;\n  z-index: 1;\n  transform: scale(1, 1);\n  transition: transform 3s ease-in; }\n\n.camera-selector-position--teleporting {\n  transform: scale(0, 0); }\n\n.camera-selector-background {\n  width: 200px;\n  height: 200px;\n  background-color: #0696D7;\n  opacity: 0.2;\n  position: absolute;\n  pointer-events: none;\n  z-index: 0;\n  transform: translate(-100px, -100px);\n  border-radius: 50%; }\n\n/* mimic issues UI guidance for now as it was the only extension, featuring guidance so far */\n.dropme-guidenace-ui {\n  display: flex;\n  position: absolute;\n  left: 50%;\n  top: 20px;\n  padding: 10px 20px;\n  transform: translate(-50%, 0);\n  align-items: center;\n  border: 1px solid #9ec8f6;\n  border-radius: 4px;\n  background-color: #edf5fd;\n  color: #039be5;\n  font-size: 12px;\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.25);\n  opacity: 1;\n  z-index: 999;\n  overflow-y: hidden; }\n",""])},"./node_modules/css-loader/index.js!./node_modules/sass-loader/dist/cjs.js!./extensions/AEC/Minimap3D/Minimap3D.css":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/css-loader!./node_modules/sass-loader/dist/cjs.js!./extensions/AEC/Minimap3D/Minimap3D.css ***!
  \*****************************************************************************************************************/
/*! no static exports found */function(e,t,i){(e.exports=i(/*! ../../../node_modules/css-loader/lib/css-base.js */"./node_modules/css-loader/lib/css-base.js")(!1)).push([e.i,'/*\nhttps://stackoverflow.com/questions/27900053/css-transition-with-visibility-not-working\n\nVisibility is an animatable property according to the spec, but transitions on visibility do not work gradually, as one might expect.\nInstead transitions on visibility delay hiding an element. On the other hand making an element visible works immediately.\nThis is as it is defined by the spec (in the case of the default timing function) and as it is implemented in the browsers.\n\n    ==> transition: visibility 0.7s, opacity 0.7s;\n*/\n.minimap3D {\n  width: 0px;\n  height: 0px;\n  right: 10px;\n  top: 10px;\n  position: absolute;\n  transition: visibility 0.7s, opacity 0.7s;\n  opacity: 0;\n  visibility: hidden;\n  background: rgba(255, 255, 255, 0.4);\n  /* For side-by-side mode: Make sure that text selection highlighting is disabled on Minimap. Otherwise, fast dragging of the player will\n       color the whole map in blue */\n  user-select: none; }\n\n.minimapScrollArea {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  /* important for scrolling: the map image contains the whole map but is cropped to the visible area by the parent widget */\n  position: absolute;\n  /* Without this, \'overflow: hidden\' has no effect. */ }\n\n/* Show map left-aligned and without margin */\n.minimap3D.side-by-side {\n  right: 0px;\n  top: 0px;\n  box-sizing: border-box;\n  border-right: none;\n  border-left: solid 2px #979797; }\n\n.minimap3D.side-by-side.left-2d-view {\n  border-left: none;\n  border-right: solid 2px #979797;\n  left: 0px; }\n\n.minimap3D.visible {\n  opacity: 1;\n  visibility: visible; }\n\n/* Note that border changes require to update the anchor point in Minimap.js too */\n.player-widget {\n  width: 0px;\n  height: 0px;\n  position: absolute;\n  transition: opacity 0.7s;\n  opacity: 0;\n  z-index: 2; }\n\n.player-frustum {\n  border-left: 20px solid transparent;\n  border-right: 20px solid transparent;\n  border-top: 40px solid #3590e9;\n  border-radius: 50%;\n  opacity: 0.4;\n  width: 0px;\n  height: 0px;\n  position: absolute;\n  transform-origin: bottom center;\n  cursor: crosshair; }\n\n.player-frustum.touch {\n  border-left: 40px solid transparent;\n  border-right: 40px solid transparent;\n  border-top: 80px solid #3590e9; }\n\n.player-widget.visible {\n  opacity: 0.7; }\n\n.player-position-fill {\n  width: 10px;\n  height: 10px;\n  /* Move circle center to the tip of the frustum shape */\n  left: 15px;\n  /* = (playerFrustum.border-left - width/2)  */\n  top: 35px;\n  /* = (playerFrustum.border-top  - height/2) */\n  position: absolute;\n  border-radius: 50%;\n  background-color: #3590e9;\n  box-shadow: 0px 0px 0px 2px #fff; }\n\n.player-position-fill.touch {\n  /* Move circle center to the tip of the frustum shape */\n  left: 35px;\n  /* = (playerFrustum.border-left - width/2)  */\n  top: 75px;\n  /* = (playerFrustum.border-top  - height/2) */ }\n\n.player-position-hitarea {\n  position: absolute;\n  width: 15px;\n  height: 15px;\n  left: 5px;\n  /* player-position-fill.width/2 */\n  top: 5px;\n  /* player-position-fill.height/2 */\n  border-radius: 50px;\n  transform: translate(-50%, -50%);\n  cursor: grab; }\n\n.player-position-hitarea.touch {\n  width: 50px;\n  height: 50px; }\n\n/* Container for floor image + floor name */\n.mapContainer {\n  position: absolute;\n  left: 0px;\n  top: 0px;\n  opacity: 1; }\n\n.mapImage {\n  position: absolute;\n  left: 0px;\n  top: 0px;\n  pointer-events: none; }\n\n/* Display floor name at top left */\n.floorNameLabel {\n  z-index: 2;\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  opacity: 0.99;\n  background-color: whitesmoke;\n  box-shadow: 1px 3px 10px 0 rgba(0, 0, 0, 0.5);\n  margin: 4px;\n  border-radius: 5px; }\n\n.floorNameLabel.dark {\n  margin-top: 10px;\n  left: 50%;\n  transform: translate(-50%);\n  border-radius: 28px;\n  background-color: rgba(50, 50, 50, 0.8); }\n\n.floorNameLabel.light {\n  margin-top: 10px;\n  left: 50%;\n  transform: translate(-50%);\n  border-radius: 28px;\n  background-color: rgba(255, 255, 255, 0.85);\n  box-shadow: none; }\n\n.floorText {\n  margin: 5px 5px 5px 5px;\n  color: black;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  overflow: hidden; }\n\n.floorText.dark {\n  padding: 0px 15px;\n  color: #FFFFFF;\n  font-family: "Artifakt Element", Helvetica, Arial;\n  font-size: 14px; }\n\n.floorText.light {\n  padding: 0px 15px;\n  color: #000;\n  font-family: "Artifakt Element", Helvetica, Arial;\n  font-size: 14px; }\n\n/* Div with text and progressbar - replaces the map image if map computation is running */\n.minimap-placeholder {\n  left: 0px;\n  top: 0px;\n  position: absolute;\n  background-color: rgba(255, 255, 255, 0.5);\n  opacity: 1; }\n\n.minimap-progressWidget {\n  transform: translate(0, -50%);\n  left: 0px;\n  top: 50%;\n  position: relative;\n  height: fit-content;\n  width: calc(100% - 60px);\n  margin-left: 30px;\n  margin-right: 30px; }\n\n.minimap-progressText {\n  color: black;\n  text-align: left;\n  position: relative; }\n\n.minimap-progress {\n  z-index: 10;\n  width: 100%; }\n\n.map-button-bar {\n  z-Index: 2;\n  right: 0px;\n  top: 0px;\n  position: absolute;\n  right: 100%;\n  /* Dock left to mapWidget */\n  display: flex;\n  flex-direction: column;\n  background-color: whitesmoke;\n  box-shadow: 1px 3px 10px 0 rgba(0, 0, 0, 0.5);\n  margin-right: 4px;\n  margin-top: 0px;\n  /* Toolbar is vertically aligned to the upper mapWidget boundary. This is okay, because the mapWidget already has some margin from the canvas boundary. */\n  border-radius: 5px; }\n\n/* In side-by-side, the upper mapWidget edge is matched with the upper canvas edge. So, we add some marigin - otherwise the toolbar would be "glued" to the upper canvas edge. */\n.map-button-bar.side-by-side {\n  margin-top: 4px; }\n\n.map-button-bar.side-by-side.left-2d-view {\n  right: 0px; }\n\n.sheetmap-thumbnail {\n  position: absolute;\n  overflow: hidden; }\n',""])},"./node_modules/css-loader/index.js!./node_modules/sass-loader/dist/cjs.js!./extensions/AEC/ui/ListPanel.css":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/css-loader!./node_modules/sass-loader/dist/cjs.js!./extensions/AEC/ui/ListPanel.css ***!
  \**********************************************************************************************************/
/*! no static exports found */function(e,t,i){(e.exports=i(/*! ../../../node_modules/css-loader/lib/css-base.js */"./node_modules/css-loader/lib/css-base.js")(!1)).push([e.i,'.list-panel {\n  width: 260px;\n  min-width: 260px;\n  height: 260px;\n  min-height: 260px;\n  top: 180px;\n  left: 220px;\n  border-color: transparent; }\n\n.list-panel .itemList {\n  width: 100%;\n  display: flex;\n  flex-direction: column; }\n\n.list-panel .listItem {\n  display: flex;\n  justify-content: space-between;\n  text-align: left;\n  line-height: 35px;\n  background-color: rgba(0, 0, 0, 0);\n  border-style: none;\n  font-family: "ArtifaktElement", "Helvetica Neue", "Segoe UI Semilight", sans-serif;\n  padding: 0 15px; }\n\n.adsk-viewing-viewer.dark-theme .listItem {\n  color: #f3f7fb; }\n\n.adsk-viewing-viewer.light-theme .list-panel .listItem:hover {\n  background-color: rgba(10, 19, 28, 0.2); }\n\n.adsk-viewing-viewer.dark-theme .list-panel .listItem:hover {\n  background-color: #4a555b; }\n\n.list-panel .listItem:focus {\n  outline: none; }\n\n.list-panel .listItem.selected {\n  color: deepskyblue;\n  border-style: none; }\n\n.list-panel .listItem .textContainer {\n  -webkit-mask-image: linear-gradient(to left, transparent, black 1em);\n  mask-image: linear-gradient(to left, transparent, black 1em);\n  white-space: nowrap;\n  overflow: hidden;\n  width: 100%; }\n\n.list-panel .listItem .icon {\n  width: 24px; }\n\n.list-panel .listItem.selected .icon::before {\n  content: \'\\2713\';\n  margin-left: 8px; }\n\n.list-panel-item-warning {\n  background-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScyNCcgaGVpZ2h0PScyNCcgdmlld0JveD0nMCAwIDggOCc+PHBhdGggZmlsbD0nIzZiNzg3ZicgZD0nTTMuMDkgMGMtLjA2IDAtLjEuMDQtLjEzLjA5bC0yLjk0IDYuODFjLS4wMi4wNS0uMDMuMTMtLjAzLjE5di44MWMwIC4wNS4wNC4wOS4wOS4wOWg2LjgxYy4wNSAwIC4wOS0uMDQuMDktLjA5di0uODFjMC0uMDUtLjAxLS4xNC0uMDMtLjE5bC0yLjk0LTYuODFjLS4wMi0uMDUtLjA3LS4wOS0uMTMtLjA5aC0uODF6bS0uMDkgM2gxdjJoLTF2LTJ6bTAgM2gxdjFoLTF2LTF6JyAvPjwvc3ZnPg==");\n  width: 24px;\n  height: 24px;\n  margin-left: auto;\n  margin-top: auto;\n  margin-bottom: auto; }\n',""])},"./node_modules/css-loader/lib/css-base.js":
/*!*************************************************!*\
  !*** ./node_modules/css-loader/lib/css-base.js ***!
  \*************************************************/
/*! no static exports found */function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i=e[1]||"",n=e[3];if(!n)return i;if(t&&"function"==typeof btoa){var o=(a=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),r=n.sources.map((function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"}));return[i].concat(r).concat([o]).join("\n")}var a;return[i].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+i+"}":i})).join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},o=0;o<this.length;o++){var r=this[o][0];"number"==typeof r&&(n[r]=!0)}for(o=0;o<e.length;o++){var a=e[o];"number"==typeof a[0]&&n[a[0]]||(i&&!a[2]?a[2]=i:i&&(a[2]="("+a[2]+") and ("+i+")"),t.push(a))}},t}},"./node_modules/style-loader/lib/addStyles.js":
/*!****************************************************!*\
  !*** ./node_modules/style-loader/lib/addStyles.js ***!
  \****************************************************/
/*! no static exports found */function(e,t,i){var n,o,r={},a=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===o&&(o=n.apply(this,arguments)),o}),s=function(e,t){return t?t.querySelector(e):document.querySelector(e)},l=function(e){var t={};return function(e,i){if("function"==typeof e)return e();if(void 0===t[e]){var n=s.call(this,e,i);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}}(),h=null,d=0,c=[],u=i(/*! ./urls */"./node_modules/style-loader/lib/urls.js");function p(e,t){for(var i=0;i<e.length;i++){var n=e[i],o=r[n.id];if(o){o.refs++;for(var a=0;a<o.parts.length;a++)o.parts[a](n.parts[a]);for(;a<n.parts.length;a++)o.parts.push(E(n.parts[a],t))}else{var s=[];for(a=0;a<n.parts.length;a++)s.push(E(n.parts[a],t));r[n.id]={id:n.id,refs:1,parts:s}}}}function m(e,t){for(var i=[],n={},o=0;o<e.length;o++){var r=e[o],a=t.base?r[0]+t.base:r[0],s={css:r[1],media:r[2],sourceMap:r[3]};n[a]?n[a].parts.push(s):i.push(n[a]={id:a,parts:[s]})}return i}function v(e,t){var i=l(e.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=c[c.length-1];if("top"===e.insertAt)n?n.nextSibling?i.insertBefore(t,n.nextSibling):i.appendChild(t):i.insertBefore(t,i.firstChild),c.push(t);else if("bottom"===e.insertAt)i.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=l(e.insertAt.before,i);i.insertBefore(t,o)}}function f(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=c.indexOf(e);t>=0&&c.splice(t,1)}function g(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var n=function(){0;return i.nc}();n&&(e.attrs.nonce=n)}return y(t,e.attrs),v(e,t),t}function y(e,t){Object.keys(t).forEach((function(i){e.setAttribute(i,t[i])}))}function E(e,t){var i,n,o,r;if(t.transform&&e.css){if(!(r="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=r}if(t.singleton){var a=d++;i=h||(h=g(t)),n=M.bind(null,i,a,!1),o=M.bind(null,i,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",y(t,e.attrs),v(e,t),t}(t),n=k.bind(null,i,t),o=function(){f(i),i.href&&URL.revokeObjectURL(i.href)}):(i=g(t),n=x.bind(null,i),o=function(){f(i)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else o()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=a()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var i=m(e,t);return p(i,t),function(e){for(var n=[],o=0;o<i.length;o++){var a=i[o];(s=r[a.id]).refs--,n.push(s)}e&&p(m(e,t),t);for(o=0;o<n.length;o++){var s;if(0===(s=n[o]).refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete r[s.id]}}}};var w,b=(w=[],function(e,t){return w[e]=t,w.filter(Boolean).join("\n")});function M(e,t,i,n){var o=i?"":n.css;if(e.styleSheet)e.styleSheet.cssText=b(t,o);else{var r=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(r,a[t]):e.appendChild(r)}}function x(e,t){var i=t.css,n=t.media;if(n&&e.setAttribute("media",n),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}function k(e,t,i){var n=i.css,o=i.sourceMap,r=void 0===t.convertToAbsoluteUrls&&o;(t.convertToAbsoluteUrls||r)&&(n=u(n)),o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var a=new Blob([n],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}},"./node_modules/style-loader/lib/urls.js":
/*!***********************************************!*\
  !*** ./node_modules/style-loader/lib/urls.js ***!
  \***********************************************/
/*! no static exports found */function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var i=t.protocol+"//"+t.host,n=i+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var o,r=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(r)?e:(o=0===r.indexOf("//")?r:0===r.indexOf("/")?i+r:n+r.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")}))}}});